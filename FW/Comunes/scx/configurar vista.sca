SCCTEXT Version 4.0.0.2
PLATFORM C(8,0),UNIQUEID C(10,0),TIMESTAMP N(10,0),CLASS M(4,0),CLASSLOC M(4,0),BASECLASS M(4,0),OBJNAME M(4,0),PARENT M(4,0),PROPERTIES M(4,0),PROTECTED M(4,0),METHODS M(4,0),OBJCODE M(4,0),OLE M(4,0),OLE2 M(4,0),RESERVED1 M(4,0),RESERVED2 M(4,0),RESERVED3 M(4,0),RESERVED4 M(4,0),RESERVED5 M(4,0),RESERVED6 M(4,0),RESERVED7 M(4,0),RESERVED8 M(4,0),USER M(4,0)
1252

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] Screen    
[START RESERVED1]
VERSION =   3.00[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3SZ0SR37P
[CLASS] dataenvironment
[BASECLASS] dataenvironment
[OBJNAME] Dataenvironment
[START PROPERTIES]
Top = 0
Left = 0
Width = 0
Height = 0
DataSource = .NULL.
Name = "Dataenvironment"
[END PROPERTIES]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED4]
1[END RESERVED4]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3SZ0SR37Q
[CLASS] form
[BASECLASS] form
[OBJNAME] CONFIGURAR_VISTA
[START PROPERTIES]
Height = 295
Width = 669
ShowWindow = 1
DoCreate = .T.
AutoCenter = .T.
Caption = "Configurar Vista"
WindowType = 1
_memberdata =      755<VFPData><memberdata name="cargarcolumnas" display="CargarColumnas"/><memberdata name="cancelar" display="Cancelar"/><memberdata name="selectall" display="SelectAll"/><memberdata name="aceptar" display="Aceptar"/><memberdata name="aplicarcambios" display="AplicarCambios"/><memberdata name="lreturn" display="lReturn"/><memberdata name="oauxcolumns" display="oAuxColumns"/><memberdata name="ocolumns" display="oColumns"/><memberdata name="saveviewas" display="SaveViewAs"/><memberdata name="saveview" display="SaveView"/><memberdata name="cargarvistas" display="CargarVistas"/><memberdata name="viewload" display="ViewLoad"/><memberdata name="nviewid" display="nViewId"/><memberdata name="guardarpredeterminada" display="GuardarPredeterminada"/></VFPData>
lreturn = .F.
oauxcolumns = .NULL.
ocolumns = .NULL.
nviewid = 0
Name = "CONFIGURAR_VISTA"
[END PROPERTIES]
[START METHODS]
PROCEDURE Destroy
ThisForm.cntColumnas.ReleaseObjects()
This.oAuxColumns = Null
This.oColumns = Null

ENDPROC
PROCEDURE Init
Lparameters oColumns As Collection
Local lcCommand As String

Try

	lcCommand = ""
	This.lReturn = .F.
	Thisform.oColumns = oColumns

	Thisform.cntColumnas.Top = 0
	Thisform.cntColumnas.Left = 0
	
	Thisform.Width = Thisform.cntColumnas.Width

	This.BorderStyle = 0

	If Vartype( Thisform.oColumns ) == "O"
		Thisform.CargarColumnas()
	Endif




Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )


Finally


Endtry


ENDPROC
PROCEDURE Release
ThisForm.cntColumnas.ReleaseObjects()
DoDefault()
ENDPROC
PROCEDURE Unload
Return This.lReturn
ENDPROCPROCEDURE aceptar

Thisform.AplicarCambios()
Thisform.GuardarPredeterminada()
Thisform.lReturn = .T.
Thisform.Release()
ENDPROC
PROCEDURE aplicarcambios
Local lcCommand as String
Local loColGridLayout As colGridLayout Of "FW\Comunes\Prg\colGridLayout.prg"
Local loColumn As oGridLayout Of "Fw\comunes\Prg\colGridLayout.Prg"
Local loAuxColumns as PrxCollection Of "Fw\TierAdapter\Comun\PrxBaseLibrary.prg"
Local loDisponibles as ListBox,;
loSeleccionadas as ListBox

Local i as Integer

Try

	lcCommand = ""
	loColGridLayout = Thisform.oColumns
	loAuxColumns = Thisform.oAuxColumns
	
	loDisponibles 	= ThisForm.cntColumnas.SourceList.Dato
	loSeleccionadas = ThisForm.cntColumnas.TargetList.Dato
	
	For i = 1 to loSeleccionadas.ListCount
		loColumn = loAuxColumns.GetItem( loSeleccionadas.List( i ) )
		loColumn.ColumnVisible = .T.
		loColumn.ColumnColumnOrder = i
	EndFor

	For i = 1 to loDisponibles.ListCount
		loColumn = loAuxColumns.GetItem( loDisponibles.List( i ) )
		loColumn.ColumnVisible = .F.
		loColumn.ColumnColumnOrder = i + loSeleccionadas.ListCount
	EndFor

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )

Finally
	loColGridLayout = Null
	
	
EndTry

ENDPROC
PROCEDURE cancelar
Thisform.lReturn = .F.
Thisform.Release()
ENDPROC
PROCEDURE cargarcolumnas
Local lcCommand as String
Local loColGridLayout As colGridLayout Of "FW\Comunes\Prg\colGridLayout.prg"
Local loColumn As oGridLayout Of "Fw\comunes\Prg\colGridLayout.Prg"
Local loColumns as Collection
Local loDisponibles as ListBox,;
loSeleccionadas as ListBox,;
loVistas as ListBox

Local loAuxColumns as PrxCollection Of "Fw\TierAdapter\Comun\PrxBaseLibrary.prg"
Local loSortedGrid as PrxCollection Of "Fw\TierAdapter\Comun\PrxBaseLibrary.prg"

Local lnId as Integer
Try

	lcCommand = ""

	lnId = Thisform.CargarVistas()
	ThisForm.nViewId = lnId
	Thisform.ViewLoad( lnId )


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	
	
EndTry

ENDPROC
PROCEDURE cargarvistas
Local lcCommand As String
Local loVistas As ListBox
Local lnId As Integer,;
lnSelected as Integer

Try

	lcCommand = ""
	lnId = 0

	If !Used( "VistaPrecios" )
		TEXT To lcCommand NoShow TextMerge Pretext 15
		Use <<Alltrim( DRVA )>>VistaPrecios Shared In 0
		ENDTEXT

		&lcCommand

	Endif

	TEXT To lcCommand NoShow TextMerge Pretext 15
		Select *
			From VistaPrecios
			Where Proceso = 1
			Into Cursor cVistaPrecios
	ENDTEXT

	&lcCommand

	If !Empty( _Tally )

		With Thisform.cntColumnas.Vistas_Guardadas.Dato As ListBox

			lnId = 0

			Scan
				.AddItem( Proper( Alltrim( cVistaPrecios.Nombre ) ))
				.List[ .NewIndex, 2] = Transform( cVistaPrecios.Id )
				.ItemData( .NewIndex ) = cVistaPrecios.Id

				If IsTrue( cVistaPrecios.Default )
					.Selected( .NewIndex ) = .T.
				Endif
			Endscan

			lnSelected = .ListIndex
			
			If Empty( lnSelected )
				.Selected( 1 ) = .T.
				lnSelected = .ListIndex
			EndIf
			
			lnId = .ItemData( lnSelected )
			
		Endwith

	Endif

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	*Use in Select( "VistaPrecios" )

Endtry

Return lnId

ENDPROC
PROCEDURE guardarpredeterminada
#INCLUDE "FW\TierAdapter\Include\TA.h"

Local lcCommand As String
Local lnId As Integer

Try

	lcCommand = ""
	If !Used( "VistaPrecios" )

		TEXT To lcCommand NoShow TextMerge Pretext 15
			Use <<Alltrim( DRVA )>>VistaPrecios Shared In 0
		ENDTEXT

		&lcCommand

	Endif

	lnId = Thisform.nViewId

	Update VistaPrecios Set ;
		Default = IS_FALSE ;
		Where Proceso = 1

	Update VistaPrecios Set ;
		Default = IS_TRUE ;
		Where Id = lnId

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )

Finally


Endtry

ENDPROC
PROCEDURE saveview
Local lcCommand As String,;
	lcDescripcion As String,;
	lcVista As String

Local loColGridLayout As colGridLayout Of "FW\Comunes\Prg\colGridLayout.prg"
Local loColumn As oGridLayout Of "Fw\comunes\Prg\colGridLayout.Prg"
Local loAuxColumns As PrxCollection Of "Fw\TierAdapter\Comun\PrxBaseLibrary.prg"
Local loDisponibles As ListBox,;
	loSeleccionadas As ListBox

Local loVista As Collection
Local loViewColumn As Object
Local i As Integer

Local lnId As Integer,;
	lnProceso As Integer

Try

	lcCommand = ""

	loVista = Createobject( "Collection" )


	loColGridLayout = Thisform.oColumns
	loAuxColumns = Thisform.oAuxColumns

	loDisponibles 	= Thisform.cntColumnas.SourceList.Dato
	loSeleccionadas = Thisform.cntColumnas.TargetList.Dato

	For i = 1 To loSeleccionadas.ListCount

		loViewColumn = Createobject( "Empty" )

		loColumn = loAuxColumns.GetItem( loSeleccionadas.List( i, 2 ) )

		AddProperty( loViewColumn, "Name", loSeleccionadas.List( i, 2 ) )
		AddProperty( loViewColumn, "Visible", .T. )
		AddProperty( loViewColumn, "ColumnOrder", i )

		loVista.Add( loViewColumn )

	Endfor

	For i = 1 To loDisponibles.ListCount
		loViewColumn = Createobject( "Empty" )

		loColumn = loAuxColumns.GetItem( loDisponibles.List( i, 2 ) )

		AddProperty( loViewColumn, "Name", loDisponibles.List( i, 2 ) )
		AddProperty( loViewColumn, "Visible", .F. )
		AddProperty( loViewColumn, "ColumnOrder", i + loSeleccionadas.ListCount )

		loVista.Add( loViewColumn )


	Endfor

	lcVista = ObjectToXml( loVista )

	If !Used( "VistaPrecios" )

		TEXT To lcCommand NoShow TextMerge Pretext 15
			Use <<Alltrim( DRVA )>>VistaPrecios Shared In 0
		ENDTEXT

		&lcCommand

	Endif

	lnId = Thisform.nViewId

	Update VistaPrecios Set ;
		Vista = lcVista ;
		Where Id = lnId


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	loColGridLayout = Null
	loColumn = Null
	loAuxColumns = Null
	loDisponibles = Null
	loSeleccionadas = Null

	loVista = Null
	loViewColumn = Null


Endtry

ENDPROC
PROCEDURE saveviewas
Local lcCommand As String,;
	lcDescripcion As String,;
	lcVista As String

Local loColGridLayout As colGridLayout Of "FW\Comunes\Prg\colGridLayout.prg"
Local loColumn As oGridLayout Of "Fw\comunes\Prg\colGridLayout.Prg"
Local loAuxColumns As PrxCollection Of "Fw\TierAdapter\Comun\PrxBaseLibrary.prg"
Local loDisponibles As ListBox,;
	loSeleccionadas As ListBox

Local loVista As Collection
Local loViewColumn As Object
Local i As Integer

Local lnId As Integer,;
	lnProceso As Integer

Try

	lcCommand = ""
	lcDescripcion = Inputbox( "Ingrese el nombre para guardar la vista", "GUARDAR VISTA" )

	If !Empty( lcDescripcion )

		loVista = Createobject( "Collection" )


		loColGridLayout = Thisform.oColumns
		loAuxColumns 	= Thisform.oAuxColumns

		loDisponibles 	= Thisform.cntColumnas.SourceList.Dato
		loSeleccionadas = Thisform.cntColumnas.TargetList.Dato

		For i = 1 To loSeleccionadas.ListCount

			loViewColumn = Createobject( "Empty" )

			loColumn = loAuxColumns.GetItem( loSeleccionadas.List( i, 2 ) )

			AddProperty( loViewColumn, "Name", loSeleccionadas.List( i, 2 ) )
			AddProperty( loViewColumn, "Visible", .T. )
			AddProperty( loViewColumn, "ColumnOrder", i )

			loVista.Add( loViewColumn )

		Endfor

		For i = 1 To loDisponibles.ListCount
			loViewColumn = Createobject( "Empty" )

			loColumn = loAuxColumns.GetItem( loDisponibles.List( i, 2 ) )

			AddProperty( loViewColumn, "Name", loDisponibles.List( i, 2 ) )
			AddProperty( loViewColumn, "Visible", .F. )
			AddProperty( loViewColumn, "ColumnOrder", i + loSeleccionadas.ListCount )

			loVista.Add( loViewColumn )


		Endfor

		lcVista = ObjectToXml( loVista )

		If !Used( "VistaPrecios" )

			TEXT To lcCommand NoShow TextMerge Pretext 15
			Use <<Alltrim( DRVA )>>VistaPrecios Shared In 0
			ENDTEXT

			&lcCommand

		Endif

		Calculate Max( Id ) To lnId In VistaPrecios

		lnId = lnId + 1

		Insert Into VistaPrecios (;
			Id, Proceso, Nombre, Vista ) Values (;
			lnId, 1, lcDescripcion, lcVista )


		With Thisform.cntColumnas.Vistas_Guardadas.Dato As ListBox
			.AddItem( Proper( lcDescripcion ))
			.List[ .NewIndex, 2] = Transform( lnId )

			.Refresh()
		Endwith

	Endif



Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally

	loColGridLayout = Null
	loColumn = Null
	loAuxColumns = Null
	loDisponibles = Null
	loSeleccionadas = Null

	loVista = Null
	loViewColumn = Null

Endtry

ENDPROC
PROCEDURE selectall
Lparameters tlSelect as Boolean

Local i as Integer
Local o as ListBox

Try
	
	o = ThisForm.cntColumnas.SourceList.Dato
	
	For i = 1 to o.ListCount
		o.Selected( i ) = tlSelect
	EndFor
	

Catch To oErr
	Local loError as Errorhandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "Errorhandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally
	o = Null
	
EndTry

ENDPROC
PROCEDURE viewload
Lparameters nId As Integer

Local lcCommand As String
Local loColGridLayout As colGridLayout Of "FW\Comunes\Prg\colGridLayout.prg"
Local loColumn As oGridLayout Of "Fw\comunes\Prg\colGridLayout.Prg"
Local loColumns As Collection
Local loDisponibles As ListBox,;
	loSeleccionadas As ListBox,;
	loVistas As ListBox

Local loAuxColumns As PrxCollection Of "Fw\TierAdapter\Comun\PrxBaseLibrary.prg"
Local loSortedGrid As PrxCollection Of "Fw\TierAdapter\Comun\PrxBaseLibrary.prg"

Local lnSelected as Integer

Try

	lcCommand = ""

	Thisform.nViewId = nId

	If Empty( nId )
		nId = 0
	Endif

	TEXT To lcCommand NoShow TextMerge Pretext 15
	Select 	Vista
		From VistaPrecios
		Where Id = <<nId>>
		Into Cursor cVistaPrecios
	ENDTEXT

	&lcCommand

	loColGridLayout = Thisform.oColumns
	loAuxColumns = Newobject( "PrxCollection", "Fw\TierAdapter\Comun\PrxBaseLibrary.prg" )
	Thisform.oAuxColumns = loAuxColumns


	If !Empty( _Tally )
		lcVista  = cVistaPrecios.Vista
		loColumns = XmlToObject( lcVista )

		For Each loColumna In loColumns
			loColumn = loColGridLayout.GetItem( loColumna.Name )
			loColumn.ColumnVisible = loColumna.Visible
			loColumn.ColumnColumnOrder = loColumna.ColumnOrder
		Endfor

	Endif

	loSortedGrid = loColGridLayout.SortBy( "ColumnColumnOrder" )

	loDisponibles 	= Thisform.cntColumnas.SourceList.Dato
	loSeleccionadas = Thisform.cntColumnas.TargetList.Dato

	loDisponibles.Clear()
	loSeleccionadas.Clear()

	For Each loColumn In loSortedGrid

		loAuxColumns.AddItem( loColumn, loColumn.HeaderCaption )

		If loColumn.ColumnVisible
			loSeleccionadas.AddItem( loColumn.HeaderCaption )
			loSeleccionadas.List[ loSeleccionadas.NewIndex, 2] = loColumn.Name

		Else
			loDisponibles.AddItem( loColumn.HeaderCaption )
			loDisponibles.List[ loDisponibles.NewIndex, 2] = loColumn.Name

		Endif

	Endfor

	Thisform.Refresh()


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally


Endtry

ENDPROC
[END METHODS]
[START RESERVED3]
_memberdata XML Metadata for customizable properties
lreturn
oauxcolumns
ocolumns
nviewid
*cargarcolumnas 
*cancelar 
*selectall 
*aceptar 
*aplicarcambios 
*saveviewas 
*saveview 
*cargarvistas 
*viewload 
*guardarpredeterminada Guarda la vista seleccionada como predeterminada
[END RESERVED3]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3SZ0SR37P
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdAceptar
[PARENT] CONFIGURAR_VISTA
[START PROPERTIES]
Top = 260
Left = 559
Height = 24
Width = 84
Anchor = 12
Picture = ..\image\bmp\ok.bmp
Caption = "Aceptar"
TabIndex = 2
PicturePosition = 1
Name = "cmdAceptar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Aceptar()
Wait Clear

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3SZ0SR37S
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdCancelar
[PARENT] CONFIGURAR_VISTA
[START PROPERTIES]
Top = 260
Left = 20
Height = 24
Width = 84
Anchor = 6
Picture = ..\image\bmp\close.bmp
Cancel = .T.
Caption = "Cerrar"
TabIndex = 5
PicturePosition = 1
Name = "cmdCancelar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Cancelar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3SZ0SR37T
[CLASS] moverlists
[CLASSLOC] ..\vcx\moverlists.vcx
[BASECLASS] container
[OBJNAME] cntColumnas
[PARENT] CONFIGURAR_VISTA
[START PROPERTIES]
Top = 12
Left = 24
Width = 620
Height = 236
nvirtualcolumns = 2
Name = "cntColumnas"
Shape.Name = "Shape"
SHPLABEL.Name = "SHPLABEL"
lblTitulo.Caption = "Campos a mostrar"
lblTitulo.TabIndex = 5
lblTitulo.Name = "lblTitulo"
SourceList.Label.Caption = "Disponibles"
SourceList.Label.Name = "Label"
SourceList.CHECKBUTTON.Name = "CHECKBUTTON"
SourceList.DATO.Sorted = .F.
SourceList.DATO.Name = "DATO"
SourceList.Top = 27
SourceList.Left = 222
SourceList.TabIndex = 2
SourceList.Name = "SourceList"
MoverButtons.Shape.Name = "Shape"
MoverButtons.SHPLABEL.Name = "SHPLABEL"
MoverButtons.lblTitulo.Name = "lblTitulo"
MoverButtons.addone.Name = "addone"
MoverButtons.addall.Name = "addall"
MoverButtons.removeall.Name = "removeall"
MoverButtons.removeone.Name = "removeone"
MoverButtons.Top = 27
MoverButtons.Left = 383
MoverButtons.TabIndex = 3
MoverButtons.Name = "MoverButtons"
TargetList.Label.Caption = "Seleccionados"
TargetList.Label.Name = "Label"
TargetList.CHECKBUTTON.Name = "CHECKBUTTON"
TargetList.DATO.MoverBars = .T.
TargetList.DATO.Sorted = .F.
TargetList.DATO.Name = "DATO"
TargetList.Top = 27
TargetList.Left = 427
TargetList.TabIndex = 4
TargetList.Name = "TargetList"
[END PROPERTIES]
[START METHODS]
PROCEDURE TargetList.DATO.OnMoveItem
LPARAMETERS nSource, nShift, nCurrentIndex, nMoveBy

ThisForm.Guardar_Como.Enabled = .T.
ThisForm.Guardar.Enabled = .T.

ENDPROC
PROCEDURE moveselected
Lparameters toSource As ListBox, toTarget As ListBox

DoDefault( toSource, toTarget )

ThisForm.Guardar_Como.Enabled = .T.
ThisForm.Guardar.Enabled = .T.

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3SZ0TNFXF
[CLASS] iblistbox
[CLASSLOC] ..\vcx\inputboxes.vcx
[BASECLASS] container
[OBJNAME] Vistas_Guardadas
[PARENT] CONFIGURAR_VISTA.cntColumnas
[START PROPERTIES]
Top = 27
Left = 26
Width = 166
Height = 197
Visible = .T.
TabIndex = 1
lsamerowasprevious = .T.
llabelontop = .T.
Name = "Vistas_Guardadas"
Label.AutoSize = .T.
Label.Caption = "Vistas Guardadas"
Label.Left = 7
Label.Top = 3
Label.Name = "Label"
CHECKBUTTON.Name = "CHECKBUTTON"
DATO.BoundColumn = 2
DATO.Height = 188
DATO.Left = 0
DATO.Sorted = .T.
DATO.Top = 20
DATO.Width = 148
DATO.BoundTo = .T.
DATO.Name = "DATO"
[END PROPERTIES]
[START METHODS]
PROCEDURE DATO.DblClick
Thisform.ViewLoad( Int( Val( This.Value )))
ENDPROCPROCEDURE DATO.InteractiveChange
Thisform.ViewLoad( Int( Val( This.Value )))

ENDPROC
PROCEDURE interactivechange
Lparameters nEntidadId As Integer

NoDefault

ENDPROC
PROCEDURE releaseobjects
Local loObj As Object
Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
Try
	With This As prxcontainer Of FW\Comunes\vcx\prxbase.vcx
		.oColObjects = Null
		.oImageList = Null
		For Each loObj In .Objects
			If Pemstatus( loObj, 'ReleaseObjects', 5 )
				loObj.ReleaseObjects()
			Endif
		Endfor
	Endwith

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally
	loObj = Null

Endtry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3SZ0SR37P
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] Guardar_Como
[PARENT] CONFIGURAR_VISTA
[START PROPERTIES]
Top = 260
Left = 426
Height = 24
Width = 128
Anchor = 12
Picture = ..\image\bmp\save.bmp
Caption = "Guardar Como ..."
Enabled = .F.
TabIndex = 2
Visible = .T.
PicturePosition = 1
Name = "Guardar_Como"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.SaveViewAs()
Wait Clear

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3SZ0UR8SC
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] Guardar
[PARENT] CONFIGURAR_VISTA
[START PROPERTIES]
Top = 260
Left = 337
Height = 24
Width = 84
Anchor = 12
Picture = ..\image\bmp\save.bmp
Caption = "Guardar"
Enabled = .F.
TabIndex = 2
Visible = .T.
PicturePosition = 1
Name = "Guardar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.SaveView()
Wait Clear

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[START RESERVED1]
 3 ..\..\..\..\clipper2fox\fw\tieradapter\include\ta.hžÖt™÷F[END RESERVED1]
[EOF]
