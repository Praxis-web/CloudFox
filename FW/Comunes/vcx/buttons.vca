SCCTEXT Version 4.0.0.2
PLATFORM C(8,0),UNIQUEID C(10,0),TIMESTAMP N(10,0),CLASS M(4,0),CLASSLOC M(4,0),BASECLASS M(4,0),OBJNAME M(4,0),PARENT M(4,0),PROPERTIES M(4,0),PROTECTED M(4,0),METHODS M(4,0),OBJCODE M(4,0),OLE M(4,0),OLE2 M(4,0),RESERVED1 M(4,0),RESERVED2 M(4,0),RESERVED3 M(4,0),RESERVED4 M(4,0),RESERVED5 M(4,0),RESERVED6 M(4,0),RESERVED7 M(4,0),RESERVED8 M(4,0),USER M(4,0)
1252

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] Class     
[START RESERVED1]
VERSION =   3.00[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _1WV1370OA
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] close
[START PROPERTIES]
Picture = ..\image\bmp\close.bmp
DisabledPicture = ..\image\bmp\#close.bmp
Caption = "Cerrar"
PicturePosition = 1
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = Close
Name = "close"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED4]
..\image\bmp\close.bmp[END RESERVED4]
[START RESERVED5]
..\image\bmp\close.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] close
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _1WX113PAZ
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] save
[START PROPERTIES]
Picture = ..\image\bmp\save.bmp
DisabledPicture = ..\image\bmp\#save.bmp
Caption = "Aceptar"
PicturePosition = 1
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = Save
Name = "save"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\save.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] save
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _1WX116IEA
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] delete
[START PROPERTIES]
Picture = ..\image\bmp\delete.bmp
DisabledPicture = ..\image\bmp\#delete.bmp
Caption = "Borrar"
PicturePosition = 1
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = Delete
Name = "delete"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\delete.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] delete
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _1Y20ZJPYJ
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] new
[START PROPERTIES]
Picture = ..\image\bmp\new.bmp
DisabledPicture = ..\image\bmp\#new.bmp
Caption = "New"
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = New
Name = "new"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\new.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] new
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _1ZA0SFBGX
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] open
[START PROPERTIES]
Picture = ..\image\bmp\open.bmp
DisabledPicture = ..\image\bmp\#open.bmp
Caption = "Open"
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = Open
Name = "open"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\open.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] open
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _25X0PSDGS
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] report
[START PROPERTIES]
Picture = ..\image\bmp\print.bmp
DisabledPicture = ..\image\bmp\#print.bmp
Caption = "Report"
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = DoReport
Name = "report"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\print.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] report
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2A70RZSB7
[CLASS] prxcommandbutton
[CLASSLOC] prxbase.vcx
[BASECLASS] commandbutton
[OBJNAME] abstractbutton
[START PROPERTIES]
Caption = ""
lisactive = .T.
lenabled = .T.
ccommand = 
lperformautosetup = .T.
lkeepplace = .F.
noldanchor = 0
ckeyname = 
lvisible = .F.
_memberdata =     1703<VFPData><memberdata name="fontbold" type="Property" favorites="True"/><memberdata name="fontsize" type="Property" favorites="True"/><memberdata name="handleevents" type="method" display="HandleEvents"/><memberdata name="lisactive" type="property" display="lIsActive"/><memberdata name="lisactive_assign" type="property" display="lIsActive_Assign"/><memberdata name="lenabled" type="property" display="lEnabled"/><memberdata name="ccommand" type="property" display="cCommand" favorites="True"/><memberdata name="ccommand_access" type="property" display="cCommand_Access"/><memberdata name="enabled_assign" type="method" display="Enabled_Assign"/><memberdata name="lsamerowasprevious" type="property" display="lSameRowAsPrevious" favorites="True"/><memberdata name="classafterclick" type="method" display="ClassAfterClick"/><memberdata name="hookafterclick" type="method" display="HookAfterClick"/><memberdata name="execute" type="method" display="Execute"/><memberdata name="lperformautosetup" type="property" display="lPerformAutoSetup" favorites="True"/><memberdata name="autosetup" type="method" display="AutoSetup"/><memberdata name="getmeasures" type="method" display="GetMeasures"/><memberdata name="lkeepplace" type="property" display="lKeepPlace" favorites="True"/><memberdata name="anchorstatus" type="method" display="AnchorStatus"/><memberdata name="noldanchor" type="property" display="nOldAnchor"/><memberdata name="noldanchor_assign" type="method" display="nOldAnchor_Assign"/><memberdata name="autofit" type="method" display="AutoFit"/><memberdata name="ckeyname" type="property" display="cKeyName"/><memberdata name="ckeyname_access" type="method" display="cKeyName_Access"/></VFPData>

lautosetup = .T.
Name = "abstractbutton"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

Try
    With This As abstractbutton Of fw\comunes\vcx\Buttons.vcx
        If .ClassBeforeClick() And .HookBeforeClick()
            * Si el Objeto inmediatamente superior implementa el metodo Execute
            * delego la responsabilidad al Objeto.
            * y llamo al metodo propio Execute por si hay algún BindEvents al Metodo
            If Pemstatus( .Parent, 'Execute', 5 )
                .Parent.Execute( .cCommand )

            Endif
            .Execute( .cCommand )
            .HookAfterClick()
            .ClassAfterClick()
        Endif
    Endwith
Catch To oErr
    * loError = Newobject( "prxErrorHandler", "prxErrorHandler.prg" )
    loError = Thisform.oError
    loError.Process( oErr )

Finally
    loError = Null

Endtry

ENDPROC
PROCEDURE MouseEnter
Lparameters nButton, nShift, nXCoord, nYCoord

This.MousePointer = 15

ENDPROC
PROCEDURE MouseLeave
Lparameters nButton, nShift, nXCoord, nYCoord

This.MousePointer = 0

ENDPROC
PROCEDURE anchorstatus
Lparameters tnSave As Boolean

Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
Try
	If tnSave
		This.nOldAnchor = This.Anchor
		This.Anchor = 0
	Else
		This.Anchor = This.nOldAnchor
	Endif

Catch To oErr
	loError = Thisform.oError
	Thisform.cXMLoError = loError.Process( oErr )
	Throw loError

Finally
	loError = Null

Endtry



ENDPROC
PROCEDURE autosetup

*

ENDPROC
PROCEDURE ccommand_access

Return This.cCommand

ENDPROC
PROCEDURE ckeyname_access
If Empty( This.cKeyName )

	This.cKeyName = Lower( This.Parent.cDataConfigurationKey + "." + Substr( This.Name, 4 ) )
	
Endif

Return This.cKeyName

ENDPROC
PROCEDURE classafterinit

With This As abstractbutton Of fw\comunes\vcx\Buttons.vcx
    .lVisible = .Visible
Endwith

ENDPROC
PROCEDURE classbeforeinit
With This As abstractbutton Of FW\Comunes\VCX\buttons.VCX
    If Pemstatus( Thisform, "oColButtons", 5 )
        Thisform.oColButtons.AddItem( This, This.cKeyName )
    EndIf
Endwith
This.lVisible = This.Visible

ENDPROCPROCEDURE enabled_assign
Lparameters vNewVal As Boolean

Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

Try
	With This As abstractbutton Of FW\Comunes\vcx\Buttons.vcx
		.lEnabled = vNewVal
		.Enabled = m.vNewVal And .lIsActive

	Endwith
Catch To oErr
	* loError = Newobject( "prxErrorHandler", "prxErrorHandler.prg" )
	loError = Thisform.oError
	loError.Process( oErr )
	Throw loError

Finally
	loError = Null

Endtry


ENDPROC
PROCEDURE execute
Lparameters tcCommand As String
ENDPROC
PROCEDURE getmeasures

Local loCtrlMeasures As ControlMeasures Of 'fw\comunes\prg\autosetup.prg'
Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
Try
    loCtrlMeasures = Newobject( 'ControlMeasures', 'fw\comunes\prg\autosetup.prg' )
    loCtrlMeasures.Width 		= This.Width
    loCtrlMeasures.Height 		= This.Height
    loCtrlMeasures.lLabelOnTop 	= .F.
    loCtrlMeasures.nDatoWidth 	= This.Width
    loCtrlMeasures.nDatoHeight 	= This.Height
    loCtrlMeasures.nLabelWidth 	= 0
    loCtrlMeasures.nLabelHeight = 0

Catch To oErr
    loError = Thisform.oError
    Thisform.cXMLoError = loError.Process( oErr )
    Throw loError

Finally
    loError = Null

Endtry

Return loCtrlMeasures

ENDPROC
PROCEDURE lisactive_assign
Lparameters tuNewValue As Boolean
With This As abstractbutton Of FW\Comunes\vcx\Buttons.vcx
    .lIsActive = tuNewValue
    If tuNewValue
        .Enabled = .lEnabled
    Else
        .Enabled = .Enabled
    Endif
Endwith

ENDPROC
PROCEDURE noldanchor_assign
lparameters tuNewValue
This.nOldAnchor = tuNewValue

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED3]
lisactive
lenabled Mantiene el estado de la propiedad Enabled para poder recuperarlo si fue modificado por lIsActive
ccommand Nombre del metodo a ejecutar
lperformautosetup
lkeepplace
noldanchor
ckeyname
*enabled_assign 
*lisactive_assign 
*ccommand_access 
*classafterclick 
*hookafterclick 
*execute 
*autosetup 
*getmeasures 
*anchorstatus 
*noldanchor_assign 
*autofit Auto-resizes one or all visible grid columns.
*ckeyname_access 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] abstractbutton
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2MG0RTOR8
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] search
[START PROPERTIES]
Picture = ..\image\bmp\find.bmp
DisabledPicture = ..\image\bmp\#find.bmp
Caption = "Buscar"
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
Name = "search"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\find.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] search
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2MG0YGFSB
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] edit
[START PROPERTIES]
Picture = ..\image\bmp\edit.bmp
DownPicture = ..\image\bmp\#edit.bmp
Caption = "Modificar"
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = Edit
Name = "edit"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\edit.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] edit
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2ND15TBWE
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] apply
[START PROPERTIES]
Picture = ..\image\bmp\ok.bmp
DisabledPicture = ..\image\bmp\ok.bmp
Caption = "Aplicar"
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = Apply
Name = "apply"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\ok.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] apply
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2ND15ZU1D
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] preview
[START PROPERTIES]
Picture = ..\image\bmp\preview.bmp
DisabledPicture = ..\image\bmp\#preview.bmp
Caption = "Vista Previa"
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = PreviewReport
Name = "preview"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\preview.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] preview
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2ND161NK8
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] export
[START PROPERTIES]
Picture = ..\image\bmp\export.bmp
DisabledPicture = ..\image\bmp\#export.bmp
Caption = "Exportar"
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = Export
Name = "export"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\export.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] export
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2NE0L6ZJC
[CLASS] close
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] cancel
[START PROPERTIES]
Picture = ..\image\bmp\close.bmp
Caption = "Cancelar"
ccommand = Cancel
Name = "cancel"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\close.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] cancel
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2NF0XTPK3
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] next
[START PROPERTIES]
Picture = ..\image\bmp\next.bmp
Caption = "Siguiente"
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = GetNext
Name = "next"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\next.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] next
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2NF0XY6JY
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] prior
[START PROPERTIES]
Picture = ..\image\bmp\removeone.bmp
Caption = "Anterior"
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = GetPrior
Name = "prior"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\removeone.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] prior
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2NF0XYDFQ
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] first
[START PROPERTIES]
Picture = ..\image\bmp\top.bmp
Caption = "Primero"
PictureMargin = 2
PictureSpacing = 2
Alignment = 0
ccommand = GetFirst
Name = "first"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\top.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] first
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2NF0XYHU3
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] last
[START PROPERTIES]
Picture = ..\image\bmp\bottom.bmp
Caption = "Ultimo"
Alignment = 0
ccommand = GetLast
Name = "last"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED5]
..\image\bmp\bottom.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] last
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2PL0XX3ZX
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] cancelar
[START PROPERTIES]
Picture = ..\image\bmp\manocancel.bmp
DisabledPicture = ..\image\bmp\#manocancel.bmp
Caption = "Cancelar"
PictureMargin = 2
PictureSpacing = 2
ccommand = Close
Name = "cancelar"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED4]
..\image\bmp\manocancel.bmp[END RESERVED4]
[START RESERVED5]
..\image\bmp\manocancel.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] cancelar
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2PL0Y0I9N
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] ok
[START PROPERTIES]
Picture = ..\image\bmp\manook.bmp
DisabledPicture = ..\image\bmp\#manook.bmp
Caption = "Aceptar"
PictureMargin = 2
PictureSpacing = 2
ccommand = Aceptar
Name = "ok"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED4]
..\image\bmp\manook.bmp[END RESERVED4]
[START RESERVED5]
..\image\bmp\manook.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] ok
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2PT0OPYVM
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] grilla
[START PROPERTIES]
Picture = ..\image\bmp\grid.bmp
Caption = "Grilla"
PictureMargin = 2
PictureSpacing = 2
ccommand = GridReport
Name = "grilla"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED4]
..\image\bmp\grid.bmp[END RESERVED4]
[START RESERVED5]
..\image\bmp\grid.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] grilla
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2Q10PGTPU
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] personalize
[START PROPERTIES]
Picture = ..\image\bmp\label.bmp
Caption = "Personalizar"
TabIndex = 1
PictureMargin = 2
PictureSpacing = 2
ccommand = Personalize
Name = "personalize"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED4]
..\image\bmp\label.bmp[END RESERVED4]
[START RESERVED5]
..\image\bmp\label.bmp[END RESERVED5]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] personalize
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2SH164U3S
[CLASS] abstractbutton
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] debuginfo
[START PROPERTIES]
Height = 21
Width = 16
FontBold = .T.
Caption = "?"
StatusBarText = ""
TabIndex = 1
ToolTipText = ""
oform = .NULL.
_memberdata =     2025<VFPData><memberdata name="fontbold" type="Property" favorites="True"/><memberdata name="fontsize" type="Property" favorites="True"/><memberdata name="handleevents" type="method" display="HandleEvents"/><memberdata name="lisactive" type="property" display="lIsActive"/><memberdata name="lisactive_assign" type="property" display="lIsActive_Assign"/><memberdata name="lenabled" type="property" display="lEnabled"/><memberdata name="ccommand" type="property" display="cCommand" favorites="True"/><memberdata name="ccommand_access" type="property" display="cCommand_Access"/><memberdata name="enabled_assign" type="method" display="Enabled_Assign"/><memberdata name="lsamerowasprevious" type="property" display="lSameRowAsPrevious" favorites="True"/><memberdata name="classafterclick" type="method" display="ClassAfterClick"/><memberdata name="hookafterclick" type="method" display="HookAfterClick"/><memberdata name="execute" type="method" display="Execute"/><memberdata name="lperformautosetup" type="property" display="lPerformAutoSetup" favorites="True"/><memberdata name="autosetup" type="method" display="AutoSetup"/><memberdata name="getmeasures" type="method" display="GetMeasures"/><memberdata name="lkeepplace" type="property" display="lKeepPlace" favorites="True"/><memberdata name="anchorstatus" type="method" display="AnchorStatus"/><memberdata name="noldanchor" type="property" display="nOldAnchor"/><memberdata name="noldanchor_assign" type="method" display="nOldAnchor_Assign"/><memberdata name="autofit" type="method" display="AutoFit"/><memberdata name="ckeyname" type="property" display="cKeyName"/><memberdata name="ckeyname_access" type="method" display="cKeyName_Access"/><memberdata name="showform" type="method" display="ShowForm"/><memberdata name="getinfo" type="method" display="GetInfo"/><memberdata name="oform" type="property" display="oForm"/><memberdata name="hookonclick" type="method" display="HookOnClick"/><memberdata name="showformtables" type="method" display="ShowFormTables"/></VFPData>

lperformautosetup = .F.
ccommand = DebugInfo
lautosetup = .F.
Name = "debuginfo"
[END PROPERTIES]
[START METHODS]
PROCEDURE Destroy

This.oForm = Null
ENDPROCPROCEDURE Refresh
With This As CommandButton
	.Move( 0, 0 )
	.ZOrder()
	.lEnabled = .T.
	.lIsActive = .T.
	.Enabled = .T.
	
Endwith

ENDPROC
PROCEDURE RightClick

Local lnOpcion As Number
Local lcRet As String
Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
Local lcAction As String
Try
	lcRet = ''
	lnOpcion = xmenu( 'Ver Bordes;Ocultar Bordes;Ver Propiedades;Ver Propiedades Nativas;Copiar Info;Ver DataSession;Ver Tablas' )

	Do Case
		Case lnOpcion = 1 && Ver Bordes
			VerBordes( Thisform )

		Case lnOpcion = 2 && Ocultar Bordes
			OCultarBordes( Thisform )

		Case lnOpcion = 3 && Ver Propiedades
			lcAction = 'Ver Propiedades'
			lcRet = VerProperties( Thisform  )
			* _Cliptext = lcRet

		Case lnOpcion = 4 && Ver Propiedades Nativas
			lcAction = 'Ver Propiedades nativas'
			lcRet = VerProperties( Thisform, 0, .T. )
			* _Cliptext = lcRet

		Case lnOpcion = 5 && Copiar Info
			lcInfo = This.GetInfo()
			_Cliptext = lcInfo

		Case lnOpcion = 6 && Ver DataSession
			Set

		Case lnOpcion = 7 && Ver Tablas
			This.ShowFormTables()

		Otherwise

	Endcase

	This.ShowForm( lcRet, lcAction )

Catch To oErr
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	Thisform.cXMLoError = loError.Process( oErr )
	Throw loError

Finally
	loError = Null

Endtry

ENDPROC
PROCEDURE autosetup
Lparameters tvParam As Variant

With This As CommandButton
	.Move( 0, 0 )
	.ZOrder()
	.lEnabled = .T.
	.lIsActive = .T.
	.Enabled = .T.

Endwith

ENDPROC
PROCEDURE getinfo
* Cancelo el evento
#Define CR Chr( 13 )

Local lcInfo As String
Local lnRecno As Number
Local lnReccount As Number
Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
Local llIsTrans As Boolean
Local lnBuffer As Number
Local llBof As Boolean
Local llEof As Boolean
Local lcSQL As String
Local lcTables As String
Local lnWhereType As Number

Try

	*!*	loError = Thisform.oError
	*!*	loError.Remark = ''
	*!*	loError.TraceLogin = ''
	lcInfo = ''

	TEXT To lcInfo NoShow TextMerge Pretext 1 + 2 ADDITIVE
		Caption: <<Thisform.Caption>>
		DataSessionId: <<Thisform.DataSessionId>>
		WindowType: <<Thisform.WindowType>>
		cDataConfigurationKey: <<thisform.cDataConfigurationKey>>
		nEntidadId: <<Thisform.nEntidadId>>
		nProcessType: <<Thisform.nProcessType>>
		nStatus: <<Thisform.nStatus>>
		BindControls: <<Thisform.BindControls>>
		oEntity.Name: <<Thisform.oEntity.Name>>
		oEntity.Class: <<Thisform.oEntity.Class>>
		oEntity.ClassLibrary: <<Thisform.oEntity.ClassLibrary>>
		oEntity.ParentClass: <<Thisform.oEntity.ParentClass>>
		oEntity.lIsChild: <<Thisform.oEntity.lIsChild>>
		oEntity.nEntidadId: <<Thisform.oEntity.nEntidadId>>
		Txnlevel: <<Txnlevel()>>
		Tablas:


	ENDTEXT

	For i = 1 To Aused( lAUsed )
		lcAlias = Alias( lAUsed[ i, 1 ] )
		lnRecno = SaveRecNo( lcAlias )
		llIsTrans = IsTransactable( lcAlias )
		llBof = Bof( lcAlias )
		llEof = Eof( lcAlias )

		Try
			lnBuffer = CursorGetProp( "Buffering", lcAlias )
		Catch To oErr
			lnBuffer = 0
		Endtry

		Try
			lnSourceType = CursorGetProp( "SourceType", lcAlias )
		Catch To oErr
			lnSourceType = 0
		Endtry

		Try
			lcSourceName = CursorGetProp( "SourceName", lcAlias )
		Catch To oErr
			lcSourceName = ''
		Endtry

		Try
			lcSQL = CursorGetProp( "SQL", lcAlias )
		Catch To oErr
			lcSQL = ''
		Endtry

		Try
			lcTables = CursorGetProp( "Tables", lcAlias )
		Catch To oErr
			lcTables = ''
		Endtry

		Try
			lcDatabase = CursorGetProp( "Database", lcAlias )
		Catch To oErr
			lcDatabase = ''
		Endtry

		Try
			lnWhereType = CursorGetProp( "WhereType", lcAlias )
		Catch To oErr
			lnWhereType = 0
		Endtry

		* lnReccount = Reccount( Alias( lAUsed[ i, 1 ] ) )
		TEXT To lcCommand NoShow TextMerge Pretext 15
			Calculate Cnt() for ! Deleted( '<<lcAlias>>' ) to lnReccount in <<lcAlias>>

		ENDTEXT

		Try
			&lcCommand
		Catch To oErr
			lnReccount = 0
		Endtry

		TEXT To lcInfo NoShow TextMerge Pretext 1 + 2 ADDITIVE
			<<lcAlias>> bof: <<llBof>> eof: <<llEof>> reg: <<lnRecno>> de <<lnReccount>> Tx: <<llIsTrans>> Bf: <<lnBuffer>> St: <<lnSourceType>> Sn: <<lcSourceName>> SQL: <<lcSQL>> Db: <<lcDatabase>> Tbl: <<lcTables>> Wt: <<lnWhereType>>

		ENDTEXT

		RestRecNo( lnRecno, Alias( lAUsed[ i, 1 ] ) )

	Endfor

Catch To oErr
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	Thisform.cXMLoError = loError.Process( oErr )
	Throw loError

Finally
	loError = Null

Endtry

Return lcInfo

ENDPROC
PROCEDURE hookbeforeclick
* Cancelo el evento
#Define CR Chr( 13 )

Local lcInfo As String
Local lnRecno As Number
Local lnReccount As Number
Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
Local llIsTrans As Boolean
Local lnBuffer As Number
Local llBof As Boolean
Local llEof As Boolean
Local lcSQL As String
Local lcTables As String
Local lnWhereType As Number

Try
	lcInfo = This.GetInfo()
	This.ShowForm( lcInfo )

Catch To oErr
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	Thisform.cXMLoError = loError.Process( oErr )
	Throw loError

Finally
	loError = Null

Endtry

Return .F.

ENDPROC
PROCEDURE hookbeforeinit
With This As CommandButton
	.Visible = ! IsRuntime()&&  And ( Thisform.WindowType = 1 )
	Bindevent( Thisform, 'HookAfterAutoSetup', This, 'AutoSetup' )
	.Move( 0, 0 )
	.lEnabled = .T.	
	.lIsActive = .T.
	.Enabled = .T.
	.ZOrder()
	
Endwith
ENDPROC
PROCEDURE hookonclick

Local loListBox As ListBox
Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
Local loGrid As Grid
Local lcTable As String
Local lnScaleMode As Number
Try
	* If Vartype( This.oForm ) = 'C'
	loListBox = This.oForm.cntLst
	lcTable = loListBox.List( loListBox.ListIndex )

	Select Alias( lcTable )
	Browse Font 'Verdana', 8 Name loGrid Nowait
	lnScaleMode = _Screen.ScaleMode
	_Screen.ScaleMode = 0
	loGrid.Move( 10, 10, _Screen.Width - 20 , _Screen.Height - 20 )
	loGrid.AutoFit()
	_Screen.ScaleMode = lnScaleMode

	* Endif && Vartype( This.oForm ) = 'C'

Catch To oErr
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )
	* Throw loError

Finally
	loError = Null
	loListBox = Null
	loGrid = Null

Endtry

ENDPROC
PROCEDURE showform
Lparameters tcRet As String, tcAction As String

Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
Local loEdit As EditBox
Try

	If ! Empty( tcRet )
		If Empty( tcAction )
			tcAction = ''
		Else
			tcAction = ' - ' + Transform( tcAction )

		Endif && Empty( tcAction )

		* _Cliptext = tcRet
		loForm = Createobject( "Form" )
		loForm.AddObject( "cntEdit", "EditBox" )
		loForm.Width = 600

		loEdit = loForm.cntEdit
		loEdit.Visible = .T.
		*loEdit.ZOrder()

		loEdit.Top = 10
		loEdit.Left = 10
		loEdit.Width = loForm.Width - 20
		loEdit.Height = loForm.Height - 20
		loEdit.Anchor = 15

		loEdit.Value = tcRet
		loEdit.FontName = "Verdana"
		loEdit.FontSize = 8

		loForm.Caption = "Debug Info " + tcAction + " (" + Thisform.Caption + ")"
		loForm.AutoCenter = .T.

		loForm.Show( 1 )

	Endif && ! Empty( tcRet )

Catch To oErr
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally
	loError = Null

Endtry

ENDPROC
PROCEDURE showformtables

Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
Local loListBox As ListBox
Local i As Integer
Local Array laUsed[ 1 ]
Local loForm As Form

Try

	loForm = Createobject( "Form" )
	loForm.AddObject( "cntLst", "ListBox" )
	loForm.Width = 600

	loListBox = loForm.cntLst
	loListBox.Visible = .T.
	loListBox.Top = 10
	loListBox.Left = 10
	loListBox.Width = loForm.Width - 20
	loListBox.Height = loForm.Height - 20
	loListBox.Anchor = 15

	lnLen = Aused( laUsed )
	If lnLen > 0
		For i = 1 To lnLen
			loListBox.AddItem( laUsed[ i, 1 ] )

		Endfor

		Bindevent( loListBox, 'DblClick', This, 'HookOnClick' )

		loListBox.FontName = "Verdana"
		loListBox.FontSize = 8

		loForm.Caption = "Debug Info - Ver tablas (" + Thisform.Caption + ")"
		loForm.AutoCenter = .T.

		This.oForm = loForm

		loForm.Show( 1 )
	Else
		This.oForm = Null

	Endif && lnLen > 0

Catch To oErr
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally
	loError = Null
	loListBox = Null

Endtry

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED3]
oform
*showform 
*getinfo 
*hookonclick 
*showformtables 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]
[START RESERVED7]
Información para debug[END RESERVED7]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] debuginfo
[START PROPERTIES]
Arial, 1, 9, 6, 15, 12, 32, 3, 0
[END PROPERTIES]
[EOF]
