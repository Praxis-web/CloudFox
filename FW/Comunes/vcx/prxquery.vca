SCCTEXT Version 4.0.0.2
PLATFORM C(8,0),UNIQUEID C(10,0),TIMESTAMP N(10,0),CLASS M(4,0),CLASSLOC M(4,0),BASECLASS M(4,0),OBJNAME M(4,0),PARENT M(4,0),PROPERTIES M(4,0),PROTECTED M(4,0),METHODS M(4,0),OBJCODE M(4,0),OLE M(4,0),OLE2 M(4,0),RESERVED1 M(4,0),RESERVED2 M(4,0),RESERVED3 M(4,0),RESERVED4 M(4,0),RESERVED5 M(4,0),RESERVED6 M(4,0),RESERVED7 M(4,0),RESERVED8 M(4,0),USER M(4,0)
1252

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] Class     
[START RESERVED1]
VERSION =   3.00[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EA0OSIN3
[CLASS] prxform
[CLASSLOC] prxbase.vcx
[BASECLASS] form
[OBJNAME] queryform
[START PROPERTIES]
Height = 530
Width = 764
DoCreate = .T.
Caption = "Consulta"
dataconfigurationkey = 
ousertier = .NULL.
querymethod = DoQuery
oparam = .NULL.
calias = 
cfilter = 
creportfilename = 
performautosetup = .T.
_memberdata =     2591<VFPData><memberdata name="oreturn" type="property" display="oReturn" favorites="True" override="True"/><memberdata name="oreturnobject" type="property" display="oReturnObject"/><memberdata name="oerror" type="property" display="oError"/><memberdata name="isok" type="property" display="IsOk"/><memberdata name="otxtproperties" type="property" display="oTxtProperties"/><memberdata name="gapsize" type="property" display="GapSize"/><memberdata name="gap" type="property" display="Gap"/><memberdata name="bottommargin" type="property" display="BottomMargin"/><memberdata name="leftmargin" type="property" display="LeftMargin"/><memberdata name="performautofit" type="property" display="PerformAutofit"/><memberdata name="rightmargin" type="property" display="RightMargin"/><memberdata name="topmargin" type="property" display="TopMargin"/><memberdata name="autosetup" type="method" display="AutoSetup"/><memberdata name="performautosetup" type="property" display="PerformAutoSetup"/><memberdata name="ocolobjects" type="property" display="oColObjects"/><memberdata name="handleevents" type="method" display="HandleEvents"/><memberdata name="loldperformautosetup" type="property" display="lOldPerformAutoSetup"/><memberdata name="releaseobjects" type="method" display="ReleaseObjects"/><memberdata name="dataconfigurationkey" type="property" display="DataConfigurationKey" favorites="True"/><memberdata name="ousertier" type="property" display="oUserTier"/><memberdata name="ousertier_access" type="property" display="oUserTier_Access"/><memberdata name="doquery" type="method" display="DoQuery"/><memberdata name="getwherestatement" type="method" display="GetWhereStatement"/><memberdata name="querymethod" type="property" display="QueryMethod" favorites="True"/><memberdata name="hookbeforedoquery" type="method" display="HookBeforeDoQuery"/><memberdata name="getfiltercriteria" type="method" display="GetFilterCriteria"/><memberdata name="getorderby" type="method" display="GetOrderBy"/><memberdata name="oparam" type="property" display="oParam"/><memberdata name="beforebindcontrols" type="method" display="BeforeBindControls"/><memberdata name="afterbindcontrols" type="method" display="AfterBindControls"/><memberdata name="closecursors" type="method" display="CloseCursors"/><memberdata name="calias" type="property" display="cAlias"/><memberdata name="cfilter" type="property" display="cFilter"/><memberdata name="creportfilename" type="property" display="cReportFileName" favorites="True"/><memberdata name="populateproperties" type="method" display="PopulateProperties"/></VFPData>

Name = "queryform"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Lparameters oParam as Object

Try

	Thisform.BorderStyle = 0
	
	Thisform.oParam = oParam
	
	Thisform.PopulateProperties( oParam )
	
	This.lIsOk = DoDefault()
	
	ThisForm.Queryoptionpanel.Width = This.pageFrame.Width


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )
	This.lIsOk = .F.

Finally

Endtry

Return This.lIsOk

ENDPROC
PROCEDURE KeyPress
#INCLUDE "FW\Comun\Include\Praxis.h"
#INCLUDE "FW\Tieradapter\Include\TA.h"

Lparameters nKeyCode, nShiftAltCtrl

Try

	This.oError.Ctracelogin = ""
	This.oError.Cremark = ""

*!*		=Messagebox( "nKeyCode: "+ ANY2cHAR(nKeyCode) + CR + "nShiftAltCtrl: " + ANY2cHAR(nShiftAltCtrl))

	With Thisform

		Do Case
			
			Case nShiftAltCtrl = KEY_CTRL_DOWN
				Do Case
						*Case nKeyCode = KEY_FLECHA_ARRIBA
					Case nKeyCode = 141
						This.Enlarge()

						*Case nKeyCode = KEY_FLECHA_ABAJO
					Case nKeyCode = 145
						This.Shrink()

						*Case nKeyCode = KEY_F10
					Case nKeyCode = 103
						Set

						*Case nKeyCode = "D"
					Case nKeyCode = 4
						Debug

					Otherwise
						DoDefault(nKeyCode, nShiftAltCtrl)

				Endcase

			Otherwise

		Endcase
	Endwith
Catch To oErr
	This.lIsOk = .F.
	This.XMLoError=This.oError.Process( oErr )

Finally

Endtry

ENDPROC
PROCEDURE QueryUnload
This.ReleaseObjects()
ENDPROC
PROCEDURE beforebindcontrols
Try

	ThisForm.PageFrame.Page1.frmQueryGrid.FillGrid()

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

Endtry

ENDPROC
PROCEDURE bindcontrols_assign
Lparameters vNewVal

If vNewVal = .T.
	Thisform.BeforeBindControls()
EndIf

This.BindControls = m.vNewVal

If vNewVal = .T.
	Thisform.AfterBindControls()
EndIf

ENDPROC
PROCEDURE closecursors
Local lnTotal As Integer	,;
	niCount As Integer		,;
	lcTable As String		,;
	loCatchErr As Exception
Local Array laTables[1]

Try

	lnTotal = Aused( laTables )
	For niCount = 1 To lnTotal
		lcTable = laTables[ niCount, 1 ]
		If Used( lcTable )
			Use In ( lcTable )
		Endif
	Next
	
Catch To oErr
	This.oError.Process( oErr )

Finally

Endtry

ENDPROC
PROCEDURE doquery
Local loEntity As Object
Local lcMethod As String
Local loParam As Object

Try

	This.BindControls = .F.
	
	This.CloseCursors()

	lcMethod = Thisform.QueryMethod
	loEntity = Thisform.oUserTier

	loParam = Createobject( "Empty" )

	AddProperty( loParam, "FilterCriteria", Thisform.GetFilterCriteria() )
	AddProperty( loParam, "OrderBy", Thisform.GetOrderBy() )
	AddProperty( loParam, "Alias", "Query" + Sys(2015) )

	Thisform.HookBeforeDoQuery( loParam )

	Thisform.PageFrame.Page1.frmQueryGrid.QueryGrid.AsociatedCursor = loParam.Alias
	
	Thisform.cAlias = loParam.Alias

	Wait Window "Ejecutando Consulta ...." Nowait

	loEntity.&lcMethod.( loParam )

	This.BindControls = .T.
	
	Wait Clear

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )


Finally
	loEntity = Null
	loParam = Null

Endtry

ENDPROC
PROCEDURE getfiltercriteria
Local lcFilterCriteria as String

Try

	lcFilterCriteria = ThisForm.PageFrame.Page2.FiltroFrame.Filtros.GetWhereStatement()
	

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

Return lcFilterCriteria

ENDPROC
PROCEDURE getorderby
Local lcOrderBy as String

Try

	lcOrderBy = ""
	

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

Return lcOrderBy

ENDPROC
PROCEDURE hookbeforedoquery
Lparameters loParam
ENDPROC
PROCEDURE ousertier_access
Try

	If Vartype( This.oUserTier ) <> "O"

		Local loParam As Object
		Local loNextTierFactory As ObjectFactory Of "Fw\Comun\Prg\ObjectFactory.prg"

		loParam = Createobject( "Empty" )
		AddProperty( loParam, "ObjectName", This.cDataConfigurationKey  )
		AddProperty( loParam, "TierLevel", "User" )
		AddProperty( loParam, "uParameter", This.DataSessionId )

		loNextTierFactory = Newobject( "ObjectFactory",;
			"ObjectFactory.prg",;
			"",;
			loParam )

		This.oUserTier = loNextTierFactory.Getobject()

	Endif

Catch To oErr
	This.lIsOk = .F.
	This.oError.Process( oErr )


Finally
	loParam = Null
	loNextTierFactory = Null

Endtry

Return This.oUserTier

ENDPROC
PROCEDURE populateproperties
Lparameters toParam

If Vartype( toParam ) == "O"
	Local laMembers[1] as String
	
	AMembers( laMembers, toParam )
	
	For Each cProperty in laMembers
		Try
			Thisform.&cProperty = toParam.&cProperty
		
		Catch To oErr
			* No hago nada

		Finally

		EndTry

	EndFor

EndIf
ENDPROC
PROCEDURE releaseobjects
Try

	Thisform.CloseCursors()
	DoDefault()

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

ENDPROC[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
3[END RESERVED2]
[START RESERVED3]
dataconfigurationkey
ousertier
querymethod Nombre del metodo que se ejecuta en la entidad
oparam
calias
cfilter
creportfilename Nombre del archivo .Frx que debe ejecutarse
*ousertier_access 
*doquery 
*hookbeforedoquery 
*getfiltercriteria 
*getorderby 
*beforebindcontrols 
*afterbindcontrols 
*bindcontrols_assign 
*closecursors 
*populateproperties 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EA0PHUM9
[CLASS] querypageframe
[CLASSLOC] prxquery.vcx
[BASECLASS] pageframe
[OBJNAME] PageFrame
[PARENT] queryform
[START PROPERTIES]
ErasePage = .T.
Top = 40
Left = 36
Height = 421
Name = "PageFrame"
Page1.frmQueryGrid.Shape.Name = "Shape"
Page1.frmQueryGrid.lblTitulo.Name = "lblTitulo"
Page1.frmQueryGrid.shpLabel.Name = "shpLabel"
Page1.frmQueryGrid.querygrid.Name = "querygrid"
Page1.frmQueryGrid.Name = "frmQueryGrid"
Page1.Name = "Page1"
Page2.FiltroFrame.Shape.Name = "Shape"
Page2.FiltroFrame.lblTitulo.Name = "lblTitulo"
Page2.FiltroFrame.shpLabel.Name = "shpLabel"
Page2.FiltroFrame.Filtros.Name = "Filtros"
Page2.FiltroFrame.Name = "FiltroFrame"
Page2.Name = "Page2"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EA0TDPA7
[CLASS] queryoptionpanel
[CLASSLOC] prxquery.vcx
[BASECLASS] container
[OBJNAME] queryOptionPanel
[PARENT] queryform
[START PROPERTIES]
Top = 465
Left = 39
Name = "queryOptionPanel"
Shape.Name = "Shape"
lblTitulo.Name = "lblTitulo"
shpLabel.Name = "shpLabel"
cmdCancel.Name = "cmdCancel"
cmdPrint.Name = "cmdPrint"
cmdQuery.Name = "cmdQuery"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] queryform
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[START RESERVED1]
  ..\include\praxis.h∆"ÀÉd: ..\include\foxpro.hŒ#‰I9 ..\include\strings.h÷$—eX9 ..\..\tier adapter\include\ta.hﬁ%¶õç:[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EA0OWA68
[CLASS] abmparentfamilypageframe
[CLASSLOC] prxmainform.vcx
[BASECLASS] pageframe
[OBJNAME] querypageframe
[START PROPERTIES]
ErasePage = .T.
Width = 662
Height = 421
Name = "querypageframe"
Page1.Caption = "Consulta"
Page1.Name = "Page1"
Page2.Caption = "Opciones"
Page2.Name = "Page2"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
If Vartype( _Screen.oApp ) = "O"
	This.PageFontSize = This.PageFontSize + _Screen.oApp.nUpdateFontSize
EndIf


ENDPROCPROCEDURE lazyload
Lparameters oPage as Page

Try

*!*		If Thisform.BindControls
*!*			This.BeforeBindControls()
*!*		EndIf	
	
	Do Case
	Case Lower( oPage.Name ) = Lower( "Cuerpo" )
		Thisform.LockScreen = .T.
		This.Cuerpo.Datos.Llenarhijos()
		
		
	Otherwise

	EndCase

	

Catch To oErr
	Thisform.LockScreen = .F.
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )


Finally
	Thisform.LockScreen = .F.

EndTry

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
3[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EA0PHD74
[CLASS] querygrid
[CLASSLOC] prxquery.vcx
[BASECLASS] container
[OBJNAME] frmQueryGrid
[PARENT] querypageframe.Page1
[START PROPERTIES]
Top = 36
Left = 31
Name = "frmQueryGrid"
Shape.Name = "Shape"
lblTitulo.Name = "lblTitulo"
shpLabel.Name = "shpLabel"
QUERYGRID.Name = "QUERYGRID"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EX0UHY7D
[CLASS] queryfiltro
[CLASSLOC] prxquery.vcx
[BASECLASS] container
[OBJNAME] FiltroFrame
[PARENT] querypageframe.Page2
[START PROPERTIES]
Top = 34
Left = 32
Name = "FiltroFrame"
Shape.Name = "Shape"
lblTitulo.Name = "lblTitulo"
shpLabel.Name = "shpLabel"
Filtros.Name = "Filtros"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] querypageframe

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EA0OXM03
[CLASS] ccmarco
[CLASSLOC] controles_varios.vcx
[BASECLASS] container
[OBJNAME] querygrid
[START PROPERTIES]
Width = 398
Height = 301
oentity = .NULL.
lfittoparent = .T.
_memberdata =     1423<VFPData><memberdata name="autofit" type="method" display="Autofit"/><memberdata name="gap" type="property" display="Gap"/><memberdata name="lautofit" type="property" display="lAutofit"/><memberdata name="lautosetup" type="property" display="lAutoSetup"/><memberdata name="samerowasprevious" type="property" display="SameRowAsPrevious" favorites="True"/><memberdata name="fittoparent" type="method" display="FitToParent"/><memberdata name="nupdatefontsize" type="property" display="nUpdateFontSize"/><memberdata name="nupdatefontsize_assign" type="method" display="nUpdateFontSize_Assign"/><memberdata name="bottommargin" type="Property" favorites="True"/><memberdata name="resalttittle" type="property" display="ResaltTittle" favorites="True"/><memberdata name="oldshapecolor" type="property" display="OldShapeColor"/><memberdata name="lresalttittle" type="property" display="lResaltTittle" favorites="True"/><memberdata name="resalttittle" type="method" display="ResaltTittle"/><memberdata name="readonly" type="property" display="ReadOnly"/><memberdata name="readonly_assign" type="property" display="ReadOnly_Assign"/><memberdata name="lfittoparent" type="property" display="lFitToParent" favorites="True"/><memberdata name="fillgrid" type="method" display="FillGrid"/><memberdata name="oentity" type="property" display="oEntity"/><memberdata name="oentity_access" type="property" display="oEntity_Access"/></VFPData>

Name = "querygrid"
Shape.Name = "Shape"
lblTitulo.Name = "lblTitulo"
shpLabel.Name = "shpLabel"
[END PROPERTIES]
[START METHODS]
PROCEDURE autosetup
#INCLUDE "Fw\Comun\Include\Praxis.h"

Try

	This.QueryGrid.oColLayout = This.oEntity.oColGridLayout
	This.QueryGrid.AutoSetUp()

	This.Width = This.QueryGrid.Width + This.LeftMargin + This.RightMargin
	This.QueryGrid.Left = This.LeftMargin
	This.QueryGrid.Top =  This.TopMargin


	This.Height = This.TopMargin + This.QueryGrid.Height + This.BottomMargin

	With This
		.ZOrder( 1 )
		.BorderWidth 	= 0
		.BackColor 		= .Parent.BackColor
	Endwith

	With This.Shape
		.Top 			= This.lblTitulo.Height / 2
		.Left 		= 0
		.Height 		= This.Height - ( This.lblTitulo.Height / 2 )
		.Width 		= This.Width
		.BackColor 	= .Parent.BackColor
		.ZOrder( 1 )
		.Anchor = ANCHOR_Top_Absolute + ;
			ANCHOR_Left_Absolute + ;
			ANCHOR_Bottom_Absolute + ;
			ANCHOR_Right_Absolute
	Endwith


	With This.lblTitulo
		.Top 			= 0
		.Left 		= This.Shape.Left + ( .Height / 2 )
		.BackColor 	= .Parent.BackColor
		.DisabledBackColor = Thisform.BackColor
		.ZOrder( 0 )
	Endwith

	With This.shplabel As Shape
		.Top 		= This.lblTitulo.Top
		.Left 		= This.lblTitulo.Left
		.Width 		= This.lblTitulo.Width
		.Height 	= This.lblTitulo.Height
		.BackColor 	= .Parent.BackColor
		.Visible 	= This.lblTitulo.Visible
	Endwith


	This.QueryGrid.Anchor = ANCHOR_Top_Absolute + ;
		ANCHOR_Left_Absolute + ;
		ANCHOR_Right_Absolute + ;
		ANCHOR_Bottom_Absolute

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )

Finally

Endtry


ENDPROCPROCEDURE fillgrid
Lparameters nEntityId As Integer

Local lcPK As String

Try

	If Empty( nEntityId )
		nEntityId = 0
	Endif

	With This.QueryGrid  As prxActionGrid Of "FW\Comun\Vcx\prxMainForm.vcx"

		If Empty( .AsociatedCursor )
			.AsociatedCursor = This.oEntity.MainCursorName
		Endif

		If Empty( .PKField )
			.PKField = This.oEntity.MainCursorPK
		Endif

		lcPK = .PKField

		.oColLayout = This.oEntity.oColGridLayout

		.FillGrid()

		Do Case
			Case .ColumnCount = 1
				* Si tiene una sola columna, que ocupe todo el ancho
				.Columns[ 1 ].Width = .Width
				.SetFocus()

			Case .ColumnCount > 1
				* Si tiene m·s de una columna, adapto el ancho de la ˙ltima para que
				* llene todo el espacio
				Local q As Integer,;
					lnTotalWidth As Integer

				lnTotalWidth = 0
				For q = 1 To .ColumnCount
					lnTotalWidth = lnTotalWidth +  .Columns[ q ].Width
				Endfor

				If lnTotalWidth < .Width
					Local lnDifference As Integer

					lnDifference = .Width - lnTotalWidth
					.Columns[ .ColumnCount ].Width = ;
						.Columns[ .ColumnCount ].Width + lnDifference

				Endif

				.SetFocus()

		Endcase

	Endwith

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )

Finally

Endtry


ENDPROC
PROCEDURE oentity_access

If Vartype( This.oEntity ) <> "O"
	This.oEntity = Thisform.oUserTier
Endif

Return This.oEntity

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
2[END RESERVED2]
[START RESERVED3]
oentity
*fillgrid 
*oentity_access 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EA0OYWB2
[CLASS] prxactiongrid
[CLASSLOC] prxmainform.vcx
[BASECLASS] grid
[OBJNAME] QueryGrid
[PARENT] querygrid
[START PROPERTIES]
Left = 28
Top = 32
Name = "QueryGrid"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] querygrid
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[START RESERVED1]
  ..\include\praxis.hn„ÀÉd: ..\include\foxpro.hv‰‰I9 ..\include\strings.h~Â—eX9[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EA0SWQC0
[CLASS] ccmarco
[CLASSLOC] controles_varios.vcx
[BASECLASS] container
[OBJNAME] queryoptionpanel
[START PROPERTIES]
Width = 670
Height = 74
topmargin = 10
Name = "queryoptionpanel"
Shape.Name = "Shape"
lblTitulo.Top = -500
lblTitulo.Visible = .F.
lblTitulo.Name = "lblTitulo"
shpLabel.Name = "shpLabel"
[END PROPERTIES]
[START METHODS]
PROCEDURE autosetup
#INCLUDE "FW\Comun\Include\Praxis.h"

Try
	Local loButton As CommandButton
	Local lnTop As Integer,;
		lnLeft As Integer,;
		lnWidth As Integer,;
		lnHeight As Integer,;
		lnTotalWidth As Integer

	Local llFirst As Boolean

	Local laButtons[3]

	laButtons[1] = This.cmdCancel
	laButtons[2] = This.cmdPrint
	laButtons[3] = This.cmdQuery
	
	llFirst = .T.
	lnTop = This.TopMargin
	lnLeft = This.LeftMargin
	lnTotalWidth = 0

	This.oColObjects = OrderControlsByKey( This )

	For Each loButton In laButtons
		If loButton.Visible
			If llFirst
				lnWidth = loButton.Width
				lnHeight = loButton.Height
				llFirst = .F.
			Endif

			loButton.Height = lnHeight
			loButton.Top = lnTop

			loButton.Left = lnTotalWidth + This.LeftMargin
			lnTotalWidth = loButton.Left + loButton.Width

		Endif
	Endfor

	This.Width = This.LeftMargin + lnTotalWidth + This.RightMargin
	This.Height = This.TopMargin + lnHeight + This.BottomMargin

	With This
		.ZOrder( 1 )
		.BorderWidth 	= 0
		.BackColor 		= .Parent.BackColor
	Endwith

	With This.Shape
		.Top 			= 0
		.Height 		= This.Height
		.Left 		= 0
		.Width 		= This.Width
		.BackColor 	= .Parent.BackColor
		.ZOrder( 1 )
		.Anchor = ANCHOR_Top_Absolute + ;
			ANCHOR_Left_Absolute + ;
			ANCHOR_Bottom_Absolute + ;
			ANCHOR_Right_Absolute
	Endwith

	With This.lblTitulo
		.Top 			= 0
		.Left 		= This.Shape.Left + ( .Height / 2 )
		.BackColor 	= .Parent.BackColor
		.DisabledBackColor = Thisform.BackColor
	Endwith

	For Each loButton In laButtons
		If loButton.Visible
			Do Case
				Case Lower( loButton.Name ) = "cmdclose" Or ;
						Lower( loButton.Name ) = "cmdcancel" Or ;
						Lower( loButton.Name ) = "cmddelete"

					loButton.Anchor = ANCHOR_Left_Absolute

				Otherwise
					loButton.Anchor = ANCHOR_Right_Absolute

			Endcase

		Endif
	Endfor


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )

Finally

Endtry


ENDPROCPROCEDURE nupdatefontsize_assign
Lparameters tuNewValue

This.nUpdateFontSize = tuNewValue

Try

	Local oCtrl as Object
	
	For Each oCtrl In This.oColObjects
		oCtrl.FontSize = oCtrl.FontSize + tuNewValue
	EndFor
	This.AutoSetup()
	
Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Process( oErr )


Finally

Endtry


ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
4[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EA0TCR9W
[CLASS] cancel
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] cmdCancel
[PARENT] queryoptionpanel
[START PROPERTIES]
Top = 26
Left = 9
Name = "cmdCancel"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Release()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EA0TCRA0
[CLASS] report
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] cmdPrint
[PARENT] queryoptionpanel
[START PROPERTIES]
Top = 27
Left = 188
Caption = "Imprimir"
Name = "cmdPrint"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EA0TCRA2
[CLASS] apply
[CLASSLOC] buttons.vcx
[BASECLASS] commandbutton
[OBJNAME] cmdQuery
[PARENT] queryoptionpanel
[START PROPERTIES]
Top = 27
Left = 499
FontSize = 9
Caption = "Consultar"
Name = "cmdQuery"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.DoQuery()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] queryoptionpanel
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[START RESERVED1]
  ..\include\praxis.h·ÀÉd: ..\include\foxpro.h‚‰I9 ..\include\strings.h&„—eX9[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EX0UCHG7
[CLASS] ccmarco
[CLASSLOC] controles_varios.vcx
[BASECLASS] container
[OBJNAME] queryfiltro
[START PROPERTIES]
Width = 552
Height = 376
Name = "queryfiltro"
Shape.Name = "Shape"
lblTitulo.Caption = "Filtrado Por"
lblTitulo.Name = "lblTitulo"
shpLabel.Name = "shpLabel"
[END PROPERTIES]
[START METHODS]
PROCEDURE autosetup
This.Filtros.Autofit()
DoDefault()

This.Height = This.TopMargin + This.filtros.Height + This.BottomMargin
This.Width = This.LeftMargin + This.Filtros.Width + This.RightMargin

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
2[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2EX0UG8U8
[CLASS] cntfiltro
[CLASSLOC] filtros.vcx
[BASECLASS] container
[OBJNAME] Filtros
[PARENT] queryfiltro
[START PROPERTIES]
Top = 30
Left = 28
Width = 464
Height = 294
Name = "Filtros"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
This.BorderWidth = 0
If Pemstatus( Thisform, "oFiltro", 5 )
	Thisform.oFiltro = This
Endif
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] queryfiltro
[EOF]
