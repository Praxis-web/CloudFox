SCCTEXT Version 4.0.0.2
PLATFORM C(8,0),UNIQUEID C(10,0),TIMESTAMP N(10,0),CLASS M(4,0),CLASSLOC M(4,0),BASECLASS M(4,0),OBJNAME M(4,0),PARENT M(4,0),PROPERTIES M(4,0),PROTECTED M(4,0),METHODS M(4,0),OBJCODE M(4,0),OLE M(4,0),OLE2 M(4,0),RESERVED1 M(4,0),RESERVED2 M(4,0),RESERVED3 M(4,0),RESERVED4 M(4,0),RESERVED5 M(4,0),RESERVED6 M(4,0),RESERVED7 M(4,0),RESERVED8 M(4,0),USER M(4,0)
1252

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] Class     
[START RESERVED1]
VERSION =   3.00[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6870UO5CO
[CLASS] _form
[CLASSLOC] ..\..\fw\comunes\vcx\_controles_base.vcx
[BASECLASS] form
[OBJNAME] informes
[START PROPERTIES]
Top = -3
Left = -1
Height = 360
Width = 720
DoCreate = .T.
Caption = "Informes"
MinHeight = 60
WindowType = 1
clave = 0
oparametros = .NULL.
ncalculatedheight = 0
ngap = 12
ctitulodelprograma = 
ocolfiltros = .NULL.
oinforme = .NULL.
ocolfiltrosadicionales = .NULL.
_memberdata =     1117<VFPData><memberdata name="ejecutar" display="Ejecutar"/><memberdata name="clave" display="CLAVE"/><memberdata name="oparametros" display="oParametros"/><memberdata name="autosize" display="Autosize"/><memberdata name="sincronizarcontroles" display="SincronizarControles"/><memberdata name="hookafterinit" display="HookAfterInit"/><memberdata name="ncalculatedheight" display="nCalculatedHeight"/><memberdata name="ngap" display="nGap"/><memberdata name="ctitulodelprograma" display="cTituloDelPrograma"/><memberdata name="ocolfiltros" display="oColFiltros"/><memberdata name="ocolfiltros_access" display="oColFiltros_Access"/><memberdata name="oinforme" display="oInforme"/><memberdata name="oinforme_access" display="oInforme_Access"/><memberdata name="tipoinformeinteractivechange" display="TipoInformeInteractiveChange"/><memberdata name="ocolfiltrosadicionales" display="oColFiltrosAdicionales"/><memberdata name="ocolfiltrosadicionales_access" display="oColFiltrosAdicionales_Access"/><memberdata name="hoockautosize" display="HoockAutosize"/><memberdata name="hoockejecutar" display="HoockEjecutar"/></VFPData>
Name = "informes"
[END PROPERTIES]
[START METHODS]
PROCEDURE Destroy
This.oColFiltros 			= Null
This.oColFiltrosAdicionales = Null
This.oColTables 			= Null
This.oControles 			= Null
This.oParametros 			= Null
This.oRegistro 				= Null
This.oBiz 					= Null

ENDPROC
PROCEDURE Init
#INCLUDE "FW\Comunes\Include\Praxis.h"

Lparameters oParam As Object

Local lcCommand As String
Local loBiz As oModelo Of "FrontEnd\Prg\Movimiento.prg",;
	loReturn As Object

Local llOk As Boolean


Try

	lcCommand = ""
	llOk = .F.
	
	Thisform.cModelo 	= oParam.cModelo
	Thisform.oBiz 		= oParam.oBiz
	loBiz 				= Thisform.oBiz

	Thisform.InitializeControls()
	Thisform.SincronizarControles()
	Thisform.TipoInformeInteractiveChange( ThisForm.Tipo.cboInforme )
	*Thisform.AutoSize()
	
	

	This.BindControls = .T.
	Thisform.HookAfterInit()
	Thisform.Visible = .T.

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	loBiz = Null

	oParam 		= Null


Endtry

ENDPROC
PROCEDURE Load
#INCLUDE "FW\Comunes\Include\Praxis.h"

If !IsRuntime()
	Set Datasession To
EndIf

Thisform.BindControls = .F.
Thisform.Visible = .F.
Thisform.MaxWidth = Sysmetric( SYSMETRIC_SCREENWIDTH ) - ( 2 * Sysmetric( SYSMETRIC_VSCROLLBARWIDTH ) )
Thisform.BorderStyle = 2

If Vartype( CLAVE ) # "N"
	CLAVE = 5
Endif

This.CLAVE = CLAVE

Thisform.oParametros = Createobject( "Empty" )
AddProperty( Thisform.oParametros, "WCLAV", "A" )


ENDPROC
PROCEDURE autosize
Local lcCommand As String
Local lnFormHeight As Integer,;
	lnHeight As Integer
Local llAutocenter As Boolean

Try

	lcCommand = ""
	llAutocenter = .F.
	Thisform.LockScreen = .T.
	
*!*		Thisform.LockScreen = .F.
*!*		Thisform.Visible 	= .T.
*!*		Thisform.Tipo.BorderWidth = 1
*!*		Thisform.Filtros.BorderWidth = 1
*!*		Thisform.Filtros_adicionales.BorderWidth = 1
	*Set Step On

	Thisform.Titulo.Anchor 		= 0
	Thisform.Tipo.Anchor 		= 0
	Thisform.Acciones.Anchor 	= 0
	Thisform.Filtros.Anchor 	= 0
	Thisform.Filtros_Adicionales.Anchor = 0

	lnFormHeight = ( Thisform.nCalculatedHeight + Thisform.Acciones.Height )
	lnFormHeight = lnFormHeight + ( Thisform.nGap * 3 )

	If lnFormHeight > Thisform.Height
		Thisform.Height = lnFormHeight
	Endif

	If Mod( Thisform.Width, Thisform.nGap ) > 0
		Thisform.Width = Round( Thisform.Width / Thisform.nGap, 0 ) * Thisform.nGap
	Endif

	If Mod( Thisform.Height, Thisform.nGap ) > 0
		Thisform.Height = Round( Thisform.Height / Thisform.nGap, 0 ) * Thisform.nGap
	Endif

	Thisform.Titulo.Top 	= 0
	Thisform.Titulo.Left 	= 0
	Thisform.Titulo.AutoSize()

	If Thisform.Titulo.Width > Thisform.Width
		Thisform.Width = Thisform.Titulo.Width

	Else
		Thisform.Titulo.Width 	= Thisform.Width

	Endif

	Thisform.Tipo.Top = Thisform.Titulo.Top + Thisform.Titulo.Height

	If Thisform.Tipo.Visible
		Thisform.Filtros.Top = Thisform.Tipo.Top + Thisform.Tipo.Height
		Thisform.Filtros.Left = 0
		Thisform.Filtros.Width = Thisform.Width

	Else
		Thisform.Filtros.Top = Thisform.Tipo.Top

	EndIf
	
	Thisform.Filtros.Autosize()
	
	If Thisform.Filtros.Visible
		Thisform.Filtros_Adicionales.Top 	= Thisform.Filtros.Top + Thisform.Filtros.Height

	Else
		Thisform.Filtros_Adicionales.Top 	= Thisform.Filtros.Top

	EndIf
	
	If Thisform.Filtros_Adicionales.Visible = .T.
		Thisform.Filtros_Adicionales.Left 	= 0
		Thisform.Filtros_Adicionales.Width 	= Thisform.Width
		Thisform.Filtros_Adicionales.AutoSize()

		lnHeight = Thisform.Filtros_Adicionales.Top + Thisform.Filtros_Adicionales.Height

	Else
		lnHeight = Thisform.Filtros_Adicionales.Top

	EndIf
	
	lnHeight = This.HoockAutosize( lnHeight )

	Thisform.Acciones.Top 	= lnHeight
	Thisform.Acciones.Left 	= 0
	Thisform.Acciones.Width = Thisform.Width
	Thisform.Acciones.AutoSize()

	Thisform.Height = Thisform.Acciones.Top + Thisform.Acciones.Height

	If Thisform.Height > _Screen.Height - ( Thisform.nGap * 4 )
		_Screen.Height = Thisform.Height + ( Thisform.nGap * 4 )
		llAutocenter = .T.
	Endif

	If Thisform.Width > _Screen.Width - ( Thisform.nGap * 4 )
		_Screen.Width = Thisform.Width + ( Thisform.nGap * 4 )
		llAutocenter = .T.
	Endif

	If llAutocenter
		_Screen.AutoCenter = .T.
	Endif

	Thisform.AutoCenter = .T.


Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	Thisform.Titulo.Anchor 		= 11
	Thisform.Acciones.Anchor 	= 14
	
	Thisform.LockScreen = .F.
	Thisform.Visible 	= .T.


Endtry

ENDPROC
PROCEDURE ejecutar
Local lcCommand As String,;
	lcLookUpCommand as String
Local loParametros As Object,;
	loBiz As oMovimiento Of "FrontEnd\Prg\Movimiento.prg",;
	loFiltros As Collection,;
	loColValues As Collection,;
	loFiltro As Object,;
	loItem As Filtro OF v:\cloudfox\frontend\vcx\informes.vcx,;
	loCbo As ComboBox

Local lnLen As Integer,;
	i As Integer

Try

	lcCommand = ""
	loParametros = Createobject( "Empty" )
	loFiltros = Createobject( "Collection" )

	*For Each loItem In Thisform.oColFiltros
	For Each loItem In Thisform.Filtros.oColFiltros

		If loItem.Visible
		
			loItem.ActualizarDatos()

			If loItem.chkActivo.Value = .T.
			
				loFiltro = Createobject( "Empty" )
				loColValues = Createobject( "Collection" )
				
				If loItem.chkCaseSensitive.Visible
					AddProperty( loFiltro, "lCaseSensitive", loItem.chkCaseSensitive.Value )

				Else
					AddProperty( loFiltro, "lCaseSensitive", .T. )

				Endif

				loCbo = loItem.cboFieldLookups

				*********************************************
				If loFiltro.lCaseSensitive
					lcLookUpCommand = loCbo.List( loCbo.ListIndex, 2 )

				Else
					lcLookUpCommand = loCbo.List( loCbo.ListIndex, 3 )

				Endif

				loItem.cLookUpCommand  = lcLookUpCommand

				*******************************************

				AddProperty( loFiltro, "cLookUpCommand", loItem.cLookUpCommand )

				*!*				For i = 1 to loFiltro.lst_Filtro.ListCount
				*!*					If loFiltro.lst_Filtro.Selected( i )
				*!*						loColValues.Add( loFiltro.lst_Filtro.Value )
				*!*					Endif
				*!*				EndFor

				loItem.oColValues = loColValues

				AddProperty( loFiltro, "oColValues", loItem.oColValues )
				AddProperty( loFiltro, "uValue", loItem.uValue )
				AddProperty( loFiltro, "uValueHasta", loItem.uValueHasta )

				AddProperty( loFiltro, "cDataType", loItem.cDataType )
				AddProperty( loFiltro, "cFieldName", loItem.cFieldName )
				AddProperty( loFiltro, "cFilterControl", loItem.cFilterControl )

				loFiltros.Add( loFiltro )

			EndIf
		EndIf

	EndFor

	AddProperty( loParametros, "oInforme", Thisform.oInforme )
	AddProperty( loParametros, "oFiltros", loFiltros )
	*AddProperty( loParametros, "oFiltrosAdicionales", Thisform.oColFiltrosAdicionales )
	AddProperty( loParametros, "oFiltrosAdicionales", Thisform.Filtros_Adicionales.oColFiltros )
	AddProperty( loParametros, "cSalida", ThisForm.Acciones.cboExportar.Value )
	AddProperty( loParametros, "cTitulo", ThisForm.Tipo.cboInforme.DisplayValue )
	
	loParametros = Thisform.HoockEjecutar( loParametros )

	loBiz = Thisform.oBiz
	loBiz.EjecutarConsulta( loParametros )

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loParametros = Null
	loBiz = Null
	loFiltro = Null
	loFiltros = Null
	loItem = Null


Endtry

ENDPROC
PROCEDURE hoockautosize
Lparameters nHeight as Integer
Local lcCommand as String

Try

	lcCommand = ""

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

Return nHeight

ENDPROC
PROCEDURE hoockejecutar
Lparameters oParametros
Local lcCommand as String

Try

	lcCommand = ""

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

Return oParametros

ENDPROC
PROCEDURE initializecontrols
* RA 23/09/2021(09:37:53)
* No es necesario poner código en este metodo.
* Todos los controles de la clas _Controles_Base se bindean a
* éste metodo para inicializarse.

* Si se pone código, tener en cuenta que los controles se inicializan
* despues de ejecutarse el código de éste metodo.
ENDPROC
PROCEDURE ocolfiltros_access
If Isnull( This.oColFiltros )
	This.oColFiltros = NewObject( "oColBase", 'Tools\DataDictionary\prg\oColBase.prg' )
Endif

Return This.oColFiltros

ENDPROC
PROCEDURE ocolfiltrosadicionales_access
If Isnull( This.oColFiltrosAdicionales )
	This.oColFiltrosAdicionales = NewObject( "oColBase", 'Tools\DataDictionary\prg\oColBase.prg' )
Endif

Return This.oColFiltrosAdicionales

ENDPROC
PROCEDURE oinforme_access
Local lcCommand as String
Local loInforme as Object

Try

	lcCommand = ""
	loInforme = CreateObject( "Empty" )
	AddProperty( loInforme, "cEndPoint",  ThisForm.Tipo.cboInforme.Value )
	AddProperty( loInforme, "cTitulo",  ThisForm.Tipo.cboInforme.DisplayValue )
	AddProperty( loInforme, "nId",  ThisForm.Tipo.cboInforme.List( ThisForm.Tipo.cboInforme.ListIndex, 3 ))
	
	Thisform.oInforme = loInforme

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loInforme = Null


EndTry

return This.oInforme

ENDPROC
PROCEDURE sincronizarcontroles
#INCLUDE "FW\Comunes\Include\Praxis.h"

Local lcCommand As String,;
	lcTitulo As String
Local loBiz As oMovimiento Of "FrontEnd\Prg\Movimiento.prg",;
	loFiltro As Filtro of "FrontEnd\Vcx\Informes.vcx"
Local i As Integer

Try

	lcCommand = ""
	loBiz = Thisform.oBiz


	Thisform.cTituloDelPrograma = loBiz.cTituloDelInforme


	For Each loFiltro In Thisform.oColFiltros
		Try

			loFiltro.CargarCombos()

		Catch To oErr

		Finally

		Endtry

	Endfor


Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loBiz = Null
	loFiltro = Null


Endtry

ENDPROC
PROCEDURE tipoinformeinteractivechange
Lparameters oCboInforme as ComboBox
Local lcCommand as String

Try

	lcCommand = ""
	Thisform.Autosize()

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
6[END RESERVED2]
[START RESERVED3]
clave
oparametros
ncalculatedheight
ngap
ctitulodelprograma
ocolfiltros
oinforme Información del Informe a Ejecutar
ocolfiltrosadicionales Colección de Filtros Adicionales
*ejecutar 
*autosize Specifies if a control is automatically resized to fit its contents.
*sincronizarcontroles 
*hookafterinit 
*ocolfiltros_access 
*oinforme_access 
*tipoinformeinteractivechange Es llamado por el combo de tipo de informe, a fin de poder sincronizar los filtros que se muestran en función del tipo de Informe
*ocolfiltrosadicionales_access 
*hoockautosize 
*hoockejecutar 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6870ZECLN
[CLASS] crud_titulo
[CLASSLOC] crud.vcx
[BASECLASS] container
[OBJNAME] Titulo
[PARENT] informes
[START PROPERTIES]
Top = 0
Left = 0
TabIndex = 6
Name = "Titulo"
lblFecha.Name = "lblFecha"
lblTitulo.Name = "lblTitulo"
lblObservaciones.Name = "lblObservaciones"
lblAsteriscos.Name = "lblAsteriscos"
[END PROPERTIES]
[START METHODS]
PROCEDURE sincronizarcontroles
#INCLUDE "FW\Comunes\Include\Praxis.h"

If IsNull( Thisform.oRegistro )
	Thisform.oRegistro = CreateObject( "Empty" )
	AddProperty( Thisform.oRegistro, "ABM", ABM_CONSULTA )
EndIf

DoDefault()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68710VHRJ
[CLASS] acciones
[CLASSLOC] informes.vcx
[BASECLASS] container
[OBJNAME] Acciones
[PARENT] informes
[START PROPERTIES]
Top = 281
Left = 0
TabIndex = 2
Name = "Acciones"
cmdEjecutar.Name = "cmdEjecutar"
cmdCancelar.Name = "cmdCancelar"
lblExportar.Name = "lblExportar"
CBOEXPORTAR.Name = "CBOEXPORTAR"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68B0OW0Z7
[CLASS] tipo
[CLASSLOC] informes.vcx
[BASECLASS] container
[OBJNAME] Tipo
[PARENT] informes
[START PROPERTIES]
Top = 36
Left = 24
TabIndex = 1
Name = "Tipo"
lblInformes.Name = "lblInformes"
CBOINFORME.Name = "CBOINFORME"
[END PROPERTIES]
[START METHODS]
PROCEDURE CBOINFORME.InteractiveChange
Thisform.TipoInformeInteractiveChange( This )

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69R0NKTVJ
[CLASS] filtros_adicionales
[CLASSLOC] informes.vcx
[BASECLASS] container
[OBJNAME] Filtros_Adicionales
[PARENT] informes
[START PROPERTIES]
Top = 180
Left = 0
Name = "Filtros_Adicionales"
Shape.Name = "Shape"
lblFiltro.Name = "lblFiltro"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6FG0NSJA6
[CLASS] filtros
[CLASSLOC] informes.vcx
[BASECLASS] container
[OBJNAME] Filtros
[PARENT] informes
[START PROPERTIES]
Top = 72
Left = 0
Name = "Filtros"
Shape.Name = "Shape"
lblFiltro.Name = "lblFiltro"
imgAgregar.Name = "imgAgregar"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] informes
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
[END PROPERTIES]
[START RESERVED1]
 ! ..\..\fw\comunes\include\praxis.hFWs~\V! ..\..\fw\comunes\include\foxpro.hNXÊrûF" ..\..\fw\comunes\include\strings.hVYZŠOJ' ..\..\tools\namespaces\include\system.h^Z±ÙF[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6870ZGCCA
[CLASS] container
[BASECLASS] container
[OBJNAME] filtro
[START PROPERTIES]
Width = 673
Height = 24
BackStyle = 0
Visible = .T.
lessistema = .T.
_memberdata =     1161<VFPData><memberdata name="lessistema" display="lEsSistema"/><memberdata name="lessistema_assign" display="lEsSistema_Assign"/><memberdata name="obiz" display="oBiz"/><memberdata name="obiz_access" display="oBiz_Access"/><memberdata name="initialize" display="Initialize"/><memberdata name="cargarcombos" display="CargarCombos"/><memberdata name="cfieldname" display="cFieldName"/><memberdata name="clookupcommand" display="cLookUpCommand"/><memberdata name="uvalue" display="uValue"/><memberdata name="uvaluehasta" display="uValueHasta"/><memberdata name="ocolvalues" display="oColValues"/><memberdata name="cdatatype" display="cDataType"/><memberdata name="cfiltercontrol" display="cFilterControl"/><memberdata name="ocultarcontroles" display="OcultarControles"/><memberdata name="mostrarcontroles" display="MostrarControles"/><memberdata name="actualizardatos" display="ActualizarDatos"/><memberdata name="visible" display="Visible"/><memberdata name="visible_assign" display="Visible_Assign"/><memberdata name="ofield" display="oField"/><memberdata name="ofield_access" display="oField_Access"/><memberdata name="cinputmask" display="cInputMask"/></VFPData>
obiz = .NULL.
cfieldname = 
clookupcommand = 
uvalue = .NULL.
uvaluehasta = .NULL.
ocolvalues = .NULL.
cdatatype = 
cfiltercontrol = txt
ofield = .NULL.
cinputmask = 
Name = "filtro"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Local lcCommand As String

Try

	lcCommand = ""


	This.BorderWidth = 0
	
*!*		If PemStatus( This.Parent, "oColFiltros", 5 )
*!*			*Thisform.oColFiltros.AddItem( This, This.Name )
*!*			This.Parent.oColFiltros.AddItem( This, This.Name )
*!*		EndIf

	If Pemstatus( Thisform, 'InitializeControls', 5 )
		Bindevent( Thisform, 'InitializeControls', This, 'Initialize', 0 )
	EndIf
	
	This.lEsSistema = This.lEsSistema
	*This.CboFields.InteractiveChange()
	

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE actualizardatos
Local lcCommand As String

Try

	lcCommand = ""

	This.cDataType		= This.CboFields.List( This.CboFields.ListIndex, 3 )
	This.cFieldName 	= This.CboFields.List( This.CboFields.ListIndex, 7 )
	This.cInputMask 	= This.CboFields.List( This.CboFields.ListIndex, 8 )
	
	If This.chkCaseSensitive.Value Or !This.chkCaseSensitive.Visible
		This.cLookUpCommand = This.cboFieldLookups.List( This.cboFieldLookups.ListIndex, 2 )

	Else
		This.cLookUpCommand = This.cboFieldLookups.List( This.cboFieldLookups.ListIndex, 3 )

	Endif

	This.MostrarControles( This.cFilterControl, This.cLookUpCommand )
	If Inlist( This.cFilterControl, "txt" )
		If This.txt_Desde.cCueText == This.txt_Desde.Value
			This.chkActivo.Value = .F.
		EndIf
	Endif

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE cargarcombos
Local lcCommand as String

Try

	lcCommand = ""
	This.CboFields.CargarCombo()
	This.CboFields.InteractiveChange()
	*This.cboFieldLookups.InteractiveChange()
	
Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE initialize
Local lcCommand as String

Try

	lcCommand = ""

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE lessistema_assign
lparameters tlEsSistema
This.lEsSistema = tlEsSistema

This.imgEliminar.Visible = !This.lEsSistema
This.CboFields.Enabled = !This.lEsSistema


ENDPROC
PROCEDURE mostrarcontroles
Lparameters cControl As String, cLookUpCommand As String
Local lcCommand As String
Local llRango As Boolean
Try

	lcCommand = ""

	If .T. && Empty( This.uValue )
		llRango = ( cLookUpCommand = "range" )

		Do Case
			Case cLookUpCommand == "in" Or cControl = "lst"
				This.lst_Filtro.Visible 	= .T.
				This.lst_Filtro.Top			= -0
				This.lst_Filtro.Width 		= 252
				
				If Empty( This.uValue )

				If llRango
					This.lst_Filtro.ToolTipText = "Seleccione los Items a filtrar"

				Else
					This.lst_Filtro.ToolTipText = "Seleccione el Item a filtrar"

				EndIf


				This.lst_Filtro.CargarListBox()
				*This.lst_Filtro.Left

				This.uValue 		= Null
				This.uValueHasta 	= Null
				EndIf

			Case cControl = "txt"
				This.txt_Desde.Visible 		= .T.
				This.txt_Desde.Top			= 0
				This.txt_Desde.Width 		= 252
				This.txt_Desde.InputMask 	= This.cInputMask
				*This.txt_Desde.Left

				If llRango
					This.txt_Hasta.Visible 		= .T.
					This.txt_Hasta.Top			= 0
					This.txt_Hasta.Width 		= 120
					This.Txt_Hasta.InputMask 	= This.cInputMask
					This.txt_Hasta.cCueText = "Ingrese el texto Final a buscar"
					*This.txt_Hasta.Left

					This.txt_Desde.Width 		= 120
					This.txt_Desde.cCueText = "Ingrese el texto Inicial a buscar"

				Else
					This.txt_Desde.cCueText = "Ingrese el texto a buscar"

				EndIf

				This.uValue 		= This.txt_Desde.Value
				This.uValueHasta 	= This.Txt_Hasta.Value

			Case cControl = "fecha"
				This.Fecha_Desde.Visible 	= .T.
				This.Fecha_Desde.Top		= 0

				*This.Fecha_Desde.Left

				If llRango
					This.Fecha_Hasta.Visible 	= .T.
					This.Fecha_Hasta.Top		= 0
					This.Fecha_Hasta.ToolTipText = "Seleccione la Fecha Final"
					*This.Fecha_Hasta.Left
					This.Fecha_Desde.ToolTipText = "Seleccione la Fecha Inicial"

				Else
					This.Fecha_Desde.ToolTipText = "Seleccione la Fecha"

				EndIf
				
				If Empty( This.uValue )

				This.uValue 		= This.Fecha_Desde.Value
				This.uValueHasta 	= This.Fecha_Hasta.Value
				EndIf


			Case cControl = "spn"
				This.spn_Desde.Visible 		= .T.
				This.spn_Desde.Top			= 0
				This.spn_Desde.Width 		= 252
				*This.spn_Desde.Left

				If llRango
					This.Spn_Hasta.Visible 	= .T.
					This.Spn_Hasta.Top		= 0
					This.Spn_Hasta.Width 	= 120
					*This.Spn_Hasta.Left
					This.Spn_Hasta.ToolTipText = "Ingrese el Valor Final"

					This.spn_Desde.Width 	= 120
					This.spn_Desde.ToolTipText = "Ingrese el Valor Inicial"

				Else
					This.spn_Desde.ToolTipText = "Ingrese el Valor"

				EndIf

				If Empty( This.uValue )
				This.uValue 		= This.spn_Desde.Value
				This.uValueHasta 	= This.spn_Hasta.Value
				EndIf

			Case cControl = "cbo"
				This.Cbo_Desde.Visible 		= .T.
				This.Cbo_Desde.Top			= 0
				This.Cbo_Desde.Width 		= 252
				*This.Cbo_Hasta.Left

				If llRango
					This.Cbo_Hasta.Visible 	= .T.
					This.Cbo_Hasta.Top		= 0
					This.Cbo_Hasta.Width 	= 120
					*This.chk_Filtro.Left

					This.Cbo_Hasta.ToolTipText = "Seleccione el Item Final"
					This.Cbo_Desde.ToolTipText = "Seleccione el Item Inicial"

					This.Cbo_Desde.Width 	= 120
					
					If Empty( This.uValue )

					This.cbo_Desde.CargarCombo()
					This.cbo_Hasta.CargarCombo()
					EndIf

				Else
					This.Cbo_Desde.ToolTipText = "Seleccione el Item"
					
					If Empty( This.uValue )
					This.cbo_Desde.CargarCombo()
					EndIf

				EndIf
				
				If Empty( This.uValue )

				This.uValue 		= This.cbo_Desde.Value
				This.uValueHasta 	= This.cbo_Hasta.Value
				EndIf

			Case cControl = "chk"
				This.Chk_Filtro.Visible 		= .T.
				This.Chk_Filtro.Top			= 0
				This.Chk_Filtro.Width 		= 252
				This.Chk_Filtro.ToolTipText = "Seleccione el Estado"
				*This.Cbo_Hasta.Left

				If Empty( This.uValue )
				This.uValue 		= This.Chk_Desde.Value
				This.uValueHasta 	= Null
				EndIf

			Otherwise

		EndCase
	EndIf

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE obiz_access
If Isnull( This.oBiz )
	If Pemstatus( This.Parent, "oBiz", 5 )
		This.oBiz = This.Parent.oBiz

	Else
		This.oBiz = Thisform.oBiz

	Endif

EndIf

Return This.oBiz

ENDPROC
PROCEDURE ocultarcontroles
Local lcCommand as String

Try

	lcCommand = ""
	This.txt_Desde.Visible 		= .F.
	This.txt_Desde.Top			= -100
	*This.txt_Desde.Left
	
	This.txt_Hasta.Visible 		= .F.
	This.txt_Hasta.Top			= -100
	*This.txt_Hasta.Left
	
	This.Fecha_Desde.Visible 	= .F.
	This.Fecha_Desde.Top		= -100
	*This.Fecha_Desde.Left
	
	This.Fecha_Hasta.Visible 	= .F.
	This.Fecha_Hasta.Top		= -100
	*This.Fecha_Hasta.Left
	
	This.spn_Desde.Visible 		= .F.
	This.spn_Desde.Top			= -100
	*This.spn_Desde.Left
	
	This.Spn_Hasta.Visible 		= .F.
	This.Spn_Hasta.Top			= -100
	*This.Spn_Hasta.Left
	
	This.lst_Filtro.Visible 	= .F.
	This.lst_Filtro.Top			= -100
	*This.lst_Filtro.Left
	
	This.cbo_Desde.Visible 		= .F.
	This.cbo_Desde.Top			= -100
	*This.cbo_Desde.Left
	
	This.Cbo_Hasta.Visible 		= .F.
	This.Cbo_Hasta.Top			= -100
	*This.Cbo_Hasta.Left
	
	This.chk_Filtro.Visible 	= .F.
	This.chk_Filtro.Top			= -100
	*This.chk_Filtro.Left
	
Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE ofield_access
return This.oField

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
16[END RESERVED2]
[START RESERVED3]
lessistema Si el filtro es de Sistema, no puede eliminarse ni cambiarse los campos. Sólo se puede desactivar y elegir los tipos de filtros a realizar.
_memberdata XML Metadata for customizable properties
obiz
cfieldname Nombre del Campo a Filtrar
clookupcommand Comando de comparación
uvalue Valor a comparar
uvaluehasta Valor hasta en filtro tipo RANGO
ocolvalues Coleccion de Valores en un caso VARIOS
cdatatype Tipo de Datos a comprara
cfiltercontrol Tipo de control a usarse en el filtro
ofield
cinputmask
*lessistema_assign 
*obiz_access 
*initialize 
*cargarcombos 
*ocultarcontroles 
*mostrarcontroles 
*actualizardatos Actualiza las propiedades en función de los campos y valores seleccionados para asegurar que se envíen valores correctos
*ofield_access 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68710IFSE
[CLASS] checkbox
[BASECLASS] checkbox
[OBJNAME] chkActivo
[PARENT] filtro
[START PROPERTIES]
Top = 0
Left = 0
Height = 17
Width = 18
AutoSize = .T.
Alignment = 0
BackStyle = 0
Caption = ""
Value = .T.
TabIndex = 14
ToolTipText = "Desactivar / Activar el Filtro"
Name = "chkActivo"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local lcCommand As String

Try

    lcCommand = ""

    This.Parent.SetAll( "Enabled", This.Value )
    This.Parent.imgEliminar.Visible = ( This.Value And !This.Parent.lEsSistema )
    If This.Parent.lEsSistema
        This.Parent.CboFields.Enabled = .F.
    Endif

    If This.Value
        This.Parent.MostrarControles( This.Parent.cFilterControl,;
            This.Parent.cLookUpCommand )

        This.Parent.cboFieldLookups.Visible = .T.

    Else
        This.Parent.OcultarControles()
        This.Parent.cboFieldLookups.Visible = .F.

    Endif


    This.Enabled = .T.

Catch To loErr
    Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
    loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
    loError.cRemark = lcCommand
    loError.Process ( m.loErr )
    Throw loError

Finally


Endtry

ENDPROC
PROCEDURE ProgrammaticChange
This.InteractiveChange()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6870ZR4P5
[CLASS] image
[BASECLASS] image
[OBJNAME] imgEliminar
[PARENT] filtro
[START PROPERTIES]
Picture = ..\..\fw\comunes\image\ico\trash-red-10-multi-size.ico
Stretch = 1
Height = 24
Left = 648
MousePointer = 15
Top = 0
Width = 32
ToolTipText = "Eliminar el Filtro"
Name = "imgEliminar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Local lcCommand As String

Try

    lcCommand = ""
    This.Parent.Parent.EliminarFiltro( This.Parent )

Catch To loErr
    Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
    loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
    loError.cRemark = lcCommand
    loError.Process ( m.loErr )
    Throw loError

Finally


Endtry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68B0T210Q
[CLASS] checkbox
[BASECLASS] checkbox
[OBJNAME] chkCaseSensitive
[PARENT] filtro
[START PROPERTIES]
Top = 0
Left = 576
Height = 17
Width = 68
AutoSize = .T.
Alignment = 0
BackStyle = 0
Caption = "Sensitivo"
Value = .F.
TabIndex = 13
ToolTipText = "Distingue entre MAYÚSCULAS y minúsculas"
Name = "chkCaseSensitive"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68C0S9LIK
[CLASS] cbofields
[CLASSLOC] informes.vcx
[BASECLASS] combobox
[OBJNAME] CboFields
[PARENT] filtro
[START PROPERTIES]
Left = 60
TabIndex = 1
Top = 0
Name = "CboFields"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local lcCommand As String,;
	lcExclude As String,;
	lcInclude As String

Local lcDataType As Character

Try

	lcCommand = ""

	If !Empty( This.Value )

		lcDataType	= This.List( This.ListIndex, 3 )
		lcExclude	= This.List( This.ListIndex, 5 )
		lcInclude	= This.List( This.ListIndex, 6 )

		This.Parent.cboFieldLookups.CargarCombo( lcDataType, lcExclude, lcInclude )

		If Inlist( lcDataType, "C", "V", "M" )
			This.Parent.chkCaseSensitive.Visible = .T.

		Else
			This.Parent.chkCaseSensitive.Visible = .F.

		Endif

		This.Parent.cDataType 		= lcDataType
		This.Parent.cFieldName 		= This.List( This.ListIndex, 7 )
		This.Parent.cFilterControl 	= This.List( This.ListIndex, 4 )
		This.Parent.cInputMask 		= This.List( This.ListIndex, 8 )

		This.Parent.cboFieldLookups.InteractiveChange()

	Endif

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68C0TBQUX
[CLASS] cbofieldlookups
[CLASSLOC] informes.vcx
[BASECLASS] combobox
[OBJNAME] cboFieldLookups
[PARENT] filtro
[START PROPERTIES]
Left = 192
TabIndex = 2
Top = 0
Width = 108
Name = "cboFieldLookups"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local lcCommand As String,;
	lcLookUpCommand As String

Try

	lcCommand = ""

	If !Empty( This.Value )
	
		If This.Parent.chkCaseSensitive.Value
			lcLookUpCommand = This.List( This.ListIndex, 2 )

		Else
			lcLookUpCommand = This.List( This.ListIndex, 3 )

		EndIf
		
		This.Parent.cLookUpCommand = lcLookUpCommand
		
		Text To lcMsg NoShow TextMerge Pretext 03
		cFieldName 		= '<<This.Parent.cFieldName>>'
		cDataType 		= '<<This.Parent.cDataType>>'
		cLookUpCommand 	= '<<lcLookUpCommand>>'
		cFilterControl 	= '<<This.Parent.cFilterControl>>'
		EndText
		
		*Inform( lcMsg )
		
		This.Parent.uValue = ""
		This.Parent.OcultarControles()
		This.Parent.MostrarControles( This.Parent.cFilterControl, lcLookUpCommand )
		
	Endif


Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0NF8HQ
[CLASS] datefiltro
[CLASSLOC] informes.vcx
[BASECLASS] container
[OBJNAME] Fecha_Desde
[PARENT] filtro
[START PROPERTIES]
Top = 48
Left = 312
TabIndex = 5
Name = "Fecha_Desde"
KEYDATE.Name = "KEYDATE"
CMDKEYDATE.Name = "CMDKEYDATE"
[END PROPERTIES]
[START METHODS]
PROCEDURE KEYDATE.InteractiveChange
DoDefault()
This.Parent.Parent.uValue = This.Value

ENDPROC
PROCEDURE initialize
Local lcCommand As String
Local loBiz As oMovimiento Of "FrontEnd\Prg\Movimiento.prg"

Try

	lcCommand = ""
	loBiz = This.oBiz
	This.Value = loBiz.dFechaInicial

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loBiz = Null

Endtry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0NF8I7
[CLASS] datefiltro
[CLASSLOC] informes.vcx
[BASECLASS] container
[OBJNAME] Fecha_Hasta
[PARENT] filtro
[START PROPERTIES]
Top = 48
Left = 444
TabIndex = 6
Name = "Fecha_Hasta"
KEYDATE.Name = "KEYDATE"
CMDKEYDATE.Name = "CMDKEYDATE"
[END PROPERTIES]
[START METHODS]
PROCEDURE KEYDATE.InteractiveChange
DoDefault()
This.Parent.Parent.uValueHasta = This.Value

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0NF8IN
[CLASS] txtfiltro
[CLASSLOC] informes.vcx
[BASECLASS] textbox
[OBJNAME] txt_Desde
[PARENT] filtro
[START PROPERTIES]
Left = 312
TabIndex = 3
Top = 0
Name = "txt_Desde"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
DoDefault()
This.Parent.uValue = This.Value

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0NF8IP
[CLASS] txtfiltro
[CLASSLOC] informes.vcx
[BASECLASS] textbox
[OBJNAME] txt_Hasta
[PARENT] filtro
[START PROPERTIES]
Left = 444
TabIndex = 4
Top = 0
Name = "txt_Hasta"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
DoDefault()
This.Parent.uValueHasta = This.Value

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0NZCYP
[CLASS] spnfiltro
[CLASSLOC] informes.vcx
[BASECLASS] spinner
[OBJNAME] spn_Desde
[PARENT] filtro
[START PROPERTIES]
Left = 312
TabIndex = 9
Top = 96
Name = "spn_Desde"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
This.Parent.uValue = This.Value

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0NZCYQ
[CLASS] spnfiltro
[CLASSLOC] informes.vcx
[BASECLASS] spinner
[OBJNAME] spn_Hasta
[PARENT] filtro
[START PROPERTIES]
Left = 444
TabIndex = 10
Top = 96
Name = "spn_Hasta"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
This.Parent.uValueHasta = This.Value

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0NZCYU
[CLASS] chkfiltro
[CLASSLOC] informes.vcx
[BASECLASS] checkbox
[OBJNAME] chk_Filtro
[PARENT] filtro
[START PROPERTIES]
Top = 120
Left = 312
Alignment = 0
TabIndex = 12
Name = "chk_Filtro"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
DoDefault()
This.Parent.uValue = This.Value
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0NZCYV
[CLASS] cbofiltro
[CLASSLOC] informes.vcx
[BASECLASS] combobox
[OBJNAME] cbo_Desde
[PARENT] filtro
[START PROPERTIES]
Left = 312
TabIndex = 7
Top = 72
Visible = .F.
Name = "cbo_Desde"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local lcCommand as String
Local loChild as _combobox OF v:\cloudfox\fw\comunes\vcx\_controles_base.vcx

Try

	lcCommand = ""
	This.Parent.uValue = This.Value
*!*		If !IsNull( This.oChildren )
*!*			For Each loChild in This.oChildren
*!*		 		loChild.CargarCombo()
*!*			EndFor
*!*		EndIf

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loChild = Null


EndTry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0NZCYZ
[CLASS] cbofiltro
[CLASSLOC] informes.vcx
[BASECLASS] combobox
[OBJNAME] cbo_Hasta
[PARENT] filtro
[START PROPERTIES]
Left = 444
TabIndex = 8
Top = 72
Visible = .F.
Name = "cbo_Hasta"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
This.Parent.uValueHasta = This.Value
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68G169LWX
[CLASS] lstfiltro
[CLASSLOC] informes.vcx
[BASECLASS] listbox
[OBJNAME] lst_Filtro
[PARENT] filtro
[START PROPERTIES]
Left = 312
Top = 144
Visible = .T.
Name = "lst_Filtro"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] filtro
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68710IFSE
[CLASS] container
[BASECLASS] container
[OBJNAME] acciones
[START PROPERTIES]
Width = 720
Height = 48
BackStyle = 0
_memberdata = <VFPData><memberdata name="autosize" display="Autosize"/><memberdata name="sincronizarbotones" display="SincronizarBotones"/></VFPData>
Name = "acciones"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Local lcCommand as String

Try

	lcCommand = ""
	This.BorderWidth = 0
	
Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry


ENDPROC
PROCEDURE sincronizarbotones
Local lcCommand as String

Try

	lcCommand = ""

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
5[END RESERVED2]
[START RESERVED3]
_memberdata XML Metadata for customizable properties
*autosize Specifies if a control is automatically resized to fit its contents.
*sincronizarbotones 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _687118BAZ
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdEjecutar
[PARENT] acciones
[START PROPERTIES]
AutoSize = .T.
Top = 0
Left = 588
Height = 36
Width = 89
FontBold = .T.
FontSize = 12
Anchor = 8
Caption = "Ejecutar"
MousePointer = 15
TabIndex = 1
ToolTipText = "Ejecutar la Consulta"
SpecialEffect = 2
PicturePosition = 1
ForeColor = 0,128,64
Name = "cmdEjecutar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Ejecutar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0N504T
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdCancelar
[PARENT] acciones
[START PROPERTIES]
Top = 0
Left = 12
Height = 36
Width = 120
FontBold = .T.
FontSize = 12
Anchor = 6
Picture = ..\..\fw\comunes\image\bmp\close.bmp
Caption = "Cancelar"
MousePointer = 15
TabIndex = 2
SpecialEffect = 2
PicturePosition = 1
ForeColor = 0,64,128
Name = "cmdCancelar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Cancelar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68711BVB5
[CLASS] label
[BASECLASS] label
[OBJNAME] lblExportar
[PARENT] acciones
[START PROPERTIES]
AutoSize = .T.
FontBold = .T.
FontSize = 12
Anchor = 8
BackStyle = 0
Caption = "Salida"
Height = 22
Left = 358
Top = 7
Width = 49
ForeColor = 0,64,128
Name = "lblExportar"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69U0P8ILX
[CLASS] cboexportar
[CLASSLOC] informes.vcx
[BASECLASS] combobox
[OBJNAME] CboExportar
[PARENT] acciones
[START PROPERTIES]
Anchor = 8
Left = 420
Top = 6
Name = "CboExportar"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] acciones
[START PROPERTIES]
Arial, 1, 12, 8, 20, 15, 42, 4, 1
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68C0R0HLG
[CLASS] _combobox
[CLASSLOC] ..\..\fw\comunes\vcx\_controles_base.vcx
[BASECLASS] combobox
[OBJNAME] cbofiltro
[START PROPERTIES]
Width = 120
ocolitems = .NULL.
ndefault = 1
lautomaticdisplay = .F.
_memberdata =      439<VFPData><memberdata name="lautomaticdisplay" display="lAutomaticDisplay"/><memberdata name="cmodelo" display="cModelo"/><memberdata name="ctable" display="cTable"/><memberdata name="ocolitems" display="oColItems"/><memberdata name="ocolitems_access" display="oColItems_Access"/><memberdata name="ndefault" display="nDefault"/><memberdata name="ofield" display="oField"/><memberdata name="ofield_access" display="oField_Access"/></VFPData>
cclassname = 
cclasslibrary = 
cmodelo = 
ctable = 
ofield = .NULL.
Name = "cbofiltro"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Local lcCommand As String

Try

	lcCommand = ""
	This.BoundColumn 	= 2
	This.BoundTo 		= .T.
	This.ColumnCount 	= 1
	This.RowSourceType 	= 0
	This.RowSource 		= ""
	This.Style			= 2
	
	This.oFiltros = Newobject( "CollectionBase", "Tools\Namespaces\Prg\CollectionBase.Prg" )

	If Pemstatus( This.Parent, 'Initialize', 5 )
		Bindevent( This.Parent, 'Initialize', This, 'Initialize', 1 )
	Endif

*!*		If Pemstatus( Thisform, 'InitializeControls', 5 )
*!*			Bindevent( Thisform, 'InitializeControls', This, 'Initialize', 1 )
*!*		Endif

*!*		If Pemstatus( Thisform, 'AfterBindControls', 5 )
*!*			Bindevent( Thisform, 'AfterBindControls', This, 'AfterBindControls', 1 )
*!*		Endif

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = _NewObject ( 'ErrorHandler', 'ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE afterbindcontrols
Local lcCommand As String

Try

	lcCommand = ""
	NoDefault

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE cargarcombo
Local lcCommand As String,;
	lcAlias As String,;
	lcTo_Field As String
Local loModelo As oModelo Of "FrontEnd\Prg\Modelo.prg",;
	loParent As oModelo Of "FrontEnd\Prg\Modelo.prg",;
	loParam As Object,;
	loFiltros As CollectionBase Of Tools\Namespaces\Prg\CollectionBase.Prg,;
	loField As oField Of 'Tools\DataDictionary\prg\oField.prg',;
	loChoices As Object


Try

	lcCommand = ""
	This.Clear()
	This.oField = Null
	
	loField = This.oField

	If IsEmpty( loField.oChoices )
	
		loModelo = GetEntity( loField.cFK_Modelo )
		
		If IsNull( loModelo )
			Inform(  loField.cFK_Modelo )
		EndIf

		If This.lIsChild
			loParent = This.oParent
			If IsNull( loParent )
				This.VincularAlComboPadre()
			EndIf
			loModelo.oParent.nId = This.oParent.Value
		Endif

		If Empty( loField.cFK_ToField )
			lcTo_Field = loModelo.cPKField

		Else
			lcTo_Field = loField.cFK_ToField

		Endif

		This.Filtrar()

		loFiltros = This.oFiltros

		loParam = Createobject( "Empty" )
		AddProperty( loParam, "oFilterCriteria", loFiltros )

		lcAlias = loModelo.cMainCursorName + Sys(2015)
		AddProperty( loParam, "cAlias", lcAlias )

		loModelo.GetByWhere( loParam )

		Select Alias( lcAlias )

*!*			If loField.lNull
*!*				This.AddItem( "---------" )
*!*				This.List( This.NewIndex, 2 ) = Transform( 0 )
*!*			Endif

		Locate
		Scan
			This.AddItem( Alltrim( Nombre ))
			This.List( This.NewIndex, 2 ) = Transform( Evaluate( lcTo_Field ) )
		Endscan

	Else
		For Each loChoice In loField.oChoices
			This.AddItem( Alltrim( loChoice.Descripcion ))
			This.List( This.NewIndex, 2 ) = Transform( loChoice.Valor )
		Endfor

	Endif



	*For Each loField In loColFields

*!*			This.AddItem( Alltrim( loField.cCaption ))
*!*			This.List( This.NewIndex, 2 ) = loField.Name
*!*			This.List( This.NewIndex, 3 ) = loField.cFieldType

	*EndFor
	
	This.Selected( This.nDefault ) = .T.

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loFiltro = Null
	loFiltros = Null
	loParam = Null
	loModelo = Null

	If !Empty( lcAlias )
		Use In Select( lcAlias )
	Endif


Endtry

ENDPROC
PROCEDURE initialize
Local lcCommand As String

Try

	lcCommand = ""

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally

Endtry

ENDPROC
PROCEDURE obiz_access
If Isnull( This.oBiz )
	If Pemstatus( This.Parent, "oBiz", 5 )
		This.oBiz = This.Parent.oBiz

	Else
		This.oBiz = Thisform.oBiz

	Endif

EndIf

Return This.oBiz

ENDPROC
PROCEDURE ofield_access
Local lcCommand As String
Local loColFields As oColBase Of 'Tools\DataDictionary\prg\oColBase.prg',;
	loField As oField Of 'Tools\DataDictionary\prg\oField.prg',;
	loBiz As oMovimiento Of "FrontEnd\Prg\Movimiento.prg",;
	loTable As Archivo Of "Clientes\Utiles\Prg\utRutina.prg"


Try

	lcCommand = ""
	If Isnull( This.oField )
		loBiz 	= This.oBiz
		loTable = loBiz.GetTable()
		
		If PemStatus( This.Parent, "cFieldName", 5 )
			This.oField = loTable.GetField( This.Parent.cFieldName )
		EndIf
		
		If Isnull( This.oField )
			This.oField = loTable.GetField( This.cFieldName )
		EndIf
		
	Endif

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loBiz 	= Null
	loTable = Null

Endtry

Return This.oField

ENDPROC
PROCEDURE omodelo_access
Local lcCommand as String

Try

	lcCommand = ""
	If IsNull( This.oModelo )
		If !Empty( This.cModelo )
			This.oModelo = GetEntity( This.cModelo )

		Else
			This.oModelo = This.oBiz

		Endif
		
	EndIf

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loField = Null


EndTry

return This.oModelo

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED3]
ocolitems Colección de Items a cargar en el combo
ndefault Indice del item preseleccionado
*ocolitems_access 
*ofield_access 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] cbofiltro
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68C0RVEOF
[CLASS] cbofiltro
[CLASSLOC] informes.vcx
[BASECLASS] combobox
[OBJNAME] cbofields
[START PROPERTIES]
ToolTipText = "Seleccione el Campo a Filtrar"
_memberdata =      772<VFPData><memberdata name="lautomaticdisplay" display="lAutomaticDisplay"/><memberdata name="cmodelo" display="cModelo"/><memberdata name="ctable" display="cTable"/><memberdata name="ocolitems" display="oColItems"/><memberdata name="ocolitems_access" display="oColItems_Access"/><memberdata name="ndefault" display="nDefault" favorites="True"/><memberdata name="ofield" display="oField"/><memberdata name="ofield_access" display="oField_Access"/><memberdata name="ntoprow" display="nTopRow"/><memberdata name="nrowspan" display="nRowSpan"/><memberdata name="nleftcolumn" display="nLeftColumn"/><memberdata name="nlabelspan" display="nLabelSpan"/><memberdata name="nlabelposition" display="nLabelPosition"/><memberdata name="ncolumnsspan" display="nColumnsSpan"/></VFPData>
ntoprow = 1
nrowspan = 1
nleftcolumn = 1
nlabelspan = 4
nlabelposition = 2
ncolumnsspan = 8
Name = "cbofields"
[END PROPERTIES]
[START METHODS]
PROCEDURE cargarcombo
Local lcCommand As String,;
lcFilterControl as String
Local llInlist As Boolean
Local loColFields As oColBase Of 'Tools\DataDictionary\prg\oColBase.prg',;
	loField As oField Of 'Tools\DataDictionary\prg\oField.prg',;
	loBiz As oMovimiento Of "FrontEnd\Prg\Movimiento.prg"


Try

	lcCommand = ""
	loColFields = This.oColItems
	This.Clear()

	For Each loField In loColFields

		This.AddItem( Alltrim( loField.cCaption ))
		This.List( This.NewIndex, 2 ) = loField.Name
		This.List( This.NewIndex, 3 ) = loField.cFilterDataType

		* Tipo de Control
		If Empty( loField.cFilterControl )

			Do Case
				Case loField.cFilterDataType = "C"
					lcFilterControl = "txt"

				Case loField.cFilterDataType = "I"
					lcFilterControl = "cbo"

				Case loField.cFilterDataType = "D"
					lcFilterControl = "fecha"

				Case loField.cFilterDataType = "N"
					lcFilterControl = "spn"

				Case loField.cFilterDataType = "L"
					lcFilterControl = "chk"

				Otherwise
					lcFilterControl = "txt"

			Endcase
		
		Else
			lcFilterControl = loField.cFilterControl

		EndIf
		
		This.List( This.NewIndex, 4 ) = lcFilterControl
		This.List( This.NewIndex, 5 ) = loField.cFilterLookUpExclude
		This.List( This.NewIndex, 6 ) = loField.cFilterLookUpInclude
		This.List( This.NewIndex, 7 ) = loField.cFilterFieldName
		This.List( This.NewIndex, 8 ) = loField.cInputMask
		
	Endfor

	This.Selected( This.nDefault ) = .T.

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loField = Null
	loColFields = Null


Endtry

ENDPROC
PROCEDURE ocolitems_access
Local lcCommand as String

Try

	lcCommand = ""
	
	If IsNull( This.oColItems )
		This.oColItems = This.oBiz.oCamposAFiltrar
	EndIf

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

return This.oColItems

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] cbofields
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68C0SNUQY
[CLASS] cbofiltro
[CLASSLOC] informes.vcx
[BASECLASS] combobox
[OBJNAME] cbofieldlookups
[START PROPERTIES]
ToolTipText = "Seleccione el tipo Filtro"
nlabelposition = 2
_memberdata = <VFPData><memberdata name="nlabelposition" display="nLabelPosition"/></VFPData>
Name = "cbofieldlookups"
[END PROPERTIES]
[START METHODS]
PROCEDURE cargarcombo
Lparameters cFieldType As String,;
    cExclude As String,;
    cInclude As String

Local lcCommand As String,;
    lcExact As String,;
    lcLookUpCommand as String

Local llInlist As Boolean,;
    llOk As Boolean
Local loColFields As oColBase Of 'Tools\DataDictionary\prg\oColBase.prg',;
    loField As Object


Try

    lcCommand = ""
    lcExact = Set("Exact")
    Set Exact On

    loColFields = This.oColItems
    This.Clear()

    For Each loField In loColFields

        TEXT To lcCommand NoShow TextMerge Pretext 15
		llInlist = InList( cFieldType, <<loField.FieldTypeList>> )
        ENDTEXT

        &lcCommand
        lcCommand = ""

        If llInlist
            If Empty( cExclude )
                llOk = .T.

            Else
                TEXT To lcCommand NoShow TextMerge Pretext 15
				llOk = !InList( '<<loField.Command>>', <<cExclude>> )
                ENDTEXT

                &lcCommand
                lcCommand = ""

            Endif

            If llOk
                If Empty( cInclude )
                    llOk = .T.

                Else
                    TEXT To lcCommand NoShow TextMerge Pretext 15
					llOk = InList( '<<loField.Command>>', <<cInclude>> )
                    ENDTEXT

                    &lcCommand
                    lcCommand = ""

                Endif
            Endif

            If llOk
                This.AddItem( Alltrim( loField.Caption ))
                This.List( This.NewIndex, 2 ) = loField.Command
                This.List( This.NewIndex, 3 ) = loField.iCommand
            Endif
        Endif

    Endfor

    This.Selected( This.nDefault ) = .T.

    If This.Parent.chkCaseSensitive.Value
        lcLookUpCommand = This.List( This.ListIndex, 2 )

    Else
        lcLookUpCommand = This.List( This.ListIndex, 3 )

    Endif

    This.Parent.cLookUpCommand = lcLookUpCommand


Catch To loErr
    Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
    loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
    loError.cRemark = lcCommand
    loError.Process ( m.loErr )
    Throw loError

Finally
    loField 	= Null
    loColFields = Null

    Set Exact &lcExact

Endtry

ENDPROC
PROCEDURE ocolitems_access
Local lcCommand as String

Try

	lcCommand = ""
	
	If IsNull( This.oColItems )
		This.oColItems = This.oBiz.oFieldLookups
	EndIf

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

return This.oColItems

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] cbofieldlookups
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0N504T
[CLASS] _checkbox
[CLASSLOC] ..\..\fw\comunes\vcx\_controles_base.vcx
[BASECLASS] checkbox
[OBJNAME] chkfiltro
[START PROPERTIES]
AutoSize = .T.
Alignment = 0
Caption = ""
Value = .F.
Visible = .F.
ncolumnsspan = 0
nlabelposition = 0
nlabelspan = 0
nleftcolumn = 0
nrowspan = 0
ntoprow = 0
cclasslibrary = 
cclassname = 
lautomaticdisplay = .F.
nwidth = 0
Name = "chkfiltro"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Local lcCommand As String

Try

	lcCommand = ""
	NoDefault

*!*		If This.lHyperlink
*!*			Declare Integer GetSysColor In 'user32' Integer nIndex
*!*			This.nForeColor 	= This.ForeColor && GetSysColor( 26 ) && COLOR_HOTLIGHT
*!*			This.nHoverColor 	= GetSysColor( 29 ) && COLOR_MENUHILIGHT
*!*			This.MousePointer 	= 15
*!*			*!*			This.ForeColor 		= Rgb( 0, 102, 204 )
*!*		EndIf
*!*		
*!*		If Pemstatus( Thisform, 'InitializeControls', 5 )
*!*			Bindevent( Thisform, 'InitializeControls', This, 'Initialize', 1 )
*!*		Endif

*!*		If Pemstatus( Thisform, 'InitializeRows', 5 )
*!*			Bindevent( Thisform, 'InitializeRows', This, 'InitializeRows', 1 )
*!*		Endif

*!*		If Pemstatus( Thisform, 'AfterBindControls', 5 )
*!*			Bindevent( Thisform, 'AfterBindControls', This, 'AfterBindControls', 1 )
*!*		Endif


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE InteractiveChange
If This.Value
	This.Caption = "Verdadero"

Else
	This.Caption = "Falso"

Endif


ENDPROC
PROCEDURE initialize
NoDefault

ENDPROC
PROCEDURE initializerows
NoDefault

ENDPROC
PROCEDURE obiz_access
If Isnull( This.oBiz )
	If Pemstatus( This.Parent, "oBiz", 5 )
		This.oBiz = This.Parent.oBiz

	Else
		This.oBiz = Thisform.oBiz

	Endif

EndIf

Return This.oBiz

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] chkfiltro
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0N65O5
[CLASS] _date
[CLASSLOC] ..\..\fw\comunes\vcx\_controles_base.vcx
[BASECLASS] container
[OBJNAME] datefiltro
[START PROPERTIES]
Visible = .F.
llabelautosize = .F.
ncolumnsspan = 0
nlabelposition = 0
nlabelspan = 0
nleftcolumn = 0
nrowspan = 0
ntoprow = 0
cclasslibrary = 
cclassname = 
Name = "datefiltro"
KEYDATE.Name = "KEYDATE"
CMDKEYDATE.Name = "CMDKEYDATE"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Lparameters lnWidth, lnHeight	&& Optional Width and Height

Local lcCommand As String

Try

	lcCommand = ""
	
	DoDefault( lnWidth, lnHeight )

*!*		If Pemstatus( Thisform, 'InitializeControls', 5 )
*!*			Bindevent( Thisform, 'InitializeControls', This, 'Initialize', 1 )
*!*		Endif

*!*		If Pemstatus( Thisform, 'InitializeRows', 5 )
*!*			Bindevent( Thisform, 'InitializeRows', This, 'InitializeRows', 1 )
*!*		Endif

*!*		If Pemstatus( Thisform, 'AfterBindControls', 5 )
*!*			Bindevent( Thisform, 'AfterBindControls', This, 'AfterBindControls', 1 )
*!*		Endif

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE initialize
Local lcCommand As String
Local loBiz As oMovimiento Of "FrontEnd\Prg\Movimiento.prg"

Try

	lcCommand = ""
	loBiz = This.oBiz
	This.Value = loBiz.dFechaFinal

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loBiz = Null

Endtry

ENDPROC
PROCEDURE initializerows
NoDefault

ENDPROC
PROCEDURE obiz_access
If Isnull( This.oBiz )
	If Pemstatus( This.Parent, "oBiz", 5 )
		This.oBiz = This.Parent.oBiz

	Else
		This.oBiz = Thisform.oBiz

	Endif

EndIf

Return This.oBiz

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] datefiltro
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0N72P9
[CLASS] _spinner
[CLASSLOC] ..\..\fw\comunes\vcx\_controles_base.vcx
[BASECLASS] spinner
[OBJNAME] spnfiltro
[START PROPERTIES]
Visible = .F.
Width = 120
lautomaticdisplay = .F.
lseparamiles = .F.
ncolumnsspan = 0
nlabelposition = 0
nlabelspan = 0
nleftcolumn = 0
nrowspan = 0
ntoprow = 0
ndecimals = 0
cclasslibrary = 
cclassname = 
Name = "spnfiltro"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Local lcCommand As String

Try

	lcCommand = ""

	This.lFontItalic 	= This.FontItalic
	This.cForecolor 	= This.ForeColor
	This.nAlignment 	= This.Alignment
	This.cFormat 		= This.Format
	This.cInputMask 	= This.InputMask
	This.cgetinputmask  = This.InputMask
	This.lInitialized 	= .F.

*!*		If Pemstatus( Thisform, 'InitializeControls', 5 )
*!*			Bindevent( Thisform, 'InitializeControls', This, 'Initialize', 1 )
*!*		Endif

*!*		If Pemstatus( Thisform, 'InitializeRows', 5 )
*!*			Bindevent( Thisform, 'InitializeRows', This, 'InitializeRows', 1 )
*!*		Endif

*!*		If Pemstatus( Thisform, 'AfterBindControls', 5 )
*!*			Bindevent( Thisform, 'AfterBindControls', This, 'AfterBindControls', 1 )
*!*		Endif

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE initialize
NoDefault

ENDPROC
PROCEDURE initializerows
NoDefault

ENDPROC
PROCEDURE obiz_access
If Isnull( This.oBiz )
	If Pemstatus( This.Parent, "oBiz", 5 )
		This.oBiz = This.Parent.oBiz

	Else
		This.oBiz = Thisform.oBiz

	Endif

EndIf

Return This.oBiz

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] spnfiltro
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0N7PLN
[CLASS] _textbox
[CLASSLOC] ..\..\fw\comunes\vcx\_controles_base.vcx
[BASECLASS] textbox
[OBJNAME] txtfiltro
[START PROPERTIES]
Visible = .F.
Width = 120
lautomaticdisplay = .F.
ncolumnsspan = 0
nlabelposition = 0
nlabelspan = 0
nleftcolumn = 0
nrowspan = 0
ntoprow = 0
cclasslibrary = 
cclassname = 
Name = "txtfiltro"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Local lcCommand As String

Try

	lcCommand = ""

	This.lFontItalic 	= This.FontItalic
	This.cForecolor 	= This.ForeColor
	This.nAlignment 	= This.Alignment
	This.cFormat 		= This.Format
	This.cInputMask 	= This.InputMask
	This.nMaxLength 	= This.MaxLength
	This.lInitialized 	= .F.

*!*		If Pemstatus( Thisform, 'InitializeControls', 5 )
*!*			Bindevent( Thisform, 'InitializeControls', This, 'Initialize', 1 )
*!*		Endif

*!*		If Pemstatus( Thisform, 'InitializeRows', 5 )
*!*			Bindevent( Thisform, 'InitializeRows', This, 'InitializeRows', 1 )
*!*		Endif

	If Pemstatus( Thisform, 'AfterBindControls', 5 )
		Bindevent( Thisform, 'AfterBindControls', This, 'AfterBindControls', 1 )
	Endif

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE ccuetext_assign
#INCLUDE "FW\Comunes\Include\Praxis.h"

Lparameters tcCueText
This.cCueText = tcCueText
This.ToolTipText = This.cCueText
ENDPROC
PROCEDURE initialize
NoDefault

ENDPROC
PROCEDURE initializerows
NoDefault

ENDPROC
PROCEDURE obiz_access
If Isnull( This.oBiz )
	If Pemstatus( This.Parent, "oBiz", 5 )
		This.oBiz = This.Parent.oBiz

	Else
		This.oBiz = Thisform.oBiz

	Endif

EndIf

Return This.oBiz

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] txtfiltro
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[START RESERVED1]
 ! ..\..\fw\comunes\include\praxis.hFWs~\V! ..\..\fw\comunes\include\foxpro.hNXÊrûF" ..\..\fw\comunes\include\strings.hVYZŠOJ' ..\..\tools\namespaces\include\system.h^Z±ÙF[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68E0N8NRA
[CLASS] _listbox
[CLASSLOC] ..\..\fw\comunes\vcx\_controles_base.vcx
[BASECLASS] listbox
[OBJNAME] lstfiltro
[START PROPERTIES]
Visible = .F.
Width = 252
IntegralHeight = .T.
ncolumnsspan = 0
nlabelposition = 0
nlabelspan = 0
nleftcolumn = 0
nrowspan = 0
ntoprow = 0
lautomaticdisplay = .F.
cclasslibrary = 
cclassname = 
ofield = .NULL.
_memberdata = <VFPData><memberdata name="ofield" display="oField"/><memberdata name="ofield_access" display="oField_Access"/></VFPData>
Name = "lstfiltro"
[END PROPERTIES]
[START METHODS]
PROCEDURE GotFocus
#INCLUDE "FW\Comunes\Include\Praxis.h"

Local lcCommand As String

Try

	lcCommand = ""
	This.ItemBackColor = _CB_ONFOCUS_BACKCOLOR
	This.ItemForeColor = _CB_ONFOCUS_FORECOLOR
	This.Height = 60
	This.ZOrder()
	This.Parent.Height = This.Height
	*This.Refresh()
	*Inform( Program() )
	

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = _NewObject ( 'ErrorHandler', 'ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE Init
Local lcCommand As String

Try

	lcCommand = ""

	This.BoundColumn 	= 2
	This.BoundTo 		= .T.
	This.ColumnCount 	= 1
	This.RowSourceType 	= 0
	This.RowSource 		= ""
	This.MultiSelect 	= .T.

	This.oFiltros = Newobject( "CollectionBase", "Tools\Namespaces\Prg\CollectionBase.Prg" )


	*	This.Style			= 2
	*	This.Sorted 		= .T.

	*!*		If Pemstatus( Thisform, 'InitializeControls', 5 )
	*!*			Bindevent( Thisform, 'InitializeControls', This, 'Initialize', 1 )
	*!*		Endif

	*!*		If Pemstatus( Thisform, 'InitializeRows', 5 )
	*!*			Bindevent( Thisform, 'InitializeRows', This, 'InitializeRows', 1 )
	*!*		Endif

	*!*		If Pemstatus( Thisform, 'AfterBindControls', 5 )
	*!*			Bindevent( Thisform, 'AfterBindControls', This, 'AfterBindControls', 1 )
	*!*		Endif
	*!*
	*!*		This.oFiltros = Newobject( "CollectionBase", "Tools\Namespaces\Prg\CollectionBase.Prg" )



Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = _NewObject ( 'ErrorHandler', 'ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE LostFocus
#INCLUDE "FW\Comunes\Include\Praxis.h"

Local lcCommand As String

Try

	lcCommand = ""
	This.ItemBackColor = _CB_BACKCOLOR
	This.ItemForeColor = _CB_FORECOLOR
	This.Height = 24
	This.Parent.Height = This.Height
	*This.Refresh()
	*Inform( Program() )

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = _NewObject ( 'ErrorHandler', 'ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	Wait Clear


Endtry

ENDPROC
PROCEDURE cargarlistbox
Local lcCommand As String,;
lcAlias as String
Local loModelo As oModelo Of "FrontEnd\Prg\Modelo.prg",;
	loParam As Object,;
	loFiltros As CollectionBase Of Tools\Namespaces\Prg\CollectionBase.Prg

Try

	lcCommand = ""
	This.Clear()
	This.oField = Null
	
	loField = This.oField
	loModelo = GetEntity( loField.cFK_Modelo )
	
	This.AgregarFiltros()
	
	loFiltros = This.oFiltros
	loParam = Createobject( "Empty" )

	AddProperty( loParam, "oFilterCriteria", loFiltros )

	lcAlias = loModelo.cMainCursorName + Sys(2015)
	AddProperty( loParam, "cAlias", lcAlias )
	
	loModelo.GetByWhere( loParam )

	This.Clear()
	Select Alias( lcAlias )
	Locate
	Scan
		This.AddItem( Alltrim( Nombre ))
		This.List( This.NewIndex, 2 ) = Transform( Evaluate( loModelo.cPKField ) )
	Endscan

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loFiltro = Null
	loFiltros = Null
	loParam = Null
	loModelo = Null
	
	Use in Select( lcAlias )

Endtry

ENDPROC
PROCEDURE initialize
NoDefault

ENDPROC
PROCEDURE initializerows
NoDefault

ENDPROC
PROCEDURE obiz_access
If Isnull( This.oBiz )
	If Pemstatus( This.Parent, "oBiz", 5 )
		This.oBiz = This.Parent.oBiz

	Else
		This.oBiz = Thisform.oBiz

	Endif

EndIf

Return This.oBiz

ENDPROC
PROCEDURE ofield_access
Local lcCommand As String
Local loColFields As oColBase Of 'Tools\DataDictionary\prg\oColBase.prg',;
	loField As oField Of 'Tools\DataDictionary\prg\oField.prg',;
	loBiz As oMovimiento Of "FrontEnd\Prg\Movimiento.prg",;
	loTable As Archivo Of "Clientes\Utiles\Prg\utRutina.prg"


Try

	lcCommand = ""
	If Isnull( This.oField )
		loBiz 	= This.oBiz
		loTable = loBiz.GetTable()
		This.oField = loTable.GetField( This.Parent.cFieldName )
	Endif

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loBiz 	= Null
	loTable = Null

Endtry

Return This.oField

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED3]
*ofield_access 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] lstfiltro
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[START RESERVED1]
 ! ..\..\fw\comunes\include\praxis.hFWs~\V! ..\..\fw\comunes\include\foxpro.hNXÊrûF" ..\..\fw\comunes\include\strings.hVYZŠOJ' ..\..\tools\namespaces\include\system.h^Z±ÙF[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68P0OP6L2
[CLASS] _container
[CLASSLOC] ..\..\fw\comunes\vcx\_controles_base.vcx
[BASECLASS] container
[OBJNAME] tipo
[START PROPERTIES]
Width = 672
Height = 36
Name = "tipo"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Local lcCommand as String

Try

	lcCommand = ""
	This.BorderWidth = 0
*!*		If Empty( This.cTable )
*!*			This.cTable = This.Parent.cTable
*!*		EndIf
	
	If Pemstatus( Thisform, 'InitializeControls', 5 )
		Bindevent( Thisform, 'InitializeControls', This, 'Initialize', 1 )
	Endif

*!*		If Pemstatus( Thisform, 'InitializeRows', 5 )
*!*			Bindevent( Thisform, 'InitializeRows', This, 'InitializeRows', 1 )
*!*		Endif

*!*		If Pemstatus( Thisform, 'AfterBindControls', 5 )
*!*			Bindevent( Thisform, 'AfterBindControls', This, 'AfterBindControls', 1 )
*!*		Endif
	

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE initialize
Local lcCommand as String

Try

	lcCommand = ""
	This.cboInforme.CargarCombo()

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE obiz_access
If Isnull( This.oBiz )
	If Pemstatus( This.Parent, "oBiz", 5 )
		This.oBiz = This.Parent.oBiz

	Else
		This.oBiz = Thisform.oBiz

	Endif

EndIf

Return This.oBiz

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
3[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68P0OTS7V
[CLASS] label
[BASECLASS] label
[OBJNAME] lblInformes
[PARENT] tipo
[START PROPERTIES]
AutoSize = .T.
FontBold = .T.
FontSize = 12
BackStyle = 0
Caption = "Tipo de Informe"
Height = 22
Left = 24
Top = 12
Width = 121
ForeColor = 0,64,128
Name = "lblInformes"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68P0OTS7W
[CLASS] cbofiltro
[CLASSLOC] informes.vcx
[BASECLASS] combobox
[OBJNAME] cboInforme
[PARENT] tipo
[START PROPERTIES]
Left = 168
Top = 12
Width = 408
Name = "cboInforme"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Local lcCommand As String

Try

	lcCommand = ""
	This.BoundColumn 	= 2
	This.BoundTo 		= .T.
	This.ColumnCount 	= 1
	This.RowSourceType 	= 0
	This.RowSource 		= ""
	This.Style			= 2


Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry


ENDPROC
PROCEDURE cargarcombo
Local lcCommand As String,;
lcFilterControl as String
Local llInlist As Boolean
Local loColInformes As oColBase Of 'Tools\DataDictionary\prg\oColBase.prg',;
	loInforme As Object,;
	loBiz As oMovimiento Of "FrontEnd\Prg\Movimiento.prg"


Try

	lcCommand = ""
	loColInformes = This.oColItems
	This.Clear()

	For Each loInforme In loColInformes

		If loInforme.Activo
			This.AddItem( Alltrim( loInforme.Caption ))
			This.List( This.NewIndex, 2 ) = loInforme.Url
			This.List( This.NewIndex, 3 ) = Transform( loInforme.Id )
		EndIf

	Endfor

	This.Selected( This.nDefault ) = .T.

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loInforme = Null
	loColInformes = Null


Endtry

ENDPROC
PROCEDURE obiz_access
If Isnull( This.oBiz )
	If Pemstatus( This.Parent, "oBiz", 5 )
		This.oBiz = This.Parent.oBiz

	Else
		This.oBiz = Thisform.oBiz

	Endif

EndIf

Return This.oBiz

ENDPROC
PROCEDURE ocolitems_access
Local lcCommand as String

Try

	lcCommand = ""
	
	If IsNull( This.oColItems )
		This.oColItems = This.oBiz.oTiposDeInforme
	EndIf

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

return This.oColItems

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] tipo
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69R0NDCFR
[CLASS] container
[BASECLASS] container
[OBJNAME] filtros_adicionales
[START PROPERTIES]
Width = 723
Height = 102
BackStyle = 0
Visible = .T.
_memberdata =      363<VFPData><memberdata name="autosize" display="Autosize"/><memberdata name="visible" display="Visible"/><memberdata name="visible_assign" display="Visible_Assign"/><memberdata name="ocolfiltros" display="oColFiltros"/><memberdata name="ocolfiltros_assign" display="oColFiltros_Assign"/><memberdata name="ocolfiltros_access" display="oColFiltros_Access"/></VFPData>
ocolfiltros = .NULL.
Name = "filtros_adicionales"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Local lcCommand as String

Try

	lcCommand = ""
	This.Anchor 		= 0
	This.BorderWidth 	= 0
	This.Left 			= 0
	This.Width 			= Thisform.Width
	This.Anchor 		= 0

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE autosize
Local lcCommand as String
Local lnTop as Integer,;
lnHeight as Integer,;
lnLeft as Integer

Local loFiltro As cntFiltro_Adicional Of "FrontEnd\Vcx\informes.vcx"


Try

	lcCommand = ""
	
	lnTop 		= Thisform.nGap * 2
	lnLeft 		= Thisform.nGap * 2
	
	For Each loFiltro in This.oColFiltros
		If loFiltro.Visible = .T.
			loFiltro.Top = lnTop
			loFiltro.Left = lnLeft
			
			lnTop = lnTop + loFiltro.Height
		EndIf
	EndFor
	
	lnHeight = lnTop && + Thisform.nGap
	This.Shape.Height = lnHeight
	This.Height = lnHeight + ( Thisform.nGap * 2 )

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE ocolfiltros_access
If Isnull( This.oColFiltros )
	This.oColFiltros = NewObject( "oColBase", 'Tools\DataDictionary\prg\oColBase.prg' )
Endif

Return This.oColFiltros

ENDPROC
PROCEDURE visible_assign
lparameters tVisible
This.Visible = tVisible
This.SetAll( "Visible", tVisible )
ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
3[END RESERVED2]
[START RESERVED3]
_memberdata XML Metadata for customizable properties
ocolfiltros
*autosize Specifies if a control is automatically resized to fit its contents.
*visible_assign 
*ocolfiltros_access 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69R0O32JB
[CLASS] shape
[BASECLASS] shape
[OBJNAME] Shape
[PARENT] filtros_adicionales
[START PROPERTIES]
Top = 12
Left = 12
Height = 72
Width = 696
BackStyle = 0
Curvature = 12
BorderColor = 0,128,255
ZOrderSet = 0
Name = "Shape"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69R0O32JC
[CLASS] label
[BASECLASS] label
[OBJNAME] lblFiltro
[PARENT] filtros_adicionales
[START PROPERTIES]
FontBold = .T.
FontSize = 14
Alignment = 2
Caption = "Filtros Adicionales"
Height = 25
Left = 36
Top = 0
Width = 180
ForeColor = 0,64,128
Name = "lblFiltro"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] filtros_adicionales

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69R0PVH3B
[CLASS] container
[BASECLASS] container
[OBJNAME] cntfiltro_adicional
[START PROPERTIES]
Width = 480
Height = 24
BackStyle = 0
Visible = .T.
_memberdata = <VFPData><memberdata name="visible" display="Visible"/><memberdata name="visible_assign" display="Visible_Assign"/></VFPData>
Name = "cntfiltro_adicional"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Local lcCommand as String

Try

	lcCommand = ""
	This.BorderWidth = 0
	
	If PemStatus( This.Parent, "oColFiltros", 5 )
		This.Parent.oColFiltros.AddItem( This, This.Name )
	EndIf
	
	This.chkActivo.InteractiveChange()


Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
3[END RESERVED2]
[START RESERVED3]
_memberdata XML Metadata for customizable properties
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69R0Q0UB9
[CLASS] checkbox
[BASECLASS] checkbox
[OBJNAME] chkActivo
[PARENT] cntfiltro_adicional
[START PROPERTIES]
Top = 0
Left = 0
Height = 17
Width = 18
AutoSize = .T.
Alignment = 0
BackStyle = 0
Caption = ""
Value = .F.
TabIndex = 14
ToolTipText = "Desactivar / Activar el Filtro"
Name = "chkActivo"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local lcCommand As String

Try

	lcCommand = ""

	This.Parent.SetAll( "Enabled", This.Value )
	This.Enabled = .T.

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69R0QBTOW
[CLASS] label
[BASECLASS] label
[OBJNAME] lblReferencia
[PARENT] cntfiltro_adicional
[START PROPERTIES]
AutoSize = .T.
FontSize = 12
BackStyle = 0
Caption = "Referencia"
Height = 21
Left = 60
Top = 0
Width = 78
Name = "lblReferencia"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] cntfiltro_adicional
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69R0QD76E
[CLASS] cntfiltro_adicional
[CLASSLOC] informes.vcx
[BASECLASS] container
[OBJNAME] date_filtro_ad
[START PROPERTIES]
Name = "date_filtro_ad"
chkActivo.Alignment = 0
chkActivo.Name = "chkActivo"
lblReferencia.Name = "lblReferencia"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
2[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69R0QF1ZZ
[CLASS] datefiltro
[CLASSLOC] informes.vcx
[BASECLASS] container
[OBJNAME] Fecha
[PARENT] date_filtro_ad
[START PROPERTIES]
Top = 0
Left = 254
Visible = .T.
Name = "Fecha"
keydate.Name = "keydate"
cmdKeyDate.Name = "cmdKeyDate"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] date_filtro_ad
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69R0R4ISL
[CLASS] cntfiltro_adicional
[CLASSLOC] informes.vcx
[BASECLASS] container
[OBJNAME] optiongroup_filtro_ad
[START PROPERTIES]
Width = 480
Height = 24
Name = "optiongroup_filtro_ad"
chkActivo.Alignment = 0
chkActivo.Name = "chkActivo"
lblReferencia.Name = "lblReferencia"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
2[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _68710IFSE
[CLASS] optiongroup
[BASECLASS] optiongroup
[OBJNAME] OptionGroup
[PARENT] optiongroup_filtro_ad
[START PROPERTIES]
ButtonCount = 0
BackStyle = 0
BorderStyle = 0
Value = 0
Height = 27
Left = 192
Top = 0
Width = 180
Name = "OptionGroup"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] optiongroup_filtro_ad
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69U0MYJU1
[CLASS] _form
[CLASSLOC] ..\..\fw\comunes\vcx\_controles_base.vcx
[BASECLASS] form
[OBJNAME] informe_en_grid
[START PROPERTIES]
Top = 0
Left = 0
Height = 415
Width = 720
DoCreate = .T.
MinWidth = 504
WindowType = 1
ofilters = .NULL.
oparam = .NULL.
ngap = 12
lgridloaded = .F.
lgridempty = .T.
ccursordetrabajo = 
cmaincursorname = 
nbufferingcursortrabajo = 5
ctitulodelprograma = 
ledit = .F.
ninformeid = 0
_memberdata =     1337<VFPData><memberdata name="autosize" display="Autosize"/><memberdata name="ofilters" display="oFilters"/><memberdata name="oparam" display="oParam"/><memberdata name="ngap" display="nGap"/><memberdata name="irpagina" display="IrPagina"/><memberdata name="addfilter" display="AddFilter"/><memberdata name="filtrar" display="Filtrar"/><memberdata name="cargargrilla" display="CargarGrilla"/><memberdata name="lgridloaded" display="lGridLoaded"/><memberdata name="lgridempty" display="lGridEmpty"/><memberdata name="crearcursordetrabajo" display="CrearCursorDeTrabajo"/><memberdata name="armargrilla" display="ArmarGrilla"/><memberdata name="ccursordetrabajo" display="cCursorDeTrabajo"/><memberdata name="ccursordetrabajo_access" display="cCursorDeTrabajo_Access"/><memberdata name="removefilter" display="RemoveFilter"/><memberdata name="cmaincursorname" display="cMainCursorName"/><memberdata name="cmaincursorname_access" display="cMainCursorName_Access"/><memberdata name="nbufferingcursortrabajo" display="nBufferingCursorTrabajo"/><memberdata name="ctitulodelprograma" display="cTituloDelPrograma"/><memberdata name="ledit" display="lEdit"/><memberdata name="inicializarfiltros" display="InicializarFiltros"/><memberdata name="minwidth" type="Property" favorites="True"/><memberdata name="ninformeid" display="nInformeId"/></VFPData>
Name = "informe_en_grid"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Lparameters oParam As Object

Local lcCommand As String
Local loReturn As Object,;
loBiz As oMovimiento Of "FrontEnd\Prg\Movimiento.prg"
Local llOk As Boolean,;
llAutocenter as Boolean

Local loControl As ControlNameSpace Of 'Tools\Namespaces\Prg\ControlNameSpace.prg'

Try

	lcCommand = ""
	llOk = .F.
	
	loReturn = Createobject( "Empty" )
	AddProperty( loReturn, "Status", -1 )
	
	Thisform.oFilters 		= NewObject( "CollectionBase", "Tools\Namespaces\Prg\CollectionBase.Prg" )
	Thisform.oReturn 		= loReturn
	Thisform.oParam 		= oParam
	Thisform.Grid.oParam 	= oParam
	Thisform.oBiz			= oParam.oBiz
	
	loBiz = Thisform.oBiz
	
	Thisform.Titulo.lblTitulo.Caption 	= loBiz.cTituloEnGrilla
	Thisform.Titulo.LblFecha.Caption 	= F_Today( FECHAHOY )
	Thisform.cTituloDelPrograma 		= loBiz.cTitulo
	Thisform.Caption 					= loBiz.cTituloDelInforme
	Thisform.nInformeId 				= loBiz.nInformeId
	
	loControl = NewObject( "ControlNameSpace", 'Tools\Namespaces\Prg\ControlNameSpace.prg' )
	loControl.TextProperties( Thisform.Titulo.lblTitulo )
	loControl.TextProperties( Thisform.Titulo.LblFecha )
*!*		loControl.TextProperties( Thisform.Titulo.LblAsteriscos )
*!*		loControl.TextProperties( Thisform.Titulo.LblObservaciones )

	Thisform.InicializarFiltros()
	
	Thisform.InitializeControls()
	Thisform.IrPagina(1)
	
	Thisform.Refresh()
	
	llAutocenter = .F.
	If Thisform.Height > _Screen.Height - ( Thisform.nGap * 4 )
		_Screen.Height = Thisform.Height + ( Thisform.nGap * 4 )
		llAutocenter = .T.
	EndIf
	
	If Thisform.Width > _Screen.Width - ( Thisform.nGap * 4 )
		_Screen.Width = Thisform.Width + ( Thisform.nGap * 4 )
		llAutocenter = .T.
	EndIf
	
	If llAutocenter
		_Screen.AutoCenter = .T.
	EndIf

	Thisform.Titulo.LblFecha.Left = Thisform.Width - Thisform.Titulo.LblFecha.Width - 05
	Thisform.Visible = .T.
	
	llOk = .T.

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	loParametros = Null
	loReturn = Null
	loBiz = Null
	oParam = Null
	loControl = Null

Endtry

Return llOk

ENDPROC
PROCEDURE addfilter
Lparameters loFilter as Object
Local lcCommand as String
Local loFiltros As CollectionBase Of Tools\Namespaces\Prg\CollectionBase.Prg

Try

	lcCommand = ""
	This.RemoveFilter( loFilter.Nombre )
	loFiltros = Thisform.oFilters
	loFiltros.AddItem( loFilter, loFilter.Nombre )

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loFilter 	= Null
	loFiltros 	= Null


EndTry

ENDPROC
PROCEDURE armargrilla
#INCLUDE "FW\Comunes\Include\Praxis.h"

Local lcCommand As String

Local lnGridWidth As Integer,;
	lnGap As Integer

Local loGrid As browsegrid Of fw\comunes\vcx\prxbrowse.vcx,;
loBiz As oModelo Of "FrontEnd\Prg\Modelo.prg"

Try

	lcCommand = ""
	lnGap = Thisform.nGap

	loGrid = Thisform.Grid

	loGrid.Fill()

	lnGridWidth = lnGap
	loGrid.Left = lnGap

	For q = 1 To loGrid.ColumnCount
		With loGrid.Columns[ q ] As Column
			If .Visible
				lnGridWidth = lnGridWidth + .Width
			Endif
		Endwith
	Next

	lnGridWidth = lnGridWidth + lnGap
	lnGridWidth = Max( lnGridWidth, Thisform.MinWidth )
	
	ThisForm.Grid.Width = lnGridWidth

	Thisform.BindControls = .T.
	
	loBiz = This.oBiz
	
	*Thisform.cntPagination.LblDe_99.Caption = Transform( loBiz.nCurrentPage ) + " Registros Encontrados"	
*!*		Thisform.cntPagination.spnPagina.Value = loBiz.nCurrentPage
*!*		Thisform.cntPagination.lblRegistros.Caption = Transform( loBiz.nTotalDeRegistros ) + " Registros Encontrados"	
	
	*Thisform.cntPagination.Sincronizar()
	Thisform.cntPagination.Visible = .T.

	Select Alias( This.cCursorDeTrabajo )

	Locate

	Thisform.Width = Min( lnGridWidth, _Screen.Width - ( 2 * Sysmetric( SYSMETRIC_VSCROLLBARWIDTH )))
	Thisform.Width = Thisform.Width + 2
	Thisform.AutoCenter = .T.

	Thisform.Refresh()
	loGrid.SetFocus()


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError


Finally
	loGrid = Null

	Wait Clear
	Thisform.LockScreen = .F.

Endtry

ENDPROC
PROCEDURE autosize
#INCLUDE "FW\Comunes\Include\Praxis.h"

Local lcCommand As String
Local lnFormHeight As Integer,;
	lnFormWidth As Integer,;
	lnGridHeight as Integer

Local llAutocenter as Boolean

Try

	lcCommand = ""
	llAutocenter = .F.

	Thisform.Titulo.Anchor 		= 0
	*Thisform.Acciones.Anchor 	= 0
	*ThisForm.Grid.Anchor = 0

	*!*		lnFormHeight = ( Thisform.nCalculatedHeight + Thisform.Crud_Buttons.Height )
	*!*		lnFormHeight = lnFormHeight + ( Thisform.nGap * 3 )

	*!*		If lnFormHeight > Thisform.Height
	*!*			Thisform.Height = lnFormHeight
	*!*		EndIf

	lnGridHeight = ( ThisForm.cntPagination.spnPageSize.Value * ThisForm.Grid.RowHeight )
	lnGridHeight = lnGridHeight + ThisForm.Grid.HeaderHeight
	lnGridHeight = lnGridHeight + ( ThisForm.Grid.RowHeight / 2 )

	Thisform.Height = Thisform.Height - Thisform.Grid.Height + lnGridHeight

	If Thisform.Height > ( _Screen.Height - ( Thisform.nGap * 8 ) )
		_Screen.Height = Thisform.Height + ( Thisform.nGap * 4 )
		llAutocenter = .T.
	EndIf

	If _Screen.Height > ( Sysmetric( SYSMETRIC_SCREENHEIGHT ) - ( Thisform.nGap * 8 ))
		_Screen.WindowState = 2
		*!*			Thisform.WindowState = 2
		llAutocenter = .T.
		Thisform.Height = _Screen.Height - ( Thisform.nGap * 8 )
	EndIf

	lnFormWidth = Thisform.Grid.Width + ( Thisform.nGap * 2 )
	Thisform.Width = lnFormWidth

	If Thisform.Width > _Screen.Width - ( Thisform.nGap * 4 )
		_Screen.Width = Thisform.Width + ( Thisform.nGap * 4 )
		llAutocenter = .T.
	EndIf

	If llAutocenter
		_Screen.AutoCenter = .T.
	EndIf

	Thisform.AutoCenter = .T.

	If Mod( Thisform.Width, Thisform.nGap ) > 0
		Thisform.Width = Round( Thisform.Width / Thisform.nGap, 0 ) * Thisform.nGap
	Endif

	If Mod( Thisform.Height, Thisform.nGap ) > 0
		Thisform.Height = Round( Thisform.Height / Thisform.nGap, 0 ) * Thisform.nGap
	Endif

	Thisform.Titulo.Top 	= 0
	Thisform.Titulo.Left 	= 0
	Thisform.Titulo.AutoSize()

	If Thisform.Titulo.Width > Thisform.Width
		Thisform.Width = Thisform.Titulo.Width

	Else
		Thisform.Titulo.Width 	= Thisform.Width

	Endif


Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	Thisform.Titulo.Anchor 	= 11
	*Thisform.Acciones.Anchor 	= 14
	*ThisForm.Grid.Anchor = 15

Endtry

ENDPROC
PROCEDURE cargargrilla
Local lcCommand As String
Local lnRecords As Integer
Local loParam As Object,;
	loBiz As oModelo Of "FrontEnd\Prg\Modelo.prg",;
	loColumn As PrxColumn Of "Fw\TierAdapter\Comun\prxBaseLibrary.prg",;
	loHeader As PrxHeader Of "Fw\TierAdapter\Comun\prxbaselibrary.prg"

Try

	lcCommand = ""
	loParam = Createobject( "Empty" )

	AddProperty( loParam, "oFilterCriteria", This.oFilters )

	Thisform.lGridLoaded 	= .F.
	Thisform.lGridEmpty 	= .T.
	Thisform.LockScreen 	= .T.
	Thisform.BindControls 	= .F.
	Thisform.Grid.Empty()
	Thisform.Grid.oTable 	= Null
	Thisform.Grid.oColGridLayout = Null
	Thisform.oBiz.Requery( loParam )
	Thisform.CrearCursorDeTrabajo()
	Thisform.ArmarGrilla()

	lnRecords = Reccount( This.cCursorDeTrabajo )

	Thisform.lGridLoaded 	= !Empty( lnRecords )
	Thisform.lGridEmpty 	= Empty( lnRecords )

	loBiz = This.oBiz
	If !Empty( loBiz.cOrderBy )
		loColumn = Evaluate( "This.Grid." + loBiz.cOrderBy )
		loHeader = loColumn.Controls[1]
		loHeader.CurrentOrder = Iif( loBiz.cOrderPrefix = "", [ASCENDING], [DESCENDING] )

		loColumn.Controls[1].FontBold = .T.

		If loHeader.CurrentOrder = [ASCENDING]
			loColumn.Controls[1].Picture = "v:\CloudFox\FW\Comunes\image\bmp\uparrow.bmp"

		Else
			loColumn.Controls[1].Picture = "v:\CloudFox\FW\Comunes\image\bmp\dnarrow.bmp"

		Endif

		loColumn.FontBold = .T.

	Endif

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	loBiz = Null


Endtry

ENDPROC
PROCEDURE ccursordetrabajo_access
If Empty( This.cCursorDeTrabajo )
	This.cCursorDeTrabajo = "w_" + This.cMainCursorName
EndIf

Return This.cCursorDeTrabajo

ENDPROC
PROCEDURE cmaincursorname_access
If Empty( This.cMainCursorName )
	This.cMainCursorName = Thisform.oBiz.cMainCursorName
Endif

Return This.cMainCursorName

ENDPROC
PROCEDURE crearcursordetrabajo
Local lcCommand as String

Try

	lcCommand = ""

	If Thisform.oBiz.lCanUpdate And InList( CursorGetProp("Buffering", Thisform.cMainCursorName ), 3, 5 )

		Thisform.cCursorDeTrabajo = ThisForm.Grid.cCursorDeTrabajo
		
		Use in Select( Thisform.cCursorDeTrabajo )
		
		Text To lcCommand NoShow TextMerge Pretext 15
		Select *
			From <<Thisform.cMainCursorName>>
			With ( Buffering = .T. )
			Into Cursor <<Thisform.cCursorDeTrabajo>> ReadWrite
		EndText

		&lcCommand
		
		CursorSetProp("Buffering", Thisform.nBufferingCursorTrabajo, Thisform.cCursorDeTrabajo )
		
	Else
		Thisform.cCursorDeTrabajo = Thisform.cMainCursorName
		
	EndIf

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	
	
EndTry

ENDPROC
PROCEDURE filtrar
Local lcCommand as String

Try

	lcCommand = ""
	Thisform.CargarGrilla()

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE inicializarfiltros
Local lcCommand as String
Local loBiz As oMovimiento Of "FrontEnd\Prg\Movimiento.prg",;
	loFiltro As Object

Try

	lcCommand = ""
	loBiz = Thisform.oBiz

	For Each loFiltro In loBiz.oFilterCriteria

		Thisform.AddFilter( loFiltro )

	Endfor

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loFiltro 	= Null
	loBiz 		= Null

EndTry

ENDPROC
PROCEDURE irpagina
Lparameters nPagina As Integer, nPageSize As Integer
Local lcCommand As String

Try

	lcCommand = ""

	loFilter = Createobject( "Empty" )
	AddProperty( loFilter, "Nombre", "IrPagina" )
	AddProperty( loFilter, "FieldName", "page" )
	AddProperty( loFilter, "FieldRelation", "=" )
	AddProperty( loFilter, "FieldValue", Transform( nPagina ) )

	Thisform.AddFilter( loFilter )

	If !Empty( nPageSize )
		loFilter = Createobject( "Empty" )
		AddProperty( loFilter, "Nombre", "SetPageSize" )
		AddProperty( loFilter, "FieldName", "current_size" )
		AddProperty( loFilter, "FieldRelation", "=" )
		AddProperty( loFilter, "FieldValue", Transform( nPageSize ) )

		Thisform.AddFilter( loFilter )

	Endif

	Thisform.Filtrar()
	
	Thisform.Autosize()

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE removefilter
Lparameters cFilterName as String
Local lcCommand as String
Local loFiltros As CollectionBase Of Tools\Namespaces\Prg\CollectionBase.Prg

Try

	lcCommand = ""
	loFiltros = Thisform.oFilters
	loFiltros.RemoveItem( cFilterName )

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loFiltros = Null


EndTry

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
5[END RESERVED2]
[START RESERVED3]
ofilters
oparam
ngap
lgridloaded
lgridempty
ccursordetrabajo
cmaincursorname
nbufferingcursortrabajo
ctitulodelprograma
ledit
ninformeid
*autosize Specifies if a control is automatically resized to fit its contents.
*irpagina 
*addfilter 
*filtrar 
*cargargrilla 
*crearcursordetrabajo 
*armargrilla 
*ccursordetrabajo_access 
*removefilter 
*cmaincursorname_access 
*inicializarfiltros 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69U0NPY1T
[CLASS] crud_titulo
[CLASSLOC] crud.vcx
[BASECLASS] container
[OBJNAME] Titulo
[PARENT] informe_en_grid
[START PROPERTIES]
Top = 0
Left = 0
Name = "Titulo"
lblFecha.Name = "lblFecha"
LBLTITULO.Name = "LBLTITULO"
lblObservaciones.Name = "lblObservaciones"
lblAsteriscos.Name = "lblAsteriscos"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69U0NPY1U
[CLASS] browsegrid
[CLASSLOC] ..\..\fw\comunes\vcx\prxbrowse.vcx
[BASECLASS] grid
[OBJNAME] Grid
[PARENT] informe_en_grid
[START PROPERTIES]
MemberClassLibrary = ..\prg\movimiento.prg
MemberClass = "Columna_Informe"
Anchor = 15
Height = 240
Left = 12
Top = 48
Width = 696
Name = "Grid"
[END PROPERTIES]
[START METHODS]
PROCEDURE beforedefinetable
Local lcCommand As String
Local loTable As oTable Of "Tools\DataDictionary\prg\oTable.prg"
Local loBiz As oModelo Of "FrontEnd\Prg\Modelo.prg"

Try

	lcCommand = ""
	
	loBiz 		= This.oBiz
	loTable 	= loBiz.CrearCursor( This.cMainCursorName )

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "ErrorhandlerPrg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	loBiz 		= Null

Endtry

Return loTable

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69U0NPY20
[CLASS] brwpagination
[CLASSLOC] ..\..\fw\comunes\vcx\prxbrowse.vcx
[BASECLASS] container
[OBJNAME] cntPagination
[PARENT] informe_en_grid
[START PROPERTIES]
Anchor = 6
Top = 300
Left = 12
Name = "cntPagination"
lblRegistros.Name = "lblRegistros"
lblPagina.Name = "lblPagina"
spnPagina.Name = "spnPagina"
btnPrimero.Name = "btnPrimero"
btnSiguiente.Name = "btnSiguiente"
btnAnterior.Name = "btnAnterior"
btnUltimo.Name = "btnUltimo"
lblDe_99.Name = "lblDe_99"
cmdPagina.Name = "cmdPagina"
spnPageSize.Name = "spnPageSize"
lblPageSize.Name = "lblPageSize"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69U0NUDPB
[CLASS] acciones
[CLASSLOC] informes.vcx
[BASECLASS] container
[OBJNAME] Acciones
[PARENT] informe_en_grid
[START PROPERTIES]
Anchor = 14
Top = 360
Left = 0
Name = "Acciones"
cmdEjecutar.Name = "cmdEjecutar"
cmdCancelar.Name = "cmdCancelar"
lblExportar.Name = "lblExportar"
CBOEXPORTAR.Name = "CBOEXPORTAR"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] informe_en_grid
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
[END PROPERTIES]
[START RESERVED1]
 ! ..\..\fw\comunes\include\praxis.hFWs~\V! ..\..\fw\comunes\include\foxpro.hNXÊrûF" ..\..\fw\comunes\include\strings.hVYZŠOJ' ..\..\tools\namespaces\include\system.h^Z±ÙF[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _69U0P4UBX
[CLASS] combobox
[BASECLASS] combobox
[OBJNAME] cboexportar
[START PROPERTIES]
Height = 24
Width = 156
_memberdata =      296<VFPData><memberdata name="initialize" display="Initialize"/><memberdata name="afterbindcontrols" display="AfterBindControls"/><memberdata name="obiz" display="oBiz"/><memberdata name="obiz_access" display="oBiz_Access"/><memberdata name="cmodelo" display="cModelo" favorites="True"/></VFPData>

obiz = .NULL.
cmodelo =  
Name = "cboexportar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Local lcCommand as String

Try

	lcCommand = ""
	This.BoundColumn = 2
	This.BoundTo = .T.

	
	If Pemstatus( Thisform, 'InitializeControls', 5 )
		Bindevent( Thisform, 'InitializeControls', This, 'Initialize', 1 )
	Endif

	If Pemstatus( Thisform, 'AfterBindControls', 5 )
		Bindevent( Thisform, 'AfterBindControls', This, 'AfterBindControls', 1 )
	Endif


Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE InteractiveChange
#INCLUDE "FW\Comunes\Include\Praxis.h"

Local lcCommand As String
Local loCmdExportar As CommandButton



Try

    lcCommand = ""

    External File ExportData.Bmp,;
        Print.Bmp,;
        Preview.Bmp,;
        Export.Bmp,;
        Grid.Bmp,;
        Pdf.Bmp,;
        TextBox.Bmp,;
        email.ico,;
        Procesar.ico

    loCmdExportar = This.Parent.cmdEjecutar

    *!*	#Define S_IMPRESORA					'0'
    *!*	#Define S_VISTA_PREVIA				'1'
    *!*	#Define S_HOJA_DE_CALCULO			'2'
    *!*	#Define S_PANTALLA					'3'
    *!*	#Define S_PDF						'4'
    *!*	#Define S_CSV						'5'
    *!*	#Define S_SDF						'6'
    *!*	#Define S_IMPRESORA_PREDETERMINADA	'7'
    *!*	#Define S_TXT						'8'
    *!*	#Define S_MAIL						'9'
    *!*	#Define S_LISTADO_DOS				'99'

    loCmdExportar.Caption = "Exportar"
    loCmdExportar.Picture = 'Fw\Comunes\Image\Bmp\ExportData.Bmp'


    Do Case
        Case This.Value = S_IMPRESORA
            loCmdExportar.Caption = "Imprimir"
            loCmdExportar.Picture = 'Fw\Comunes\Image\Bmp\Print.Bmp'


        Case This.Value = S_VISTA_PREVIA
            loCmdExportar.Picture = 'Fw\Comunes\Image\Bmp\Preview.Bmp'


        Case This.Value = S_HOJA_DE_CALCULO
            loCmdExportar.Picture = 'Fw\Comunes\Image\Bmp\Export.Bmp'

        Case This.Value = S_PANTALLA
            loCmdExportar.Picture = 'Fw\Comunes\Image\Bmp\Grid.Bmp'


        Case This.Value = S_PDF
            loCmdExportar.Picture = 'Fw\Comunes\Image\Bmp\Pdf.Bmp'

        Case This.Value = S_TXT
            loCmdExportar.Picture = 'Fw\Comunes\Image\Bmp\TextBox.Bmp'

        Case This.Value = S_MAIL
            *loCmdExportar.Picture = 'FW\Comunes\image\ico\email2.ico'
            loCmdExportar.Picture = 'FW\Comunes\image\ico\email.ico'

        Case This.Value = S_PROCESO
            loCmdExportar.Picture = 'FW\Comunes\image\ico\Procesar.ico'
            loCmdExportar.Caption = "Ejecutar"

        Otherwise
            loCmdExportar.Picture = ""

    Endcase

Catch To loErr
    Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
    loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
    loError.cRemark = lcCommand
    loError.Process ( m.loErr )
    Throw loError

Finally
    loCmdExportar = Null


Endtry

ENDPROC
PROCEDURE ProgrammaticChange
This.InteractiveChange()
ENDPROC
PROCEDURE afterbindcontrols
Local lcCommand as String

Try

	lcCommand = ""

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE initialize
Local lcCommand as String
Local loSalidas as Collection,;
	loSalida as Object
	
Local lnSelected as Integer,;
i as Integer

*!*	* -------------- Tipo de Salida -------------------------
*!*	#Define S_IMPRESORA					'0'
*!*	#Define S_VISTA_PREVIA				'1'
*!*	#Define S_HOJA_DE_CALCULO			'2'
*!*	#Define S_PANTALLA					'3'
*!*	#Define S_PDF						'4'
*!*	#Define S_CSV						'5'
*!*	#Define S_SDF						'6'
*!*	#Define S_IMPRESORA_PREDETERMINADA	'7'
*!*	#Define S_TXT						'8'
*!*	#Define S_MAIL						'9'
*!*	#Define S_LISTADO_DOS				'99'


Try

	lcCommand = ""
	lnSelected = 1
	With This As ComboBox

		loSalidas = This.oBiz.oSalidas
		i = 0

		For Each loSalida in loSalidas
			If loSalida.Activo
				i = i + 1
				.AddItem( loSalida.Nombre )
				.List[.NewIndex, 2] = loSalida.Id
				
				If loSalida.Id = loSalidas.Default
					lnSelected = i
				EndIf
			EndIf
		EndFor

		.Selected( lnSelected ) = .T.

	Endwith


Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE obiz_access
Local lcCommand as String

Try

	lcCommand = ""
	If IsNull( This.oBiz )
		If !Empty( This.cModelo )
			This.oBiz = GetEntity( This.cModelo )
			
		Else
			This.oBiz = Thisform.oBiz

		Endif
		
	EndIf

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loField = Null


EndTry

return This.oBiz

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED3]
_memberdata XML Metadata for customizable properties
obiz
cmodelo
*initialize Es llamado por el metodo Init del formulario
*afterbindcontrols 
*obiz_access 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] cboexportar
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[START RESERVED1]
 ! ..\..\fw\comunes\include\praxis.hFWs~\V! ..\..\fw\comunes\include\foxpro.hNXÊrûF" ..\..\fw\comunes\include\strings.hVYZŠOJ' ..\..\tools\namespaces\include\system.h^Z±ÙF[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6FG0M4FSG
[CLASS] container
[BASECLASS] container
[OBJNAME] filtros
[START PROPERTIES]
Width = 720
Height = 96
BackStyle = 0
Visible = .T.
_memberdata =      413<VFPData><memberdata name="visible" display="Visible"/><memberdata name="visible_assign" display="Visible_Assign"/><memberdata name="agregarfiltro" display="AgregarFiltro"/><memberdata name="eliminarfiltro" display="EliminarFiltro"/><memberdata name="autosize" display="Autosize"/><memberdata name="ocolfiltros" display="oColFiltros"/><memberdata name="ocolfiltros_access" display="oColFiltros_Access"/></VFPData>
ocolfiltros = .NULL.
Name = "filtros"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Local lcCommand as String

Try

	lcCommand = ""
	This.Anchor 		= 0
	This.BorderWidth 	= 0
	This.Left 			= 0
	This.Width 			= Thisform.Width
	
	For Each loControl in This.Controls
		If loControl.Class = "Filtro"
			This.oColFiltros.Add( loControl, loControl.Name )
		EndIf
	EndFor
	

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = NewObject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


EndTry

ENDPROC
PROCEDURE agregarfiltro
Local lcCommand As String,;
	lcName As String
Local lnTop As Integer,;
	lnLeft As Integer
Local loFiltro As Filtro Of "FrontEnd\Vcx\informes.vcx"
Local loImgAdd As Image
Local llAutocenter As Boolean

Try

	lcCommand = ""
	llAutocenter = .F.
	Thisform.LockScreen = .T.

	lnTop 	= This.Shape.Top 	+ ( Thisform.nGap * 2 )
	lnLeft	= This.Shape.Left + Thisform.nGap

	For Each loFiltro In This.oColFiltros
		If loFiltro.Visible
			lnTop 	= loFiltro.Top + loFiltro.Height
			*lnLeft 	= loFiltro.Left
		EndIf
	Endfor

	lcName = Sys(2015)

	This.Newobject( "Filtro" + lcName, "Filtro", "FrontEnd\Vcx\informes.vcx" )

	TEXT To lcCommand NoShow TextMerge Pretext 15
	loFiltro = This.Filtro<<lcName>>
	ENDTEXT

	&lcCommand
	lcCommand = ""

	This.oColFiltros.Add( loFiltro, loFiltro.Name )

	loFiltro.Top 		= lnTop
	loFiltro.Left 		= lnLeft
	loFiltro.lEsSistema = .F.
	loFiltro.CargarCombos()

*!*		loImgAdd = This.imgAgregar
*!*		loImgAdd.Top = loFiltro.Top + loFiltro.Height

	loFiltro.Visible 	= .T.

	ThisForm.Autosize()

	loFiltro.SetFocus()



Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally
	loFiltro = Null
	loImgAdd = Null
	Thisform.LockScreen = .F.


Endtry

ENDPROC
PROCEDURE autosize
Local lcCommand As String
Local lnTop As Integer,;
    lnLeft As Integer,;
    lnWidth As Integer,;
    lnHeight As Integer

Local loFiltro As Filtro Of "FrontEnd\Vcx\informes.vcx",;
    loColFiltros As oColBase Of 'Tools\DataDictionary\prg\oColBase.prg'
Local loImgAdd As Image

Try

    lcCommand = ""

	This.lblFiltro.Top 	= Thisform.nGap
    This.Shape.Top 		= Thisform.nGap * 2
    This.Shape.Left 	= Thisform.nGap
    This.Shape.Width 	= This.Width - ( Thisform.nGap * 2 )

    lnTop 		= This.Shape.Top 	+ ( Thisform.nGap * 2 )
    lnLeft 		= This.Shape.Left 	+ Thisform.nGap
    lnWidth 	= This.Shape.Width 	- ( Thisform.nGap * 2 )
    lnHeight 	= lnTop

    loColFiltros = This.oColFiltros

    If loColFiltros.Count > 0

        For Each loFiltro In loColFiltros
            If loFiltro.Visible
                loFiltro.Top 	= lnTop
                loFiltro.Left 	= lnLeft
                loFiltro.Width 	= lnWidth

                lnTop 	= loFiltro.Top + loFiltro.Height

                lnHeight = lnHeight + loFiltro.Height
            Endif

        Endfor

    Endif

    loImgAdd = This.imgAgregar
    loImgAdd.Top = lnTop
    lnHeight = lnHeight + loImgAdd.Height
    This.Shape.Height = lnHeight - This.Shape.Top + Thisform.nGap
    This.Height = This.Shape.Top + This.Shape.Height + Thisform.nGap

    * Thisform.Shape.Height = lnHeight + ( Thisform.nGap * 2 )

Catch To loErr
    Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
    loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
    loError.cRemark = lcCommand
    loError.Process ( m.loErr )
    Throw loError

Finally


Endtry

Return lnHeight

ENDPROC
PROCEDURE eliminarfiltro
Lparameters oFiltro As Object
Local lcCommand As String,;
	lcName As String
Local lnTop As Integer,;
	lnLeft As Integer,;
	lnHeight As Integer
Local loFiltro As Filtro Of "FrontEnd\Vcx\informes.vcx",;
	loColFiltros As oColBase Of 'Tools\DataDictionary\prg\oColBase.prg'
Local loImgAdd As Image
Local llAutocenter As Boolean

Try

	lcCommand = ""
	llAutocenter = .F.

	loColFiltros = This.oColFiltros

	If loColFiltros.Count > 0

		loFiltro = loColFiltros.Item( 1 )

		lnTop 		= loFiltro.Top
		lnLeft 		= loFiltro.Left
		lnHeight 	= loFiltro.Height

		loFiltro = loColFiltros.RemoveItem( oFiltro.Name )
		This.RemoveObject( oFiltro.Name )


		For Each loFiltro In This.oColFiltros
			If loFiltro.Visible
				loFiltro.Top 	= lnTop
				loFiltro.Left 	= lnLeft

				lnTop 	= loFiltro.Top + loFiltro.Height
				lnLeft 	= loFiltro.Left
			EndIf

		Endfor

*!*			loImgAdd = This.imgAgregar
*!*			loImgAdd.Top = lnTop

		
		ThisForm.Autosize()

	Endif

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = Newobject( 'ErrorHandler', 'Tools\ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE ocolfiltros_access
If Isnull( This.oColFiltros )
	This.oColFiltros = NewObject( "oColBase", 'Tools\DataDictionary\prg\oColBase.prg' )
Endif

Return This.oColFiltros

ENDPROC
PROCEDURE visible_assign
lparameters tVisible
This.Visible = tVisible
This.SetAll( "Visible", tVisible )
ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
4[END RESERVED2]
[START RESERVED3]
_memberdata XML Metadata for customizable properties
ocolfiltros
*visible_assign 
*agregarfiltro 
*eliminarfiltro 
*autosize Specifies if a control is automatically resized to fit its contents.
*ocolfiltros_access 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6FG0ME3VE
[CLASS] shape
[BASECLASS] shape
[OBJNAME] Shape
[PARENT] filtros
[START PROPERTIES]
Top = 24
Left = 12
Height = 60
Width = 696
BackStyle = 0
Curvature = 12
BorderColor = 0,128,255
ZOrderSet = 0
Name = "Shape"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6FG0ME3VG
[CLASS] label
[BASECLASS] label
[OBJNAME] lblFiltro
[PARENT] filtros
[START PROPERTIES]
FontBold = .T.
FontSize = 14
Alignment = 2
Caption = "Filtros"
Height = 25
Left = 36
Top = 12
Width = 72
ForeColor = 0,64,128
Name = "lblFiltro"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6FG0MH6AP
[CLASS] image
[BASECLASS] image
[OBJNAME] imgAgregar
[PARENT] filtros
[START PROPERTIES]
Picture = ..\..\fw\comunes\image\ico\sign-add.ico
Stretch = 1
Height = 24
Left = 672
MousePointer = 15
Top = 48
Width = 24
ToolTipText = "Agregar Filtro"
Name = "imgAgregar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
This.Parent.AgregarFiltro()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] filtros
[EOF]
