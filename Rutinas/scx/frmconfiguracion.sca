SCCTEXT Version 4.0.0.2
PLATFORM C(8,0),UNIQUEID C(10,0),TIMESTAMP N(10,0),CLASS M(4,0),CLASSLOC M(4,0),BASECLASS M(4,0),OBJNAME M(4,0),PARENT M(4,0),PROPERTIES M(4,0),PROTECTED M(4,0),METHODS M(4,0),OBJCODE M(4,0),OLE M(4,0),OLE2 M(4,0),RESERVED1 M(4,0),RESERVED2 M(4,0),RESERVED3 M(4,0),RESERVED4 M(4,0),RESERVED5 M(4,0),RESERVED6 M(4,0),RESERVED7 M(4,0),RESERVED8 M(4,0),USER M(4,0)
1252

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] Screen    
[START RESERVED1]
VERSION =   3.00[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HA15GX0Z
[CLASS] dataenvironment
[BASECLASS] dataenvironment
[OBJNAME] Dataenvironment
[START PROPERTIES]
Top = 0
Left = 0
Width = 0
Height = 0
DataSource = .NULL.
Name = "Dataenvironment"
[END PROPERTIES]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED4]
1[END RESERVED4]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HA15GX10
[CLASS] form
[BASECLASS] form
[OBJNAME] FRMCONFIGURACION
[START PROPERTIES]
Height = 299
Width = 400
ShowWindow = 1
DoCreate = .T.
AutoCenter = .T.
Caption = "Configurar Vista"
WindowType = 1
_memberdata =      431<VFPData><memberdata name="ocolumns" display="oColumns"/><memberdata name="cargarcolumnas" display="CargarColumnas"/><memberdata name="cancelar" display="Cancelar"/><memberdata name="lreturn" display="lReturn"/><memberdata name="selectall" display="SelectAll"/><memberdata name="aceptar" display="Aceptar"/><memberdata name="aplicarcambios" display="AplicarCambios"/><memberdata name="oauxcolumns" display="oAuxColumns"/></VFPData>
ocolumns = .NULL.
lreturn = .F.
oauxcolumns = .NULL.
Name = "FRMCONFIGURACION"
[END PROPERTIES]
[START METHODS]
PROCEDURE Destroy
ThisForm.cntColumnas.ReleaseObjects()
This.oAuxColumns = Null
This.oColumns = Null

ENDPROC
PROCEDURE Init
Lparameters oColumns As Collection
Local lcCommand As String

Try

	lcCommand = ""
	This.lReturn = .F.
	Thisform.oColumns = oColumns

	Thisform.cntColumnas.Top = 0
	Thisform.cntColumnas.Left = 0
	
	Thisform.Width = Thisform.cntColumnas.Width

	This.BorderStyle = 0

	If Vartype( Thisform.oColumns ) == "O"
		Thisform.CargarColumnas()
	Endif




Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )


Finally


Endtry


ENDPROC
PROCEDURE Release
ThisForm.cntColumnas.ReleaseObjects()
DoDefault()
ENDPROC
PROCEDURE Unload
Return This.lReturn
ENDPROCPROCEDURE aceptar

Thisform.AplicarCambios()
Thisform.lReturn = .T.
Thisform.Release()
ENDPROC
PROCEDURE aplicarcambios
Local lcCommand as String
Local loColGridLayout As colGridLayout Of "FW\Comunes\Prg\colGridLayout.prg"
Local loColumn As oGridLayout Of "Fw\comunes\Prg\colGridLayout.Prg"
Local loAuxColumns as PrxCollection Of "Fw\TierAdapter\Comun\PrxBaseLibrary.prg"
Local loDisponibles as ListBox,;
loSeleccionadas as ListBox

Local i as Integer

Try

	lcCommand = ""
	loColGridLayout = Thisform.oColumns
	loAuxColumns = Thisform.oAuxColumns
	
	loDisponibles 	= ThisForm.cntColumnas.SourceList.Dato
	loSeleccionadas = ThisForm.cntColumnas.TargetList.Dato

	
	For i = 1 to loSeleccionadas.ListCount
		loColumn = loAuxColumns.GetItem( loSeleccionadas.List( i ) )
		loColumn.ColumnVisible = .T.
		loColumn.ColumnColumnOrder = i
	EndFor

	For i = 1 to loDisponibles.ListCount
		loColumn = loAuxColumns.GetItem( loDisponibles.List( i ) )
		loColumn.ColumnVisible = .F.
		loColumn.ColumnColumnOrder = i + loSeleccionadas.ListCount
	EndFor

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )

Finally
	loColGridLayout = Null
	
	
EndTry

ENDPROC
PROCEDURE cancelar
Thisform.lReturn = .F.
Thisform.Release()
ENDPROC
PROCEDURE cargarcolumnas
Local lcCommand as String
Local loColGridLayout As colGridLayout Of "FW\Comunes\Prg\colGridLayout.prg"
Local loColumn As oGridLayout Of "Fw\comunes\Prg\colGridLayout.Prg"
Local loDisponibles as ListBox,;
loSeleccionadas as ListBox

Local loAuxColumns as PrxCollection Of "Fw\TierAdapter\Comun\PrxBaseLibrary.prg"
Local loSortedGrid as PrxCollection Of "Fw\TierAdapter\Comun\PrxBaseLibrary.prg"


Try

	lcCommand = ""
	loColGridLayout = Thisform.oColumns
	loAuxColumns = NewObject( "PrxCollection", "Fw\TierAdapter\Comun\PrxBaseLibrary.prg" )
	Thisform.oAuxColumns = loAuxColumns
	
	loSortedGrid = loColGridLayout.SortBy( "ColumnColumnOrder" )
	
	loDisponibles 	= ThisForm.cntColumnas.SourceList.Dato
	loSeleccionadas = ThisForm.cntColumnas.TargetList.Dato
		
	For Each loColumn in loSortedGrid
	
		loAuxColumns.addItem( loColumn, loColumn.HeaderCaption )
		
		If loColumn.ColumnVisible
			loSeleccionadas.AddItem( loColumn.HeaderCaption )
			
		Else
			loDisponibles.AddItem( loColumn.HeaderCaption )
						
		Endif

	EndFor


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	
	
EndTry

ENDPROC
PROCEDURE selectall
Lparameters tlSelect as Boolean

Local i as Integer
Local o as ListBox

Try
	
	o = ThisForm.cntColumnas.SourceList.Dato
	
	For i = 1 to o.ListCount
		o.Selected( i ) = tlSelect
	EndFor
	

Catch To oErr
	Local loError as ErrorHandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally
	o = Null
	
EndTry

ENDPROC
[END METHODS]
[START RESERVED3]
_memberdata XML Metadata for customizable properties
ocolumns
lreturn
oauxcolumns
*cargarcolumnas 
*cancelar 
*selectall 
*aceptar 
*aplicarcambios 
[END RESERVED3]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HA16KK7A
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdAceptar
[PARENT] FRMCONFIGURACION
[START PROPERTIES]
Top = 252
Left = 300
Height = 24
Width = 84
Anchor = 12
Picture = ..\..\..\fw\comunes\image\bmp\ok.bmp
Caption = "Aceptar"
TabIndex = 2
PicturePosition = 1
Name = "cmdAceptar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Aceptar()
Wait Clear

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HA177EBG
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdCancelar
[PARENT] FRMCONFIGURACION
[START PROPERTIES]
Top = 252
Left = 12
Height = 24
Width = 84
Anchor = 6
Picture = ..\..\..\fw\comunes\image\bmp\close.bmp
Cancel = .T.
Caption = "Cerrar"
TabIndex = 5
PicturePosition = 1
Name = "cmdCancelar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Cancelar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HG1153A4
[CLASS] moverlists
[CLASSLOC] ..\..\fw\comunes\vcx\moverlists.vcx
[BASECLASS] container
[OBJNAME] cntColumnas
[PARENT] FRMCONFIGURACION
[START PROPERTIES]
Top = 0
Left = 3
Name = "cntColumnas"
Shape.Name = "Shape"
shpLabel.Name = "shpLabel"
lblTitulo.Caption = "Campos a mostrar"
lblTitulo.Name = "lblTitulo"
SourceList.Label.Caption = "Disponibles"
SourceList.Label.Name = "Label"
SourceList.CheckButton.Name = "CheckButton"
SourceList.Dato.Sorted = .F.
SourceList.Dato.Name = "Dato"
SourceList.Name = "SourceList"
MoverButtons.Shape.Name = "Shape"
MoverButtons.shpLabel.Name = "shpLabel"
MoverButtons.lblTitulo.Name = "lblTitulo"
MoverButtons.addone.Name = "addone"
MoverButtons.addall.Name = "addall"
MoverButtons.removeall.Name = "removeall"
MoverButtons.removeone.Name = "removeone"
MoverButtons.Name = "MoverButtons"
TargetList.Label.Caption = "Seleccionados"
TargetList.Label.Name = "Label"
TargetList.CheckButton.Name = "CheckButton"
TargetList.Dato.MoverBars = .T.
TargetList.Dato.Sorted = .F.
TargetList.Dato.Name = "Dato"
TargetList.Name = "TargetList"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[EOF]
