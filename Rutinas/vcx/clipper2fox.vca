SCCTEXT Version 4.0.0.2
PLATFORM C(8,0),UNIQUEID C(10,0),TIMESTAMP N(10,0),CLASS M(4,0),CLASSLOC M(4,0),BASECLASS M(4,0),OBJNAME M(4,0),PARENT M(4,0),PROPERTIES M(4,0),PROTECTED M(4,0),METHODS M(4,0),OBJCODE M(4,0),OLE M(4,0),OLE2 M(4,0),RESERVED1 M(4,0),RESERVED2 M(4,0),RESERVED3 M(4,0),RESERVED4 M(4,0),RESERVED5 M(4,0),RESERVED6 M(4,0),RESERVED7 M(4,0),RESERVED8 M(4,0),USER M(4,0)
1252

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] Class     
[START RESERVED1]
VERSION =   3.00[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2T10VM7KL
[CLASS] form
[BASECLASS] form
[OBJNAME] frmdisplaywindow
[START PROPERTIES]
BorderStyle = 0
Height = 560
Width = 790
DoCreate = .T.
AutoCenter = .T.
Caption = "Form1"
Closable = .F.
FontName = "Lucida Console"
FontSize = 11
MaxButton = .F.
MinButton = .F.
Themes = .F.
lfirsttime = .T.
_memberdata =      313<VFPData><memberdata name="lfirsttime" display="lFirstTime"/><memberdata name="ccommand" display="cCommand"/><memberdata name="autosize" display="AutoSize"/><memberdata name="nrows" display="nRows"/><memberdata name="ncols" display="nCols"/><memberdata name="lischildprocess" display="lIsChildProcess"/></VFPData>
ccommand = 
nrows = 0
ncols = 0
lischildprocess = .F.
Name = "frmdisplaywindow"
[END PROPERTIES]
[START METHODS]
PROCEDURE Activate
Local lcCommand As String
Local oErr As Exception

If This.lFirstTime
	Try

		lcCommand = ""

		* Inicializar Transaction Handler

		This.lFirstTime = .F.

		lcCommand = This.cCommand

		On Key Label F1 Do Dummy In Rutina
		On Escape prxSetLastKey( Escape )

		SetColor( CL_NORMAL )

		_Screen.oApp.oMemoEdit.lLaunchFrx 	= .T.
		_Screen.oApp.oMemoEdit.cFrxName 	= Getwordnum( Juststem( lcCommand ), 1, ['])

		If !This.lIsChildProcess
			* Inicializar nivel de DrillDown
			SetDrillDownLevel( 0 )
		Endif

		Do &lcCommand

		DoEvents

	Catch To oErr
		Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

		loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )

		Do Case
			Case oErr.ErrorNo = 10
				loError.cRemark = lcCommand

		Endcase

		loError.Process( oErr )

	Finally
		If !This.lIsChildProcess
			Close Databases All
			_Screen.oApp.nDrillDownLevel = 0
		Endif

		prxSetLastKey( 0 )
		Keyboard '{SPACEBAR}'
		Thisform.Release()
		Set Device To Screen
		DoEvents


	Endtry

Endif

ENDPROC
PROCEDURE Init
#INCLUDE "FW\Comunes\Include\Praxis.h"

Lparameters tcCommand As String, lIsChildProcess as Boolean

Local oErr As Exception

Try

	If Empty( tcCommand )
		Error "No se recibió el comando a ejecutar"
	Endif

	Thisform.Icon = _Screen.Icon
	
	This.cCommand 			= tcCommand
	This.lIsChildProcess 	= lIsChildProcess

	_Screen.oApp.nKeyCode = 0
	_Screen.oApp.nShiftAltCtrl = 0
	_Screen.oApp.lCheckLastKey = .T.
	_Screen.oApp.lCancelProcess = .F.

	On Key Label CTRL+F12 _Screen.oApp.lCancelProcess = .T.
	On Key Label CTRL+F10 OnKeyLabel( KEY_CTRL_F10 )
	On Key Label CTRL+F11 Set

	Set Escape On
	On Escape prxSetLastKey( Escape )
	
	This.nCols = 80
	This.nRows = 26
	
	This.AutoSize()


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

Endtry



ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Try

	_Screen.oApp.nKeyCode = nKeyCode
	_Screen.oApp.nShiftAltCtrl = nShiftAltCtrl
	
Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )

Finally
	
Endtry


ENDPROC
PROCEDURE Load
Local lcCommand As String
Local loApp As prxApplication Of "Fw\SysAdmin\Prg\saMain.prg"
Try

	lcCommand = ""
	
	Set Datasession To

	Set Talk Off
	Set Asserts On
	Set Escape Off
	Set Status Bar On
	Set Status Off

	Set Console Off
	Set Confirm On
	Set Exclusive Off
	Set Reprocess To 5 Seconds
	Sys( 3051, 1000 )

	Set Century Off
	Set Century To 19 Rollover 80
	Set Date Dmy
	Set Hours To 24
	Set Deleted On
	Set Multilocks On
	Set Cpdialog Off
	Set TablePrompt Off
	Set ReportBehavior 90
	Set Exact Off
	Set Decimals To 5
	Set NullDisplay To ''
	Set Point To '.'
	Set Separator To '.'
	
	Set Notify Cursor Off
*!*		Set Readborder On

	Set Help Off
	Set Safety Off
	
Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.cRemark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	loApp = Null

Endtry



ENDPROC
PROCEDURE autosize
#INCLUDE "FW\Comunes\Include\Praxis.h"

Local oErr As Exception
Local lnTop As Integer
Local lnGap As Integer
Local loFont as Object


Try

	lnGap = 02

	If Pemstatus( _Screen, "oApp", 5 )
		If PemStatus( _Screen.oApp, "oColFonts", 5 )
			loFont = _Screen.oApp.oColFonts.Item( "screen" )

			This.FontName = loFont.FontName
			This.FontSize = loFont.FontSize

		Else
			This.FontName = oApp.FontName
			This.FontSize = oApp.FontSize

		Endif

	Endif

	This.Width = This.TextWidth( Replicate( "X", This.nCols ))
	This.Height = This.TextHeight( "X" ) * This.nRows

	If _Screen.oApp.lFitToForm
		This.AutoCenter = .F.
		This.Left 		= 0
		This.Top 		= 0
		This.TitleBar 	= 0

		_Screen.Width 	= Thisform.Width
		_Screen.Height 	= Thisform.Height
		
	Else
		This.AutoCenter = .T.	
		
		* Verificar que se encuentra dentro de _Screen
		If Thisform.Left + Thisform.Width > _Screen.Width
			Thisform.Left = _Screen.Width - Thisform.Width
		EndIf
		
		If Thisform.Left < 0
			Thisform.Left = 0
			_Screen.Width = Thisform.Width
		EndIf

		If Thisform.Top + Thisform.Height + WINDOWTITLEHEIGHT > _Screen.Height
			Thisform.Top = _Screen.Height - Thisform.Height - WINDOWTITLEHEIGHT
		EndIf
		
		If Thisform.Top < 0
			Thisform.Top = 0
			_Screen.Height = Thisform.Height + WINDOWTITLEHEIGHT
		EndIf

		
	EndIf
	
	Thisform.cntMessages.Label23.FontSize 	= Thisform.FontSize
	Thisform.cntMessages.Label24.FontSize 	= Thisform.FontSize
	Thisform.cntTitulo.lblFecha.FontSize 	= Thisform.FontSize
	Thisform.cntTitulo.lblTitulo.FontSize 	= Thisform.FontSize
	Thisform.cntTitulo.Label1.FontSize 		= Thisform.FontSize
	Thisform.cntTitulo.LblObservaciones.FontSize 	= Thisform.FontSize

	Thisform.cntMessages.Label23.Height = Int( Thisform.TextHeight( "[Xp]" ) * 1.25 )
	Thisform.cntMessages.Label24.Height = Int( Thisform.TextHeight( "[Xp]" ) * 1.25 )
	Thisform.cntTitulo.lblFecha.Height 	= Int( Thisform.TextHeight( "[Xp]" ) * 1.15 )
	Thisform.cntTitulo.lblTitulo.Height = Int( Thisform.TextHeight( "[Xp]" ) * 1.15 )
	Thisform.cntTitulo.Label1.Height 	= Int( Thisform.TextHeight( "[Xp]" ) * 1.15 )
	Thisform.cntTitulo.LblObservaciones.Height = Int( Thisform.TextHeight( "[Xp]" ) * 1.15 )

	Thisform.cntMessages.Height = ( lnGap * 3 ) + Thisform.cntMessages.Label23.Height + Thisform.cntMessages.Label24.Height
	Thisform.cntTitulo.Height 	= Thisform.cntTitulo.lblFecha.Height + 06

	Thisform.cntMessages.Label23.Top = lnGap
	Thisform.cntMessages.Label24.Top = Thisform.cntMessages.Label23.Top + Thisform.cntMessages.Label23.Height + lnGap

	Thisform.cntMessages.Top 	= Thisform.Height - Thisform.cntMessages.Height - 02
	Thisform.cntTitulo.Top 		= 0

	Thisform.cntMessages.Width 			= Thisform.Width - 10
	Thisform.cntMessages.Label23.Width 	= Thisform.Width
	Thisform.cntMessages.Label24.Width 	= Thisform.Width

	Thisform.cntTitulo.Width = Thisform.Width

	Thisform.cntMessages.Label23.Left 	= 0
	Thisform.cntMessages.Label24.Left 	= 0
	Thisform.cntTitulo.Left 			= 0
	Thisform.cntMessages.Left 			= 05

	Thisform.cntMessages.Label23.Caption 			= ""
	Thisform.cntMessages.Label24.Caption 			= ""
	Thisform.cntTitulo.lblFecha.Caption 			= ""
	Thisform.cntTitulo.lblTitulo.Caption 			= ""
	Thisform.cntTitulo.Label1.Caption 				= ""
	Thisform.cntTitulo.lblObservaciones.Caption 	= ""

	Thisform.cntTitulo.lblFecha.AutoSize 	= .T.
	Thisform.cntTitulo.lblTitulo.AutoSize 	= .T.
	Thisform.cntTitulo.Label1.AutoSize 		= .T.
	Thisform.cntTitulo.lblObservaciones.AutoSize 	= .T.

	Thisform.Refresh()


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally
	loFont = Null

Endtry



ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
12[END RESERVED2]
[START RESERVED3]
lfirsttime
_memberdata XML Metadata for customizable properties
ccommand
nrows
ncols
lischildprocess
*autosize Specifies if a control is automatically resized to fit its contents.
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2UV13WAXY
[CLASS] label
[BASECLASS] label
[OBJNAME] Label21
[PARENT] frmdisplaywindow
[START PROPERTIES]
FontBold = .T.
Alignment = 2
Caption = "Label21"
Height = 17
Left = 0
Top = -100
Visible = .F.
Width = 750
Name = "Label21"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2WM170R2H
[CLASS] label
[BASECLASS] label
[OBJNAME] Label22
[PARENT] frmdisplaywindow
[START PROPERTIES]
FontBold = .T.
Alignment = 2
Caption = "Label22"
Height = 17
Left = 0
Top = -100
Visible = .F.
Width = 750
ForeColor = 255,0,0
Name = "Label22"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2WU0ND996
[CLASS] container
[BASECLASS] container
[OBJNAME] cntTitulo
[PARENT] frmdisplaywindow
[START PROPERTIES]
Top = 3
Left = 12
Width = 756
Height = 36
BorderWidth = 3
SpecialEffect = 0
Name = "cntTitulo"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
#INCLUDE "FW\Comunes\Include\Praxis.h"

This.lblFecha.Top = 02
This.lblFecha.Left = This.Width - This.lblFecha.Width - 05

This.lblFecha.Anchor = ANCHOR_Top_Absolute +;
	ANCHOR_Right_Absolute


This.lblTitulo.Left = 05
This.lblTitulo.Top = 02
This.lblTitulo.Anchor = ANCHOR_Top_Absolute +;
	ANCHOR_Left_Absolute

This.LblObservaciones.Left = 05
This.LblObservaciones.Top = 02
This.LblObservaciones.Anchor = ANCHOR_Top_Absolute +;
	ANCHOR_Left_Absolute

*!*	#DEFINE ANCHOR_Top_Left 				000
*!*	#DEFINE ANCHOR_Top_Absolute 			001
*!*	#DEFINE ANCHOR_Left_Absolute 			002
*!*	#DEFINE ANCHOR_Bottom_Absolute 			004
*!*	#DEFINE ANCHOR_Right_Absolute 			008
*!*	#DEFINE ANCHOR_Top_Relative 			016
*!*	#DEFINE ANCHOR_Left_Relative 			032
*!*	#DEFINE ANCHOR_Bottom_Relative 			064
*!*	#DEFINE ANCHOR_Right_Relative 			128
*!*	#DEFINE ANCHOR_Horizontal_Fixed_Size 	256
*!*	#DEFINE ANCHOR_Vertical_Fixed_Size 		512

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2UV13WAXY
[CLASS] label
[BASECLASS] label
[OBJNAME] lblFecha
[PARENT] frmdisplaywindow.cntTitulo
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Anchor = 8
Alignment = 1
BackStyle = 0
Caption = "Fecha"
Height = 22
Left = 612
Top = 3
Width = 146
ForeColor = 0,0,255
Name = "lblFecha"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _37Z0XL3ZH
[CLASS] label
[BASECLASS] label
[OBJNAME] lblTitulo
[PARENT] frmdisplaywindow.cntTitulo
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Alignment = 0
BackStyle = 0
Caption = "Título del programa"
Height = 22
Left = 6
Top = 7
Width = 198
ForeColor = 0,0,255
Name = "lblTitulo"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2X70Q8T75
[CLASS] label
[BASECLASS] label
[OBJNAME] Label1
[PARENT] frmdisplaywindow.cntTitulo
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Alignment = 1
BackStyle = 0
Caption = ""
Height = 22
Left = 540
Top = 5
Width = 34
ForeColor = 0,0,255
Name = "Label1"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3XW0OLHGX
[CLASS] label
[BASECLASS] label
[OBJNAME] lblObservaciones
[PARENT] frmdisplaywindow.cntTitulo
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Alignment = 0
BackStyle = 0
Caption = "Observaciones"
Height = 22
Left = 216
Top = 7
Width = 198
ForeColor = 0,0,255
Name = "lblObservaciones"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2WU0ZQ85U
[CLASS] container
[BASECLASS] container
[OBJNAME] cntMessages
[PARENT] frmdisplaywindow
[START PROPERTIES]
Top = 480
Left = 12
Width = 768
Height = 72
BorderWidth = 3
SpecialEffect = 0
Name = "cntMessages"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _37Z0XL3ZH
[CLASS] label
[BASECLASS] label
[OBJNAME] Label23
[PARENT] frmdisplaywindow.cntMessages
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Alignment = 2
BackStyle = 0
Caption = "Label23"
Left = 8
Top = 8
Width = 750
ForeColor = 0,128,64
Name = "Label23"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _37Z0XL3ZH
[CLASS] label
[BASECLASS] label
[OBJNAME] Label24
[PARENT] frmdisplaywindow.cntMessages
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Alignment = 2
BackStyle = 0
Caption = "Label24"
Height = 17
Left = 8
Top = 44
Width = 750
ForeColor = 0,0,255
Name = "Label24"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _51E0PSSRH
[CLASS] label
[BASECLASS] label
[OBJNAME] lblNavegar
[PARENT] frmdisplaywindow.cntMessages
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Alignment = 2
BackStyle = 0
Caption = "Navegar"
Left = 8
Top = 78
Width = 750
ForeColor = 0,128,64
Name = "lblNavegar"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] frmdisplaywindow
[START PROPERTIES]
Lucida Console, 0, 11, 9, 15, 12, 9, 3, 0
[END PROPERTIES]
[START RESERVED1]
 ! ..\..\fw\comunes\include\praxis.h}s~\V! ..\..\fw\comunes\include\foxpro.h~ÊrûF" ..\..\fw\comunes\include\strings.hZŠOJ' ..\..\tools\namespaces\include\system.h&€±ÙF[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53D5
[CLASS] form
[BASECLASS] form
[OBJNAME] frmindexa
[START PROPERTIES]
BorderStyle = 0
Height = 432
Width = 396
DoCreate = .T.
AutoCenter = .T.
Caption = "Reordenamiento de Archivos"
WindowType = 1
_memberdata =     1591<VFPData><memberdata name="cancelar" display="Cancelar"/><memberdata name="cargararchivos" display="CargarArchivos"/><memberdata name="process" display="Process"/><memberdata name="nopcion" display="nOpcion"/><memberdata name="reset" display="Reset"/><memberdata name="ccursorname" display="cCursorName"/><memberdata name="nfirst" display="nFirst"/><memberdata name="nsecond" display="nSecond"/><memberdata name="assigningtip" display="AssignIngtip"/><memberdata name="cstatus" display="cStatus"/><memberdata name="pack" display="Pack"/><memberdata name="comprimir" display="Comprimir"/><memberdata name="globalselection" display="GlobalSelection"/><memberdata name="hookbeforecargararchivos" display="HookBeforeCargarArchivos"/><memberdata name="hookaftercargararchivos" display="HookAfterCargarArchivos"/><memberdata name="wclav" display="WCLAV"/><memberdata name="wclav_assign" display="WCLAV_Assign"/><memberdata name="lingtip" display="lIngTip"/><memberdata name="lingtipactivo" display="lIngTipActivo"/><memberdata name="lingtipactivo_assign" display="lIngTipActivo_Assign"/><memberdata name="loldkeypreview" display="lOldKeyPreview"/><memberdata name="ningtip1" display="nIngTip1"/><memberdata name="ningtip2" display="nIngTip2"/><memberdata name="ningtipaction" display="nIngTipAction"/><memberdata name="ningtipstatus" display="nIngTipStatus"/><memberdata name="synchronizebuttons" display="SynchronizeButtons"/><memberdata name="i_ingtip" display="I_IngTip"/><memberdata name="ordenarpor" display="OrdenarPor"/><memberdata name="verificarcampo" display="VerificarCampo"/></VFPData>
nopcion = 1
ccursorname = 
nfirst = 0
nsecond = 0
cstatus = 
wclav = A
lingtip = .T.
lingtipactivo = .F.
loldkeypreview = .F.
ningtip1 = -8
ningtip2 = -9
ningtipaction = 2
ningtipstatus = 0
Name = "frmindexa"
[END PROPERTIES]
[START METHODS]
PROCEDURE Destroy
Set Sysmenu Automatic
ENDPROC
PROCEDURE Init
#INCLUDE "FW\Comunes\Include\Praxis.h"

Local llOk As Boolean
Try

	Set Sysmenu Off

	llOk = .T.

	*!*		If CLAVE = 0
	*!*			Thisform.cStatus = "A"
	*!*
	*!*		Else
	*!*			Thisform.cStatus = "M"
	*!*
	*!*		Endif


	This.AutoCenter = .T.

	* Verificar que se encuentra dentro de _Screen
	If Thisform.Left + Thisform.Width > _Screen.Width
		Thisform.Left = _Screen.Width - Thisform.Width
	Endif

	If Thisform.Left < 0
		Thisform.Left = 0
		_Screen.Width = Thisform.Width
	Endif

	If Thisform.Top + Thisform.Height + WINDOWTITLEHEIGHT > _Screen.Height
		Thisform.Top = _Screen.Height - Thisform.Height - WINDOWTITLEHEIGHT
	Endif

	If Thisform.Top < 0
		Thisform.Top = 0
		_Screen.Height = Thisform.Height + WINDOWTITLEHEIGHT
	Endif



	Thisform.Icon = _Screen.Icon

	Thisform.cmdAceptar.Enabled = .F.
	Thisform.chkGlobal.Enabled 	= .F.
	Thisform.nOpcion 			= Thisform.OptionGroup.Value
	Thisform.cmdAceptar.SetFocus()

	Thisform.grdArchivos.Archivos.DynamicFontBold = 'Evaluate( Thisform.cCursorName + ".TIPOTR" )'

	If This.lIngTip = .T. And CLAVE > 0
		Thisform.I_IngTip()

	Else
		Thisform.lOldKeyPreview = Thisform.KeyPreview
		Thisform.WCLAV = "A"

	Endif

	Thisform.cStatus = Thisform.WCLAV


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	llOk = .F.
	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )

Finally
	Use In Select( "cTemp" )

Endtry

Return llOk






ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl
Local lcCommand As String

Try

	lcCommand = ""
		
	If Thisform.lIngTipActivo
		If Inlist( nKeyCode, Thisform.nIngTip1, Thisform.nIngTip2 )
		
		
			*Wait WINDOW noclear nowait "Se apreto " + Transform( nKeyCode )
			Do Case
				Case Thisform.nIngTipStatus = 0	&& h00
					* Es la primer Tecla presionada
					If nKeyCode = Thisform.nIngTip1
						Thisform.nIngTipStatus = 2	&&	h10

					Else
						Thisform.nIngTipStatus = 1	&&	h01

						If Thisform.nIngTipAction = 1
							* Solo vale la primer tecla presionada primero
							* Limpiar buffer de IngTip
							Thisform.nIngTipStatus = 0

						Endif

					Endif

				Case Thisform.nIngTipStatus = 1	&& h01

					If nKeyCode = Thisform.nIngTip1
						* Se completo el orden Segunda + Primera

						Thisform.WCLAV = "M"
						Thisform.lIngTipActivo = .F.

					Else
						* Se presiono 2 veces la Segunda
						* Limpiar buffer de IngTip
						Thisform.nIngTipStatus = 0

					Endif

				Case Thisform.nIngTipStatus = 2	&& h10
					If nKeyCode = Thisform.nIngTip2
						* Se completo el orden Primera + Segunda

						Thisform.WCLAV = "B"
						Thisform.lIngTipActivo = .F.

					Else
						* Se presiono 2 veces la Primera
						* Limpiar buffer de IngTip
						Thisform.nIngTipStatus = 0

					Endif

			Endcase

		Else
			* Limpiar buffer de IngTip
			Thisform.nIngTipStatus = 0	&& h00
			*Wait WINDOW noclear nowait "Se apreto " + Transform( nKeyCode )

		Endif

	Endif

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.cRemark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE Load
Close Databases all
ENDPROC
PROCEDURE assigningtip
Try

	Do Case
		Case Thisform.nFirst = F9
			Thisform.cStatus = "B"

			Thisform.cmdCancelar.FontBold = .T.
			Thisform.CmdAceptar.FontBold = .T.


		Case Thisform.nFirst = F10
			Thisform.cStatus = "M"

			Thisform.cmdCancelar.FontBold = .T.
			Thisform.CmdAceptar.FontBold = .T.

			Thisform.cmdCancelar.FontItalic = .T.
			Thisform.CmdAceptar.FontItalic = .T.

		Otherwise
			Thisform.cStatus = "A"

	Endcase


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

Endtry

ENDPROC
PROCEDURE cancelar
Use in Select( Thisform.cCursorName )
Thisform.Release()
ENDPROC
PROCEDURE cargararchivos
Local lcAlias As String


Try

	Thisform.OptionGroup.Enabled = .F.

	* Cargar Archivos
	If Vartype( DRMIN ) # "L"
		DRMIN = .T.
	Endif

	lcAlias = Sys( 2015 )
	Thisform.cCursorName = lcAlias

	Thisform.grdArchivos.Archivos.ControlSource = ""
	Thisform.grdArchivos.Seleccion.ControlSource = ""
	Thisform.grdArchivos.RecordSource = ""

	Create Cursor ( lcAlias ) ( DESCTR C (60), TIPOTR L, NOMBTR C (8) )

	Appe Blan
	Repl NOMBTR With "AR1ART",;
		DESCTR With "ARCHIVO DE ARTICULOS"

	If GetValue( "UsaLinea", "ar0Art", "N" ) == "S"
		Appe Blan
		Repl NOMBTR With "AR3LIN",;
			DESCTR With "ARCHIVO DE LINEAS DE ARTICULOS"
	Endif

	Appe Blan
	Repl NOMBTR With "AR4VAR",;
		DESCTR With "ARCHIVO DE PROV\CLIE\VEND\TARJ"

	WARCH=Trim(DRCOMUN)+"AR4IIBB.dbf"

	If FileExist( WARCH )
		Appe Blan
		Repl NOMBTR With "AR4iibb",;
			DESCTR With "Archivo de INSCRIPTOS EN INGRESOS BRUTOS"

	Endif



	If ( GetValue( "Stock", "ar0Stk", "N" ) == "S" )
		WARCH=Trim(DRCOMUN)+'AR4Depo'
		If FileExist( WARCH + ".Dbf" )
			Appe Blan
			Repl NOMBTR With "AR4Depo",;
				DESCTR With "Archivo de DEPOSITOS"
		Endif
	Endif

	WARCH=Trim(DRVA)+"Cortes.dbf"
	If FileExist( WARCH )
		Appe Blan
		Repl NOMBTR With "Cortes",;
			DESCTR With "ARCHIVO DE CORTES"
	Endif

	Appe Blan
	Repl NOMBTR With "AR7VEN",;
		DESCTR With "ARCHIVO DE VENTAS"

	Appe Blan
	Repl NOMBTR With "AR9ITE",;
		DESCTR With "ARCHIVO DE ITEMS"

	WARCH=Trim(DRVA)+"AR7PRO.dbf"
	If FileExist( WARCH )

		Appe Blan
		Repl NOMBTR With "AR7PRO",;
			DESCTR With "ARCHIVO DE PROFORMAS (CABECERA)"

		Appe Blan
		Repl NOMBTR With "AR9PRO",;
			DESCTR With "ARCHIVO DE PROFORMAS (ITEMS)"
	Endif


	If FileExist( Trim(DRVA)+'ar7Des.Dbf' )
		Appe Blan
		Repl NOMBTR With "AR7DES",;
			DESCTR With "ARCHIVO DE DESPACHOS"
	Endif

	Appe Blan
	Repl NOMBTR With "AR12APD",;
		DESCTR With "ARCHIVO DE APLICACIONES DE DEUDAS"
	Appe Blan
	Repl NOMBTR With "AR2GRU",;
		DESCTR With "ARCHIVO DE GRUPOS"

	Appe Blan
	Repl NOMBTR With "AR10VAL",;
		DESCTR With "ARCHIVO DE VALORES"

	If FileExist( Trim(DRVA)+'AR2COL.Dbf' )
		Appe Blan
		Repl NOMBTR With "AR2COL",;
			DESCTR With "ARCHIVO DE COLORES"

	Endif

	If FileExist( Trim(DRVA)+'AR10CAJ.Dbf' ) Or ;
			FileExist( Trim(DRVA)+'AR9CAJ.Dbf' )

		Appe Blan
		Repl NOMBTR With "AR10CAJ",;
			DESCTR With "ARCHIVO DE CAJAS"

	Endif


	If FileExist( Trim(DRVA)+'AR7REM.Dbf' )
		Appe Blan
		Repl NOMBTR With "AR7REM",;
			DESCTR With "ARCHIVO DE REMITOS"

		Appe Blan
		Repl NOMBTR With "AR9REM",;
			DESCTR With "ARCHIVO DE ITEMS DE REMITOS"
	Endif

	Appe Blan
	Repl NOMBTR With "AR0PRN",;
		DESCTR With "ARCHIVO DE COLAS DE IMPRESION"



	Appe Blan
	Repl NOMBTR With "AR7COM",;
		DESCTR With "ARCHIVO DE COMPRAS"

	Appe Blan
	Repl NOMBTR With "AR12APC",;
		DESCTR With "ARCHIVO DE APLICACIONES DE CREDITOS"
	Appe Blan
	Repl NOMBTR With "AR12RET",;
		DESCTR With "Archivo de APLICACIONES DE RETENCIONES"


	*!*				Appe Blan
	*!*				Repl NOMBTR With "AR4PLA",;
	*!*					DESCTR With "ARCHIVO DE PLAZOS FIJOS/GASTOS"

	*!*				Appe Blan
	*!*				Repl NOMBTR With "AR7PLA",;
	*!*					DESCTR With "ARCHIVO DE PLANILLAS"



	If FileExist( Trim(drvPed)+'AR15PED.Dbf' )


		Appe Blan
		Repl NOMBTR With "AR15PED",;
			DESCTR With "ARCHIVO DE PEDIDOS"

		*!*			Appe Blan
		*!*			Repl NOMBTR With "AR12APP",;
		*!*				DESCTR With "ARCHIVO DE APLICACIONES DE PEDIDOS"

	Endif

	If FileExist( Trim(drvPed)+'AR7Ped.dbf' )

		If ( GetValue( "Pedidos", "ar0Ped", "N" ) == "S" )
			Appe Blan
			Repl NOMBTR With "AR7PED",;
				DESCTR With "ARCHIVO DE PEDIDOS (CABECERA)"

			Appe Blan
			Repl NOMBTR With "AR9PED",;
				DESCTR With "ARCHIVO DE PEDIDOS (ITEMS)"

			Appe Blan
			Repl NOMBTR With "AR12APP",;
				DESCTR With "ARCHIVO DE APLICACIONES DE PEDIDOS"

		Endif
	Endif


	If ( GetValue( "UsaPresup", "ar0Presu", "N" ) == "S" )

		Do Case
			Case FileExist( Trim(DRVA)+'AR7Presu.dbf' )

				If ( GetValue( "UsaPresup", "ar0Presu", "N" ) == "S" )
					Appe Blan
					Repl NOMBTR With "AR7Presu",;
						DESCTR With "ARCHIVO DE PRESUPUESTOS (CABECERA)"

					Appe Blan
					Repl NOMBTR With "AR9Presu",;
						DESCTR With "ARCHIVO DE PRESUPUESTOS (ITEMS)"
				Endif

			Case FileExist( Trim(DRVA)+'AR7PRE.dbf' )

				Appe Blan
				Repl NOMBTR With "AR7PRE",;
					DESCTR With "ARCHIVO DE PRESUPUESTOS (CABECERA)"

				Appe Blan
				Repl NOMBTR With "AR9IPR",;
					DESCTR With "ARCHIVO DE PRESUPUESTOS (ITEMS)"

		Endcase
	Endif

	Appe Blan
	Repl NOMBTR With "AR12APR",;
		DESCTR With "ARCHIVO DE REMITOS/FACTURAS"
		
		
	If FileExist( Trim(drComun)+'Impresoras.dbf' )
		Local loImpresora As Impresora Of 'Fw\Comunes\Prg\Impresora.prg'
		
		*loImpresora = GetEntity( "Impresora" )
		loImpresora = NewObject( "Impresora", 'Fw\Comunes\Prg\Impresora.prg' )
		loImpresora.ValidarTabla()
		loImpresora = Null 		
	
	EndIf

	Update ( lcAlias ) Set TIPOTR = .F.
	
	Select Alias( lcAlias )

	Locate


	Thisform.grdArchivos.Archivos.ControlSource = lcAlias + ".DESCTR"
	Thisform.grdArchivos.Seleccion.ControlSource = lcAlias + ".TIPOTR"
	Thisform.grdArchivos.RecordSource = lcAlias

	Thisform.grdArchivos.Refresh()


	* Habilitar Boton
	Thisform.cmdAceptar.Enabled = .T.


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Thisform.Reset()

Finally
	loImpresora = Null

Endtry

ENDPROC
PROCEDURE comprimir
Lparameters lcFileName as String

Try

	If ThisForm.chkPack.Value
		Wait Window 'Comprimiendo &lcFileName.....' Nowait	
		Pack
	EndIf
	

Catch To oErr
	Local loError as ErrorHandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

ENDPROC
PROCEDURE globalselection
Lparameters tlSelection as Boolean

Try

	Select Alias( Thisform.cCursorName )
	
	Replace All TIPOTR with tlSelection
	Go Top
	ThisForm.grdArchivos.Refresh()
	

Catch To oErr
	Local loError as ErrorHandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

ENDPROC
PROCEDURE hookaftercargararchivos
* Habilitar Boton

Thisform.cmdAceptar.Enabled = .T.
Thisform.chkGlobal.Enabled = .T.

ENDPROC
PROCEDURE i_ingtip
Local lcCommand as String
Local llOldKeyPreview as Boolean
Try

	lcCommand = ""
	If Thisform.lIngTip
		Thisform.lIngTipActivo = .T.
	EndIf

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.cRemark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	
	
EndTry

ENDPROC
PROCEDURE lingtipactivo_assign
Lparameters tlIngTipActivo


Thisform.lIngTipActivo = tlIngTipActivo

If tlIngTipActivo
	Thisform.lOldKeyPreview = Thisform.KeyPreview
	Thisform.KeyPreview = .T.

Else
	Thisform.KeyPreview = Thisform.lOldKeyPreview

	With Thisform.cmdAceptar As CommandButton
		.Caption = "\<Aceptar"
		.PicturePosition = 1
		.AutoSize = .T.
		.Width =Thisform.CmdCancelar.Width
		.Left = Thisform.Width - .Width - 12
	Endwith

Endif

Thisform.SynchronizeButtons( "S" )


ENDPROC
PROCEDURE ordenarpor
Lparameters cFieldName As String,;
	cSQLCommand As String

Local lcCommand As String
Local lnReturn as Integer

Try

	lcCommand = ""
	lnReturn = 0
	
	If Vartype( cSQLCommand ) # "C"
		cSQLCommand = ""
	Endif

	If Vartype( cFieldName ) = "C"

		Do Case
			Case Upper( cFieldName ) = "ID"
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Index On Id Tag Id Candidate For !Deleted() And !Empty( Id )
					ENDTEXT

					&lcCommand

				Catch To oErr
					If Empty( Field( "Id" ) )
						Try

							TEXT To lcCommand NoShow TextMerge Pretext 15
							Alter Table <<Alias()>> Add	Column Id I
							ENDTEXT

							&lcCommand
							
							If !Empty( cSQLCommand )
								lcCommand = cSQLCommand
								&cSQLCommand
								
							Else
								Text To lcCommand NoShow TextMerge Pretext 15
								Update <<Alias()>> Set Id = Recno()
								EndText

								&lcCommand
	
							Endif

							TEXT To lcCommand NoShow TextMerge Pretext 15
							Index On Id Tag Id Candidate For !Deleted() And !Empty( Id )
							ENDTEXT

							&lcCommand


						Catch To oErr
							Logerror( oErr.Message,;
								Lineno(1),;
								Alias() + " - " + lcCommand )

						Finally

						Endtry

					Else
						If oErr.ErrorNo = 1884 && Uniqueness of index ARTPK is violated.
							Index On Id Tag Id For !Deleted() And !Empty( Id )
						EndIf
						
						Logerror( oErr.Message,;
							Lineno(1),;
							Alias() + " - " + lcCommand )

					Endif

				Finally

				Endtry

			Case Upper( cFieldName ) = "TS"
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Index On TS Tag TS
					ENDTEXT

					&lcCommand

				Catch To oErr
					If Empty( Field( "TS" ) )
						Try

							TEXT To lcCommand NoShow TextMerge Pretext 15
							Alter Table <<Alias()>> Add	Column TS T
							ENDTEXT

							&lcCommand

							If !Empty( cSQLCommand )
								lcCommand = cSQLCommand
								&cSQLCommand
							Endif

							TEXT To lcCommand NoShow TextMerge Pretext 15
							Index On TS Tag TS
							ENDTEXT

							&lcCommand


						Catch To oErr
							Logerror( oErr.Message,;
								Lineno(1),;
								Alias() + " - " + lcCommand )

						Finally

						Endtry

					Else
						Logerror( oErr.Message,;
							Lineno(1),;
							Alias() + " - " + lcCommand )

					Endif

				Finally

				Endtry
			
			Case Upper( cFieldName ) = "UTS"
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Index On UTS Tag UTS
					ENDTEXT

					&lcCommand

				Catch To oErr
					If Empty( Field( "UTS" ) )
						Try

							TEXT To lcCommand NoShow TextMerge Pretext 15
							Alter Table <<Alias()>> Add	Column UTS T
							ENDTEXT

							&lcCommand

							If !Empty( cSQLCommand )
							
								If Upper( cSQLCommand ) = "DEFAULT"

									Text To cSQLCommand NoShow TextMerge Pretext 15
									Update <<Alias()>> Set
											UTS = TS
										Where Empty( UTS )
									EndText

								Endif


								lcCommand = cSQLCommand
								&cSQLCommand
							Endif

							TEXT To lcCommand NoShow TextMerge Pretext 15
							Index On UTS Tag UTS
							ENDTEXT

							&lcCommand


						Catch To oErr
							Logerror( oErr.Message,;
								Lineno(1),;
								Alias() + " - " + lcCommand )

						Finally

						Endtry

					Else
						Logerror( oErr.Message,;
							Lineno(1),;
							Alias() + " - " + lcCommand )

					Endif

				Finally

				Endtry

			Case Upper( cFieldName ) = "TRANID"
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Index On TranId Tag TranId
					ENDTEXT

					&lcCommand

				Catch To oErr
					If Empty( Field( "TranId" ) )
						Try

							TEXT To lcCommand NoShow TextMerge Pretext 15
							Alter Table <<Alias()>> Add	Column TranId I
							ENDTEXT

							&lcCommand

							If !Empty( cSQLCommand )
								lcCommand = cSQLCommand
								&cSQLCommand
							Endif

							TEXT To lcCommand NoShow TextMerge Pretext 15
							Index On TranId Tag TranId
							ENDTEXT

							&lcCommand


						Catch To oErr
							Logerror( oErr.Message,;
								Lineno(1),;
								Alias() + " - " + lcCommand )

						Finally

						Endtry

					Else
						Logerror( oErr.Message,;
							Lineno(1),;
							Alias() + " - " + lcCommand )

					Endif

				Finally

				Endtry

			Case Upper( cFieldName ) = "ART_ID"
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Index On Art_Id Tag Art_Id
					ENDTEXT

					&lcCommand

				Catch To oErr
				
					lnReturn = -1
					
					If Empty( Field( "Art_Id" ) )
						Try

							TEXT To lcCommand NoShow TextMerge Pretext 15
							Alter Table <<Alias()>> Add	Column Art_Id I
							ENDTEXT

							&lcCommand

							If !Empty( cSQLCommand )
								lcCommand = cSQLCommand
								&cSQLCommand
							Endif

							TEXT To lcCommand NoShow TextMerge Pretext 15
							Index On Art_Id Tag Art_Id
							ENDTEXT

							&lcCommand
							
							lnReturn = 1


						Catch To oErr
							Logerror( oErr.Message,;
								Lineno(1),;
								Alias() + " - " + lcCommand )

						Finally

						Endtry

					Else
						Logerror( oErr.Message,;
							Lineno(1),;
							Alias() + " - " + lcCommand )

					Endif

				Finally

				Endtry

		Endcase
	Endif

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = _NewObject ( 'ErrorHandler', 'ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

Return lnReturn
ENDPROC
PROCEDURE process
#INCLUDE "FW\Comunes\Include\Praxis.h"

Local WCLAV As Character
Local WPACK As Boolean
Local lcCommand As stArchivo Of "Fw\Tieradapter\Servicetier\stArchivo.prg"
Local loArticulo As Articulo Of "Clientes\Archivos\Prg\Articulo.prg"

Try

	WCLAV = Iif( Empty( Thisform.cStatus ), "A", Upper( Thisform.cStatus ) )
	WPACK = Thisform.chkPack.Value

	Select Alias( Thisform.cCursorName )

	Go Top
	Do While !Eof()
		cNOMB = Alltrim( NOMBTR )
		Store "" To c&cNOMB

		If TIPOTR = .T.
			c&cNOMB = Alltrim( DESCTR )
		Endif

		Skip
	Enddo

	Select 0

	loArticulo = NewArticulo()



	If Type('cAR2GRU')="C"
		If !Empty( cAR2GRU ) .And. !&ABORTA
			WARCH=Trim(DrComun)+"AR2GRU"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Thisform.Comprimir( cAR2GRU )
				Wait Window 'REORDENANDO ARCHIVO DE GRUPOS' Nowait

				Inde On CODI2 To '&WARCH.1'
				Inde On Uppe(DESC2) To '&WARCH.2'

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS" )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

				Try

					Inde On Uppe( CODI2 ) Tag CODI2 Candidate For !Deleted()

				Catch To oErr

					If oErr.ErrorNo = 1884 && Uniqueness of index ARTPK is violated.
						Index On Uppe( CODI2 ) Tag CODI2

					Else
						Throw oErr

					Endif
				Finally

				Endtry

				Inde On Uppe( DESC2 ) Tag DESC2

			Endif


		Endif
	Endif


	Do Case
		Case Type('cAR3LIN')="C"
			Do Case
				Case !Empty(cAR3LIN) .And. !&ABORTA
					WARCH=Trim(DrComun)+"AR3LIN"
					WIND1=Trim(DrComun)+'AR3LIN1'
					WIND2=Trim(DrComun)+'AR3LIN2'

					Do Case
						Case M_FILE(0,.T.,.T.,'U',WARCH,.T.)
							Delete Tag All
							Delete For Empty( RUBR3 ) And Empty( Codi3 )
							Thisform.Comprimir( cAR3LIN )
							Wait Window 'REORDENANDO ARCHIVO DE LINEAS....' Nowait

							If Vartype( RUBR3 ) # "C"
								Inde On Str(RUBR3,3)+Str(Codi3,2) To '&WIND1'

								Try

									Index On Str(RUBR3,3)+Str(Codi3,2) Tag LinPK Candidate For !Deleted()

								Catch To oErr

									If oErr.ErrorNo = 1884 && Uniqueness of index ARTPK is violated.
										Index On Str(RUBR3,3)+Str(Codi3,2) Tag LinPK
										Logerror( oErr.Message,;
											Lineno(1),;
											Alias() + " - Index On Str(RUBR3,3)+Str(CODI3,2) "  )


									Else
										Throw oErr

									Endif
								Finally

								Endtry

							Else

								Try

									Index On RUBR3+Codi3 Tag LinPK Candidate For !Deleted()

								Catch To oErr

									If oErr.ErrorNo = 1884 && Uniqueness of index ARTPK is violated.
										Index On RUBR3+Codi3 Tag LinPK
										Logerror( oErr.Message,;
											Lineno(1),;
											Alias() + " - Index On RUBR3+Codi3 "  )


									Else
										Throw oErr

									Endif
								Finally

								Endtry

							Endif

							Index On RUBR3 Tag RUBR3
							Index On Codi3 Tag Codi3
							Index On Desc3 Tag Desc3

							Thisform.OrdenarPor( "Id" )
							Thisform.OrdenarPor( "TS" )
							Thisform.OrdenarPor( "UTS", "Default" )
							Thisform.OrdenarPor( "TranId" )


							Try

								Index On Grup_Id Tag Grup_Id

							Catch To oErr
								If Empty( Field( "Grup_Id" ) )
									Try
										Alter Table ar3Lin Add	Column Grup_Id I

										If loArticulo.UsaGrupo = "S"
											M_Use( 0, Trim(DrComun)+"AR2GRU" )

											TEXT To lcCommand NoShow TextMerge Pretext 15
											Update ar3Lin Set
													ar3Lin.Grup_Id = ar2Gru.Id
												From ar2Gru
												Where ar2Gru.Codi2 = ar3Lin.Rubr3
											ENDTEXT

											&lcCommand

											Use In ar2Gru

										Else
											TEXT To lcCommand NoShow TextMerge Pretext 15
											Update ar3Lin Set
													ar3Lin.Grup_Id = ar3Lin.Rubr3
											ENDTEXT

											&lcCommand

										Endif

										Select ar3Lin
										Index On Grup_Id Tag Grup_Id

									Catch To oErr

									Finally

									Endtry


								Endif

							Finally

							Endtry

					Endcase
			Endcase
	Endcase

	If Type('cAR1ART')="C"
		If !Empty(cAR1ART) .And. !&ABORTA
			WARCH=Trim(DrComun)+"AR1ART"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All

				Delete For Empty( GRUP1 + NUME1 )
				Thisform.Comprimir( cAR1ART )
				Wait Window 'REORDENANDO ARCHIVO DE ARTICULOS....' Nowait

				If Empty( Field( "Tiva1" ) )
					Try

						TEXT To lcCommand NoShow TextMerge Pretext 15
						Alter Table ( Alias() ) Add	Column Tiva1 I
						ENDTEXT

						&lcCommand

						Update Ar1Art Set Tiva1 = IVA_NORMAL_ID

					Catch To oErr
						Logerror( oErr.Message,;
							Lineno(1),;
							Alias() + " - " + lcCommand )

					Finally

					Endtry

				Endif

				Inde On GRUP1+NUME1 To '&WARCH.1'
				Inde On Uppe(DESC1) To '&WARCH.2'
				Inde On NUME1 To '&WARCH.3'


				Try

					Inde On Upper( GRUP1 + NUME1 ) Tag "ArtPK" Candidate For !Deleted()

				Catch To oErr

					If oErr.ErrorNo = 1884 && Uniqueness of index ARTPK is violated.
						Inde On Upper( GRUP1 + NUME1 ) Tag "ArtPK"
						Logerror( oErr.Message,;
							Lineno(1),;
							Alias() + " - Inde On Upper( GRUP1 + NUME1 ) " )

					Else
						Throw oErr

					Endif
				Finally

				Endtry


				Index On GRUP1 Tag GRUP1
				Index On NUME1 Tag NUME1
				Inde On Uppe( DESC1 ) Tag DESC1

				If GetValue( "UsaAlias", "ar0Art", "N" ) = "S"

					If Empty( Field( "ALIA1" ) )
						Alter Table Ar1Art Add Column ALIA1 c(10)
					Endif

					Inde On Uppe( ALIA1 ) Tag ALIA1

					If GetValue( "UsaAlias", "ar0Art", "N" ) = "S"
						Inde On Uppe(ALIA1) To '&WARCH.4'
					Endif


				Endif

				If GetValue( "UsaBarras", "ar0Art", "N" ) = "S"
					If Empty( Field( "Barr1" ) )
						Alter Table Ar1Art Add Column Barr1 c(13)
					Endif

					Inde On Uppe( Barr1 ) Tag Barr1
				Endif


				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS" )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

				If loArticulo.UsaGrupo = "S"

					If Empty( Field( "Grup_Id" ) )
						Alter Table Ar1Art Add Column Grup_Id I
					Endif

					M_Use( 0, Trim(DrComun)+"AR2GRU" )

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Update ar1Art Set
							ar1Art.Grup_Id = ar2Gru.Id
						From ar2Gru
						Where ar2Gru.Codi2 = ar1Art.Grup1
							And Empty( ar1Art.Grup_Id )
					ENDTEXT

					&lcCommand

					Use In ar2Gru

					Select Ar1Art
					Index On Grup_Id Tag Grup_Id

				Endif

				If loArticulo.UsaLinea = "S"
					If Empty( Field( "Lin_Id" ) )
						Alter Table Ar1Art Add	Column Lin_Id I
					Endif

					If Empty( Field( "Grup_Id" ) )
						Alter Table Ar1Art Add	Column Grup_Id I

						If loArticulo.LinCodAtr = "A"
							TEXT To lcCommand NoShow TextMerge Pretext 15
							Update ar1Art Set
									Grup_Id = Rubr1,
									Lin_Id = Lineid
							ENDTEXT

							&lcCommand

						Endif
					Endif

					M_Use( 0, Trim(DrComun)+"ar3Lin" )

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Update ar1Art Set
							ar1Art.Lin_Id = ar3Lin.Id
						From ar3Lin
						Where Empty( ar1Art.Lin_Id )
							And ar3Lin.Codi3 = Substr( ar1Art.Nume1, 1, <<loArticulo.LenLinea>> )
							And ar3Lin.Grup_Id = ar1Art.Grup_Id
					ENDTEXT

					*&lcCommand

					Use In ar3Lin

					Select Ar1Art
					Index On Lin_Id Tag Lin_Id

				Endif


				If GetValue("CodStock", "ar0Art", "N" ) = "S"

					* RA 2015-03-23(14:45:43)
					* Código de Stock
					If !Empty( Field( "Grus1" )) And !Empty( Field( "Nums1" ))
						Index On GRUS1 Tag GRUS1
						Index On NUMS1 Tag NUMS1

						Inde On Upper( GRUS1 + NUMS1 ) Tag "ArtST_PK"

						If Empty( Field( "St_Id" ))
							Alter Table Ar1Art Add	Column St_Id I
						Endif

						* RA 2015-03-23(14:54:28)
						* Verificar Integridad Referencial
						TEXT To lcCommand NoShow TextMerge Pretext 15
						Select
								Id,
								Grup1,
								Nume1,
								Grus1,
								Nums1,
								St_Id
							From ar1Art
							Where Empty( St_Id )
							Order By Grus1,Nums1
							Into Cursor cArt ReadWrite
						ENDTEXT

						&lcCommand

						Select cArt
						Locate

						lcKey = Upper( GRUS1 + NUMS1 )
						Do While !Eof()

							If Seek( lcKey, "ar1Art", "ArtPk" )
								lnId = Ar1Art.Id
								Do While !Eof() And lcKey = Upper( GRUS1 + NUMS1 )
									Replace St_Id With lnId In cArt
									Skip
								Enddo

							Else
								Skip

							Endif

							If !Eof()
								lcKey = Upper( GRUS1 + NUMS1 )
							Endif

						Enddo

						Locate
						Scan
							If Seek( cArt.Id, "ar1Art", "Id" )
								Replace St_Id With cArt.St_Id In Ar1Art
							Endif
						Endscan

						Use In Select( "cArt" )

						Select Ar1Art

						* RA 2015-03-23(14:51:37)
						* Si no existe el codigo de stock
						* reemplazarlo por el código del articulo
						TEXT To lcCommand NoShow TextMerge Pretext 15
						Update ar1Art Set
								St_Id = Id,
								Grus1 = Grup1,
								Nums1 = Nume1
							Where Empty( St_Id )
						ENDTEXT

						&lcCommand

						Index On St_Id Tag St_Id

					Endif
				Endif

			Endif

		Endif

	Endif

	If Type('cAR4VAR')="C"
		If !Empty(cAR4VAR) .And. !&ABORTA
			WARCH=Trim(DrComun)+"AR4VAR"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Delete For Empty( Tipo4 ) Or Empty( Codi4 )
				Thisform.Comprimir( cAR4VAR )
				Wait Window 'REORDENANDO ARCHIVO DE PROV\CLIE\VEND\TARJ' Nowait

				TEXT To lcCommand NoShow TextMerge Pretext 15
				Inde On TIPO4+Str(CODI4,<<gnCodi4>>) To '&WARCH.1'
				ENDTEXT

				&lcCommand

				Inde On Tipo4+Upper(NOMB4) To '&WARCH.2'
				Inde On Tipo4+Upper(FANT4) To '&WARCH.3'
				Inde On Tipo4+Str(ZONA4,2)+Upper(NOMB4) To '&WARCH.4'
				Inde On Tipo4+Str(VEND4,4)+Upper(NOMB4)  To '&WARCH.5'

				Try
					Inde On Tipo4+Upper(ALIA4) To '&WARCH.6'
				Catch To oErr
				Finally
				Endtry



				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On TIPO4+Str(CODI4,<<gnCodi4>>) Tag "VarPK" Candidate For !Deleted()
					ENDTEXT

					&lcCommand

				Catch To oErr

					If oErr.ErrorNo = 1884 && Uniqueness of index ARTPK is violated.

						TEXT To lcCommand NoShow TextMerge Pretext 15
						Inde On TIPO4+Str(CODI4,<<gnCodi4>>) Tag "VarPK"
						ENDTEXT

						&lcCommand

						Set Order To Tag "VarPK"
						Locate

						lcTipo = Tipo4
						lnCodi = Codi4
						Do While !Eof()
							lcTipo = Tipo4
							Do While !Eof() And lcTipo = Tipo4

								lnCodi = Codi4
								Skip

								Do While !Eof() And lcTipo = Tipo4 And lnCodi = Codi4
									Delete
									Skip
								Enddo

							Enddo
						Enddo

						Set Order To
						Thisform.Comprimir( cAR4VAR )

						Try

							TEXT To lcCommand NoShow TextMerge Pretext 15
							Inde On TIPO4+Str(CODI4,<<gnCodi4>>) Tag "VarPK" Candidate For !Deleted()
							ENDTEXT

							&lcCommand

						Catch To oErr

							If oErr.ErrorNo = 1884 && Uniqueness of index ARTPK is violated.

								TEXT To lcCommand NoShow TextMerge Pretext 15
								Inde On TIPO4+Str(CODI4,<<gnCodi4>>) Tag "VarPK"
								ENDTEXT


								Logerror( oErr.Message,;
									Lineno(1),;
									Alias() + " - " + lcCommand )

							Endif

						Finally

						Endtry


					Else
						Throw oErr

					Endif
				Finally

				Endtry

				Index On Tipo4 Tag Tipo4
				Index On Codi4 Tag Codi4
				Index On NOMB4 Tag NOMB4
				Index On FANT4 Tag FANT4

				Index On CUIT4 Tag CUIT4
				Index On VEND4 Tag VEND4

				Try
					Index On ALIA4 Tag ALIA4
				Catch To oErr
				Finally
				Endtry

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS" )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

			Endif

		Endif
	Endif

	If Type( 'cAr4IiBb' ) = "C"
		If !Empty(cAr4IiBb) .And. !&ABORTA
			WARCH=Trim(DrComun)+"AR4IIBB.dbf"
			M_Use( 0, WARCH, 0, .T. )

			Delete From ar4iibb Where Empty( Substr( CUIT4, 1, 2 ) )

			If !Empty( _Tally )
				Pack
			Endif

			Thisform.Comprimir( "INSCRIPTOS EN INGRESOS BRUTOS" )
			Wait Window 'REORDENANDO ARCHIVO DE INSCRIPTOS EN INGRESOS BRUTOS....' Nowait

			Index On Codi4 Tag Codi4
			Index On CUIT4 Tag CUIT4 Candidate For !Deleted()

			Thisform.OrdenarPor( "Id" )
			Thisform.OrdenarPor( "TS" )
			Thisform.OrdenarPor( "UTS", "Default" )
			Thisform.OrdenarPor( "TranId" )


		Endif

	Endif

	If Type('cAR4Depo')="C"
		WARCH=Trim(DrComun)+'AR4Depo'
		If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
			Delete Tag All
			Delete For Empty( Id )
			Thisform.Comprimir( "Depósitos" )
			Wait Window 'REORDENANDO ARCHIVO DE DEPOSITOS....' Nowait

			Index On NOMB4 Tag NOMB4

			Thisform.OrdenarPor( "Id" )
			Thisform.OrdenarPor( "TS" )
			Thisform.OrdenarPor( "UTS", "Default" )
			Thisform.OrdenarPor( "TranId" )

		Endif
	Endif

	If Type('cCortes')="C"
		WARCH=Trim(DRVA)+'Cortes'
		If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
			Delete Tag All
			Delete For Empty( Id )
			Delete For Empty( Numero )
			Thisform.Comprimir( "Cortes" )
			Wait Window 'REORDENANDO ARCHIVO DE CORTES....' Nowait

			Index On Numero Tag Numero Candidate For !Deleted() And !Empty( Numero )
			Index On Fecha Tag Fecha
			Index On Art_Id Tag Art_Id
			Index On Articulo + Talle + Str( Numero, 8 ) Tag Articulo Desc

			TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fecha
				Where Empty( TS )
			ENDTEXT

			Thisform.OrdenarPor( "Id" )
			Thisform.OrdenarPor( "TS", lcCommand )
			Thisform.OrdenarPor( "UTS", "Default" )
			Thisform.OrdenarPor( "TranId" )


		Endif
	Endif


	If Type('cAR7VEN')="C"
		If !Empty( cAR7VEN ) .And. !&ABORTA
			If WCLAV$'AM'
				WARCH=Trim(DRVA)+'AR7VEN'

				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All

					If Empty( Field( "Iva_Normal" ))
						Alter Table ar7Ven Add Column Iva_Normal N(12,2)
						Alter Table ar7Ven Add Column Iva_Reduci N(12,2)
						Alter Table ar7Ven Add Column Iva_Difere N(12,2)

						Replace All Iva_Normal With IIVA7
						Replace All Iva_Reduci With IIVN7
					Endif

					If Empty( Field( "Tasa_Norma" ))
						Alter Table ar7Ven Add Column Tasa_Norma N(6,2)
						Alter Table ar7Ven Add Column Tasa_Reduc N(6,2)
						Alter Table ar7Ven Add Column Tasa_Difer N(6,2)

						Replace All Tasa_Norma With TIVA7
						Replace All Tasa_Reduc With TIVN7
					Endif

					Delete For Empty( Nume7 )
					Thisform.Comprimir( cAR7VEN )
					Wait Window 'REORDENANDO ARCHIVO DE VENTAS' Nowait
					Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6)+Str(VCTO7,1) To '&WARCH.1'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(CODI7,<<gnCodi4>>)+Dtos((FECH7)) To '&WARCH.2'
					ENDTEXT

					&lcCommand

					Inde On Dtos((FECH7))+Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6) To '&WARCH.3'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Dtos((VENC7))+Str(CODI7,<<gnCodi4>>) To '&WARCH.4'
					ENDTEXT

					&lcCommand

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(CODI7,<<gnCodi4>>)+Dtos((VENC7)) To '&WARCH.5'
					ENDTEXT

					&lcCommand

					Inde On NEXA7 To '&WARCH.6'


					Try

						Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6)+Str(VCTO7,1) Tag pk7Ven Candidate For !Deleted()

					Catch To oErr

						If oErr.ErrorNo = 1884 && Uniqueness of index pk7Com is violated.
							Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6)+Str(VCTO7,1) Tag pk7Ven
							Logerror( oErr.Message,;
								Lineno(1),;
								Alias() + " - Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(NUME7,6)+Str(VCTO7,1) " )

						Else
							Throw oErr

						Endif
					Finally

					Endtry


					Index On COMP7 Tag COMP7
					Index On TIPO7 Tag TIPO7
					Index On SUCU7 Tag SUCU7
					Index On Nume7 Tag Nume7
					Index On FECH7 Tag FECH7
					Index On CODI7 Tag CODI7
					Index On VENC7 Tag VENC7
					Index On NEXA7 Tag NEXA7

					If Field( "HORA7" ) = "HORA7"
						Index On HORA7 Tag HORA7
					Endif

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech7
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )
					
					Thisform.VerificarCampo( "CAE7" )
					Thisform.VerificarCampo( "CodigoComp" )
					Thisform.VerificarCampo( "VencCae" )
					Thisform.VerificarCampo( "CgoBarra" )
					Thisform.VerificarCampo( "Nomf7" )


				Endif
			Endif

			If WCLAV$'BM'
				WARCH=Trim(DRVD)+'XX7VEN'

				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Delete For Empty( Nume7 )
					Thisform.Comprimir( cAR7VEN )
					Wait Window '* REORDENANDO ARCHIVO DE VENTAS *' Nowait
					Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6)+Str(VCTO7,1) To '&WARCH.1'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(CODI7,<<gnCodi4>>)+Dtos((FECH7)) To '&WARCH.2'
					ENDTEXT

					&lcCommand

					Inde On Dtos((FECH7))+Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6) To '&WARCH.3'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Dtos((VENC7))+Str(CODI7,<<gnCodi4>>) To '&WARCH.4'
					ENDTEXT

					&lcCommand

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(CODI7,<<gnCodi4>>)+Dtos((VENC7)) To '&WARCH.5'
					ENDTEXT

					&lcCommand

					Inde On NEXA7 To '&WARCH.6'

					Try

						Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6)+Str(VCTO7,1) Tag pk7Ven Candidate For !Deleted()

					Catch To oErr

						If oErr.ErrorNo = 1884 && Uniqueness of index pk7Com is violated.
							Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6)+Str(VCTO7,1) Tag pk7Ven
							Logerror( oErr.Message,;
								Lineno(1),;
								Alias() + " - Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(NUME7,6)+Str(VCTO7,1) " )

						Else
							Throw oErr

						Endif
					Finally

					Endtry

					Index On COMP7 Tag COMP7
					Index On TIPO7 Tag TIPO7
					Index On SUCU7 Tag SUCU7
					Index On Nume7 Tag Nume7
					Index On FECH7 Tag FECH7
					Index On CODI7 Tag CODI7
					Index On VENC7 Tag VENC7
					Index On NEXA7 Tag NEXA7

					If Field( "HORA7" ) = "HORA7"
						Index On HORA7 Tag HORA7
					Endif

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech7
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

				Endif

			Endif


		Endif
	Endif


	If Type('cAR9ITE')="C"
		If !Empty( cAR9ITE ) .And. !&ABORTA
			If WCLAV$'AM'
				WARCH=Trim(DRVA)+'AR9ITE'


				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR9ITE )
					Wait Window 'REORDENANDO ARCHIVO DE ITEMS' Nowait

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(COMP9,2)+TIPO9+Str(SUCU9,4)+Str(NUME9,8)+Str(CODI9,<<gnCodi4>>) TO '&WARCH.1'
					ENDTEXT

					&lcCommand

					Inde On GRUP9+ARTI9+Dtos(FECH9) To '&WARCH.2'
					Inde On GRUP9+Dtos(FECH9)+ARTI9 To '&WARCH.3'
					Inde On Dtos(FECH9)+Str(COMP9,2)+TIPO9+Str(SUCU9,4)+Str(NUME9,8) To '&WARCH.4'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(CODI9,<<gnCodi4>>)+GRUP9+ARTI9+Str( -Val( Dtos((FECH9))),9 ) To '&WARCH.5'
					ENDTEXT

					&lcCommand

					Inde On GRUP9+ARTI9+Str( -Val( Dtos((FECH9))),9 ) To '&WARCH.6'



					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(COMP9,2)+TIPO9+Str(SUCU9,4)+Str(NUME9,8)+Str(CODI9,<<gnCodi4>>) Tag "ItePK"
					ENDTEXT

					&lcCommand


					Index On GRUP9+ARTI9 Tag ArtPK
					Index On GRUP9 Tag GRUP9
					Index On ARTI9 Tag ARTI9
					Index On FECH9 Tag FECH9
					Index On CODI9 Tag CODI9
					Index On COMP9 Tag COMP9
					Index On TIPO9 Tag TIPO9
					Index On SUCU9 Tag SUCU9
					Index On NUME9 Tag NUME9

					Try

						Index On Art_Id Tag Art_Id

					Catch To oErr

						If Empty( Field( "Art_Id" ) )
							Try
								Alter Table ar9Ite Add	Column Art_Id I
								If !Empty( Field( "ArtId" ) )
									Replace All Art_Id With ArtId

								Else
									M_Use( 0, Trim(DrComun)+"AR1ART" )

									TEXT To lcCommand NoShow TextMerge Pretext 15
									Update ar9Ite Set
											Art_Id = ar1Art.Id
										From ar1Art
										Where ar1Art.Grup1+ar1Art.Nume1 = ar9Ite.GRUP9+ar9Ite.ARTI9
									ENDTEXT

									&lcCommand
									Use In Select("ar1Art")

									Select ar9Ite

								Endif

								Index On Art_Id Tag Art_Id


							Catch To oErr

							Finally

							Endtry


						Endif


					Finally

					Endtry

					Try

						Index On Desp_Id Tag Desp_Id

					Catch To oErr
						If Empty( Field( "Desp_Id" ) )
							Try
								Alter Table ar9Ite Add	Column Desp_Id I
								If !Empty( Field( "DespId" ) )
									Replace All Desp_Id With DespId
								Endif
								Index On Desp_Id Tag Desp_Id

							Catch To oErr

							Finally

							Endtry


						Endif

					Finally

					Endtry



					Try

						Index On Ven7_Id Tag Ven7_Id

					Catch To oErr
						If Empty( Field( "Ven7_Id" ) )
							Try
								Alter Table ar9Ite Add	Column Ven7_Id I
								Index On Ven7_Id Tag Ven7_Id

							Catch To oErr

							Finally

							Endtry


						Endif

					Finally

					Endtry

					If GetValue( "PideItems", "ar0Com", "N" ) == "S"
						Try

							Index On Com7_Id Tag Com7_Id

						Catch To oErr
							If Empty( Field( "Com7_Id" ) )
								Try
									Alter Table ar9Ite Add	Column Com7_Id I

									Select ar9Ite
									Set Order To Tag ItePK

									M_Use( 0, Trim(DRVA)+'AR7COM' )

									Select ar7Com
									Locate

									Scan
										lcKey = Str(COMP7,2)+TIPO7+Str(SUCU7,4)+Str(Nume7,8)+Str(CODI7,4)
										lnId = Id
										If Seek( lcKey, "ar9Ite", "ItePK" )
											Select ar9Ite
											Do While !Eof() And lcKey = Str(COMP9,2)+TIPO9+Str(SUCU9,4)+Str(NUME9,8)+Str(CODI9,4)
												Replace Com7_Id With lnId
												Skip
											Enddo

										Endif

										Select ar7Com

									Endscan

									Select ar9Ite
									Index On Com7_Id Tag Com7_Id

								Catch To oErr

								Finally
									Use In Select( "ar7Com" )

								Endtry


							Endif

						Finally

						Endtry

					Endif

					Try

						Index On Depo9 Tag Depo9

					Catch To oErr
						If Empty( Field( "Depo9" ) )
							Try
								Alter Table ar9Ite Add	Column Depo9 I
								Index On Depo9 Tag Depo9

							Catch To oErr

							Finally

							Endtry


						Endif

					Finally

					Endtry

					If Empty( Field( "Dep19" ))
						Alter Table ar9Ite Add	Column Dep19 I
					Endif

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech9
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )
					
					If GetValue("CodStock", "ar0Art", "N" ) = "S"
						Thisform.VerificarCampo( "ArtSt_Id" )
						Index On ArtSt_Id Tag ArtSt_Id
					EndIf
					


				Endif


			Endif


			If WCLAV$'BM'
				WARCH=Trim(DRVD)+'XX9ITE'


				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR9ITE )
					Wait Window '* REORDENANDO ARCHIVO DE ITEMS *' Nowait

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(COMP9,2)+TIPO9+Str(SUCU9,4)+Str(NUME9,8)+Str(CODI9,<<gnCodi4>>) TO '&WARCH.1'
					ENDTEXT

					&lcCommand

					Inde On GRUP9+ARTI9+Dtos(FECH9) To '&WARCH.2'
					Inde On GRUP9+Dtos(FECH9)+ARTI9 To '&WARCH.3'
					Inde On Dtos(FECH9)+TIPO9+Str(SUCU9,4)+Str(NUME9,8) To '&WARCH.4'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(CODI9,<<gnCodi4>>)+GRUP9+ARTI9+Str( -Val( Dtos((FECH9))),9 ) To '&WARCH.5'
					ENDTEXT

					&lcCommand

					Inde On GRUP9+ARTI9+Str( -Val( Dtos((FECH9))),9 ) To '&WARCH.6'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(COMP9,2)+TIPO9+Str(SUCU9,4)+Str(NUME9,8)+Str(CODI9,<<gnCodi4>>) Tag "ItePK"
					ENDTEXT

					&lcCommand

					Index On GRUP9+ARTI9 Tag ArtPK
					Index On GRUP9 Tag GRUP9
					Index On ARTI9 Tag ARTI9
					Index On FECH9 Tag FECH9
					Index On CODI9 Tag CODI9
					Index On COMP9 Tag COMP9
					Index On TIPO9 Tag TIPO9
					Index On SUCU9 Tag SUCU9
					Index On NUME9 Tag NUME9

					Try

						Index On Art_Id Tag Art_Id


					Catch To oErr
						If Empty( Field( "Art_Id" ) )
							Try
								Alter Table xx9Ite Add	Column Art_Id I
								If !Empty( Field( "ArtId" ) )
									Replace All Art_Id With ArtId

								Else
									M_Use( 0, Trim(DrComun)+"AR1ART" )

									TEXT To lcCommand NoShow TextMerge Pretext 15
									Update xx9Ite Set
											Art_Id = ar1Art.Id
										From ar1Art
										Where ar1Art.Grup1+ar1Art.Nume1 = xx9Ite.GRUP9+xx9Ite.ARTI9
									ENDTEXT

									&lcCommand
									Use In Select("ar1Art")

									Select xx9Ite

								Endif

								Index On Art_Id Tag Art_Id

							Catch To oErr

							Finally

							Endtry


						Endif

					Finally

					Endtry


					Try

						Index On Desp_Id Tag Desp_Id

					Catch To oErr
						If Empty( Field( "Desp_Id" ) )
							Try
								Alter Table xx9Ite Add	Column Desp_Id I
								If !Empty( Field( "DespId" ) )
									Replace All Desp_Id With DespId
								Endif
								Index On Desp_Id Tag Desp_Id

							Catch To oErr

							Finally

							Endtry


						Endif

					Finally

					Endtry


					Try

						Index On Ven7_Id Tag Ven7_Id

					Catch To oErr
						If Empty( Field( "Ven7_Id" ) )
							Try
								Alter Table xx9Ite Add	Column Ven7_Id I
								Index On Ven7_Id Tag Ven7_Id

							Catch To oErr

							Finally

							Endtry


						Endif

					Finally

					Endtry

					If GetValue( "PideItems", "ar0Com", "N" ) == "S"
						Try

							Index On Com7_Id Tag Com7_Id

						Catch To oErr
							If Empty( Field( "Com7_Id" ) )
								Try
									Alter Table xx9Ite Add	Column Com7_Id I

									Select xx9Ite
									Set Order To Tag ItePK

									M_Use( 0, Trim(DRVD)+'xx7COM' )

									Select xx7Com
									Locate

									Scan
										lcKey = Str(COMP7,2)+TIPO7+Str(SUCU7,4)+Str(Nume7,8)+Str(CODI7,4)
										lnId = Id
										If Seek( lcKey, "xx9Ite", "ItePK" )
											Select xx9Ite
											Do While !Eof() And lcKey = Str(COMP9,2)+TIPO9+Str(SUCU9,4)+Str(NUME9,8)+Str(CODI9,4)
												Replace Com7_Id With lnId
												Skip
											Enddo

										Endif

										Select ar7Com

									Endscan

									Select xx9Ite
									Index On Com7_Id Tag Com7_Id

								Catch To oErr

								Finally
									Use In Select( "xx7Com" )

								Endtry


							Endif

						Finally

						Endtry

					Endif

					Try

						Index On Depo9 Tag Depo9

					Catch To oErr
						If Empty( Field( "Depo9" ) )
							Try
								Alter Table xx9Ite Add	Column Depo9 I
								Index On Depo9 Tag Depo9

							Catch To oErr

							Finally

							Endtry


						Endif

					Finally

					Endtry

					If Empty( Field( "Dep19" ))
						Alter Table xx9Ite Add	Column Dep19 I
					Endif
					TEXT To lcCommand NoShow TextMerge Pretext 15
					Update <<Alias()>> Set
							TS = Fech9
						Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

					If GetValue("CodStock", "ar0Art", "N" ) = "S"
						Thisform.VerificarCampo( "ArtSt_Id" )
						Index On ArtSt_Id Tag ArtSt_Id
					EndIf

				Endif


			Endif


		Endif

	Endif

	If Type('cAR7PRO')="C"
		If !Empty( cAR7PRO ) .And. !&ABORTA
			If WCLAV$'AM'
				WARCH=Trim(DRVA)+'AR7PRO'

				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Delete For Empty( Nume7 ) Or Empty( Id )
					Thisform.Comprimir( cAR7PRO )
					Wait Window 'REORDENANDO ARCHIVO DE PROFORMAS (CAB)' Nowait

					Index On Nume7 Tag Nume7 Candidate For !Deleted()
					Index On FECH7 Tag FECH7
					Index On CODI7 Tag CODI7

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech7
				Where Empty( TS )
					ENDTEXT


					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

				Endif
			Endif

		Endif
	Endif

	If Type('cAR9PRO')="C"
		If !Empty( cAR9PRO ) .And. !&ABORTA
			If WCLAV$'AM'
				WARCH=Trim(DRVA)+'AR9PRO'

				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR9PRO )
					Wait Window 'REORDENANDO ARCHIVO DE PROFORMAS (ITE)' Nowait

					Index On FECH9 Tag FECH9
					Index On CODI9 Tag CODI9
					Index On NUME9 Tag NUME9
					Index On Art_Id Tag Art_Id
					Index On Cab_Id Tag Cab_Id

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech9
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

				Endif
			Endif

		Endif
	Endif


	If Type('cAR7DES')="C"
		If !Empty( cAR7DES ) .And. !&ABORTA
			If WCLAV$'AM'
				WARCH=Trim(DRVA)+'AR7DES'

				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Delete For Empty( Nume7 )
					Thisform.Comprimir( cAR7DES )
					Wait Window 'REORDENANDO ARCHIVO DE DESPACHOS' Nowait

					Index On Upper( Nume7 ) Tag Nume7 Candidate For !Deleted()
					Index On FECH7 Tag FECH7

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech7
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

				Endif

				WARCH=Trim(DRVA)+'AR9DES'

				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR7DES )
					Wait Window 'REORDENANDO ARCHIVO DE DESPACHOS' Nowait

					Try

						Index On Desp_Id Tag Desp_Id

					Catch To oErr
						If Empty( Field( "Desp_Id" ) )
							Try
								Alter Table ar9Des Add	Column Desp_Id I
								If !Empty( Field( "DespId" ) )
									Replace All Desp_Id With DespId
								Endif
								Index On Desp_Id Tag Desp_Id

							Catch To oErr

							Finally

							Endtry


						Endif

					Finally

					Endtry


					Try

						Index On Art_Id Tag Art_Id

					Catch To oErr

						If Empty( Field( "Art_Id" ) )
							Try
								Alter Table ar9Des Add	Column Art_Id I
								If !Empty( Field( "ArtId" ) )
									Replace All Art_Id With ArtId
								Endif
								Index On Art_Id Tag Art_Id

							Catch To oErr

							Finally

							Endtry


						Endif


					Finally

					Endtry

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS" )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

				Endif


			Endif
		Endif
	Endif


	If Type('cAR12APD')="C"
		If !Empty( cAR12APD ) .And. !&ABORTA
			If WCLAV$'AM'
				WARCH=Trim(DRVA)+'AR12APD'
				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR12APD )
					Wait Window 'REORDENANDO ARCHIVO DE APLICACIONES DE DEUDAS' Nowait
					Inde On Str(COMD12,2)+TIPD12+Str(SUCD12,2)+Str(NUMD12,6)+Str(VCTO12,1) To '&WARCH.1'
					Inde On Str(COMH12,2)+TIPH12+Str(SUCH12,2)+Str(NUMH12,6) To '&WARCH.2'

					Index On FECH12 Tag FECH12
					Index On CODI12 Tag CODI12
					Index On COMD12 Tag COMD12
					Index On TIPD12 Tag TIPD12
					Index On SUCD12 Tag SUCD12
					Index On NUMD12 Tag NUMD12
					Index On COMH12 Tag COMH12
					Index On TIPH12 Tag TIPH12
					Index On SUCH12 Tag SUCH12
					Index On NUMH12 Tag NUMH12

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Update <<Alias()>> Set
							TS = Fech12
						Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )


				Endif


			Endif


			If WCLAV$'BM'
				WARCH=Trim(DRVD)+'XX12APD'
				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR12APD )
					Wait Window '* REORDENANDO ARCHIVO DE APLICACIONES DE DEUDAS *' Nowait
					Inde On Str(COMD12,2)+TIPD12+Str(SUCD12,2)+Str(NUMD12,6)+Str(VCTO12,1) To '&WARCH.1'
					Inde On Str(COMH12,2)+TIPH12+Str(SUCH12,2)+Str(NUMH12,6) To '&WARCH.2'

					Index On FECH12 Tag FECH12
					Index On CODI12 Tag CODI12
					Index On COMD12 Tag COMD12
					Index On TIPD12 Tag TIPD12
					Index On SUCD12 Tag SUCD12
					Index On NUMD12 Tag NUMD12
					Index On COMH12 Tag COMH12
					Index On TIPH12 Tag TIPH12
					Index On SUCH12 Tag SUCH12
					Index On NUMH12 Tag NUMH12

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech12
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )


				Endif


			Endif


		Endif

	Endif



	If Type('cAR10VAL')="C"
		If !Empty( cAR10VAL ) .And. !&ABORTA
			If WCLAV$'AM'
				WARCH=Trim(DRVA)+'AR10VAL'

				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR10VAL )
					Wait Window 'REORDENANDO ARCHIVO DE VALORES' Nowait
					Inde On ESTA10+Str(COMP10,2)+Str(BANC10,3)+Str(NUME10,10)+Str(SECU10,2) To '&WARCH.1'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(CLIE10,<<gnCodi4>>)+Dtos((VENC10)) To '&WARCH.2'
					ENDTEXT

					&lcCommand

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Dtos((VENC10))+Str(CLIE10,<<gnCodi4>>) To '&WARCH.3'
					ENDTEXT

					&lcCommand

					Inde On TREV10+Str(SREV10,2)+Str(NREV10,6) To '&WARCH.4'
					Inde On TREC10+Str(SREC10,4)+Str(NREC10,8)+Str(PROV10,4) To '&WARCH.5'
					Inde On Dtos((FECH10))+Str(PROV10,4)+TREC10+Str(SREC10,4)+Str(NREC10,8)+;
						TREV10+Str(SREV10,2)+Str(NREV10,6) To '&WARCH.6'
					Inde On Str(PROV10,4)+Dtos((VENC10)) To '&WARCH.7'
					Inde On Str(BANC10,3)+Dtos(FEAC10) To '&WARCH.8'
					Inde On Str(BOLE10,10)+Str(COMP10,2)+Str(BANC10,3) To '&WARCH.9'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Dtos((FING10))+Str(CLIE10,<<gnCodi4>>) To '&WARCH.A'
					ENDTEXT

					&lcCommand

					Inde On NEXA10 To '&WARCH.B'
					Inde On ESTA10+Str(SITU10,1)+Str(COMP10,2)+Str(BANC10,3)+Str(NUME10,10) To '&WARCH.C'

					If PNIV
						Inde On ESTA10+Str(NUMI10,6) To '&WARCH.D'
					Endif


					Index On ESTA10 Tag ESTA10
					Index On BANC10 Tag BANC10
					Index On COMP10 Tag COMP10
					Index On CLIE10 Tag CLIE10
					Index On VENC10 Tag VENC10
					Index On FECH10 Tag FECH10
					Index On FEAC10 Tag FEAC10
					Index On NEXA10 Tag NEXA10

					If Type( "Caja10" ) # "U"
						Index On Caja10 Tag Caja10
					Endif

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech10
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )



				Endif


			Endif


			If WCLAV$'BM'
				WARCH=Trim(DRVD)+'XX10VAL'


				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR10VAL )
					Wait Window '* REORDENANDO ARCHIVO DE VALORES *' Nowait
					Inde On ESTA10+Str(COMP10,2)+Str(BANC10,3)+Str(NUME10,10)+Str(SECU10,2) To '&WARCH.1'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(CLIE10,<<gnCodi4>>)+Dtos((VENC10)) To '&WARCH.2'
					ENDTEXT

					&lcCommand


					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Dtos((VENC10))+Str(CLIE10,<<gnCodi4>>) To '&WARCH.3'
					ENDTEXT

					&lcCommand

					Inde On TREV10+Str(SREV10,2)+Str(NREV10,6) To '&WARCH.4'
					Inde On TREC10+Str(SREC10,4)+Str(NREC10,8)+Str(PROV10,4) To '&WARCH.5'
					Inde On Dtos((FECH10))+Str(PROV10,4)+TREC10+Str(SREC10,4)+Str(NREC10,8)+;
						TREV10+Str(SREV10,2)+Str(NREV10,6) To '&WARCH.6'
					Inde On Str(PROV10,4)+Dtos((VENC10)) To '&WARCH.7'
					Inde On Str(BANC10,3)+Dtos(FEAC10) To '&WARCH.8'
					Inde On Str(BOLE10,10)+Str(COMP10,2)+Str(BANC10,3) To '&WARCH.9'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Dtos((FING10))+Str(CLIE10,<<gnCodi4>>) To '&WARCH.A'
					ENDTEXT

					&lcCommand

					Inde On NEXA10 To '&WARCH.B'
					Inde On ESTA10+Str(SITU10,1)+Str(COMP10,2)+Str(BANC10,3)+Str(NUME10,10) To '&WARCH.C'

					If PNIV
						Inde On ESTA10+Str(NUMI10,6) To '&WARCH.D'
					Endif

					Index On ESTA10 Tag ESTA10
					Index On BANC10 Tag BANC10
					Index On COMP10 Tag COMP10
					Index On CLIE10 Tag CLIE10
					Index On VENC10 Tag VENC10
					Index On FECH10 Tag FECH10
					Index On FEAC10 Tag FEAC10
					Index On NEXA10 Tag NEXA10

					If Type( "Caja10" ) # "U"
						Index On Caja10 Tag Caja10
					Endif

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech10
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

				Endif


			Endif


		Endif

	Endif

	If Type('cAR10CAJ')="C"
		If !Empty( cAR10CAJ ) .And. !&ABORTA

			If FileExist( Trim(DRVA)+'AR10CAJ.Dbf' )
				WARCH=Trim(DrComun)+"AR10CAJ"
				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All

					If Empty( Field( "Fecc10", "ar10Caj" ))

						* Fecha de Cierre				: ar10Caj.Fecc10
						* Saldo Efectivo al Cierre    	: ar10Caj.EfeC10
						* Saldo Efectivo al Cierre (*)	: ar10Caj.EfeX10
						* Saldo Valores al Cierre    	: ar10Caj.ValC10
						* Saldo Valores al Cierre (*)	: ar10Caj.ValX10

						Alter Table ar10Caj ;
							Add Column Fecc10 D

						Alter Table ar10Caj ;
							Add Column EfeC10 N(12,2)

						Alter Table ar10Caj ;
							Add Column EfeX10 N(12,2)

						Alter Table ar10Caj ;
							Add Column ValC10 N(12,2)

						Alter Table ar10Caj ;
							Add Column ValX10 N(12,2)

					Endif

					Delete For Empty( Codi10 )
					Thisform.Comprimir( cAR10CAJ )
					Wait Window 'REORDENANDO ARCHIVO DE CAJAS' Nowait

					Index On Codi10 Tag Codi10 For Not Deleted() Candidate
					Index On Desc10 Tag Desc10

					Index On Codi10 To '&WARCH.1'
					Index On Desc10 To '&WARCH.2'

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS" )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )


				Endif
			Endif

			If FileExist( Trim(DRVA)+'AR9CAJ.Dbf' )
				* RA 2014-05-19(20:48:19)
				* Casa Eduardo

				WARCH=Trim(DRVA)+'AR9CAJ'

				Do Case
					Case M_FILE(0,.T.,.T.,'U',WARCH,.T.)
						Delete Tag All
						Thisform.Comprimir( cAR10CAJ )
						Wait Window 'REORDENANDO ARCHIVO DE CAJAS' Nowait

						Inde On Str(SUCU9,2)+Str(COMP9,2)+Str(NUME9,6)+Str(CODI9,4) To &WARCH.1
						Inde On Dtos((FECH9))+Str(SUCU9,2)+Str(COMP9,2)+Str(NUME9,6) To &WARCH.2
						Inde On NEXA9 To &WARCH.3
						Inde On Str(CODI9,3)+Dtos((FECH9)) To &WARCH.4
						*  INDE ON DTOS((FECH9))+STR(CODI9,2)+ALLTRIM(REFE9) TO &WARCH.5

						TEXT To lcCommand NoShow TextMerge Pretext 15
						Update <<Alias()>> Set
								TS = Fech9
							Where Empty( TS )
						ENDTEXT

						Thisform.OrdenarPor( "Id" )
						Thisform.OrdenarPor( "TS", lcCommand )
						Thisform.OrdenarPor( "UTS", "Default" )
						Thisform.OrdenarPor( "TranId" )

						Index On FECH9 Tag FECH9
						Index On SUCU9 Tag SUCU9
						Index On COMP9 Tag COMP9
						Index On NUME9 Tag NUME9
						Index On CODI9 Tag CODI9

						If !Empty( Field( "Lote9" ))
							Index On Lote9 Tag Lote9
						Endif

						If !Empty( Field( "Cupo9" ))
							Index On Lote9 Tag Cupo9
						Endif

				Endcase
			Endif

		Else

		Endif
	Endif


	If Type('cAR2COL')="C"
		If !Empty( cAR2COL ) .And. !&ABORTA
			WARCH=Trim(DrComun)+"AR2COL"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Thisform.Comprimir( cAR2COL )
				Wait Window 'REORDENANDO ARCHIVO DE COLORES' Nowait
				Inde On CODI2 To '&WARCH.1'
				Inde On Uppe(DESC2) To '&WARCH.2'

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS" )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

			Endif
		Endif

		If FileExist( Trim(DRVA)+'AR1COL.Dbf' )
			WARCH=Trim(DRVA)+"AR1COL"
			Do Case
				Case M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( "ARCHIVO DE COLORES POR ARTICULO" )
					Wait Window 'REORDENANDO ARCHIVO DE COLORES POR ARTICULO' Nowait

					Inde On GRUP1+NUME1+COLO1 To &WARCH.1

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS" )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

			Endcase
		Endif

	Endif

	If Type('cAR7REM')="C"
		If !Empty( cAR7REM ) .And. !&ABORTA
			If WCLAV$'AM'
				WARCH=Trim(DRVA)+"AR7REM"
				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Delete For Empty( Nume7 )
					Thisform.Comprimir( cAR7REM )
					Wait Window 'REORDENANDO ARCHIVO DE REMITOS' Nowait

					Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6) To '&WARCH.1'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(CODI7,<<gnCodi4>>)+Dtos((FECH7)) To '&WARCH.2'
					ENDTEXT

					&lcCommand

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Dtos((FECH7))+Str(CODI7,<<gnCodi4>>)+Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(NUME7,6) To '&WARCH.3'
					ENDTEXT

					&lcCommand


					Try

						Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6) Tag pk7Rem Candidate For !Deleted()

					Catch To oErr

						If oErr.ErrorNo = 1884 && Uniqueness of index pk7Com is violated.
							Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6) Tag pk7Rem
							Logerror( oErr.Message,;
								Lineno(1),;
								Alias() + " - Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(NUME7,6)+Str(VCTO7,1) " )

						Else
							Throw oErr

						Endif
					Finally

					Endtry


					Index On COMP7 Tag COMP7
					Index On TIPO7 Tag TIPO7
					Index On SUCU7 Tag SUCU7
					Index On Nume7 Tag Nume7
					Index On FECH7 Tag FECH7
					Index On CODI7 Tag CODI7

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech7
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

				Endif


			Endif


			If WCLAV$'BM'
				WARCH=Trim(DRVD)+"XX7REM"
				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Delete For Empty( Nume7 )
					Thisform.Comprimir( cAR7REM )
					Wait Window '* REORDENANDO ARCHIVO DE REMITOS *' Nowait
					Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6) To '&WARCH.1'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(CODI7,<<gnCodi4>>)+Dtos((FECH7)) To '&WARCH.2'
					ENDTEXT

					&lcCommand

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Dtos((FECH7))+Str(CODI7,<<gnCodi4>>)+Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(NUME7,6) To '&WARCH.3'
					ENDTEXT

					&lcCommand

					Try

						Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6) Tag pk7Rem Candidate For !Deleted()

					Catch To oErr

						If oErr.ErrorNo = 1884 && Uniqueness of index pk7Com is violated.
							Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(Nume7,6) Tag pk7Rem
							Logerror( oErr.Message,;
								Lineno(1),;
								Alias() + " - Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,2)+Str(NUME7,6)+Str(VCTO7,1) " )

						Else
							Throw oErr

						Endif
					Finally

					Endtry

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech7
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

					Index On COMP7 Tag COMP7
					Index On TIPO7 Tag TIPO7
					Index On SUCU7 Tag SUCU7
					Index On Nume7 Tag Nume7
					Index On FECH7 Tag FECH7
					Index On CODI7 Tag CODI7

				Endif


			Endif


		Endif

	Endif

	If Type('cAR9REM')="C"
		If !Empty( cAR9REM ) .And. !&ABORTA
			If WCLAV$'AM'
				WARCH=Trim(DRVA)+"AR9REM"
				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR9REM )
					Wait Window 'REORDENANDO ARCHIVO DE ITEMS DE REMITOS' Nowait

					Inde On Str(COMP9,2)+TIPO9+Str(SUCU9,2)+Str(NUME9,6) To '&WARCH.1'

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(CODI9,<<gnCodi4>>)+Dtos((FECH9)) To '&WARCH.2'
					ENDTEXT

					&lcCommand

					Inde On Str(COMP9,2)+TIPO9+Str(SUCU9,2)+Str(NUME9,6) Tag "ItePK"

					Index On GRUP9+ARTI9 Tag ArtPK
					Index On GRUP9 Tag GRUP9
					Index On ARTI9 Tag ARTI9
					Index On FECH9 Tag FECH9
					Index On CODI9 Tag CODI9
					Index On COMP9 Tag COMP9
					Index On TIPO9 Tag TIPO9
					Index On SUCU9 Tag SUCU9
					Index On NUME9 Tag NUME9

					Try

						Index On Art_Id Tag Art_Id

					Catch To oErr

						If Empty( Field( "Art_Id" ) )
							Try
								Alter Table ar9Rem Add	Column Art_Id I
								If !Empty( Field( "ArtId" ) )
									Replace All Art_Id With ArtId
								Endif
								Index On Art_Id Tag Art_Id

							Catch To oErr

							Finally

							Endtry


						Endif


					Finally

					Endtry

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech9
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )


					Try

						Index On Cab_Id Tag Cab_Id

					Catch To oErr
						If Empty( Field( "Cab_Id" ) )
							Try
								Alter Table ar9Rem Add Column Cab_Id I
								Index On Cab_Id Tag Cab_Id

							Catch To oErr

							Finally

							Endtry


						Endif

					Finally

					Endtry

					Try

						Index On Desp_Id Tag Desp_Id

					Catch To oErr
						If Empty( Field( "Desp_Id" ) )
							Try
								Alter Table ar9Rem Add	Column Desp_Id I
								If !Empty( Field( "DespId" ) )
									Replace All Desp_Id With DespId
								Endif
								Index On Desp_Id Tag Desp_Id

							Catch To oErr

							Finally

							Endtry


						Endif

					Finally

					Endtry



				Endif


			Endif


			If WCLAV$'BM'
				WARCH=Trim(DRVD)+"XX9REM"
				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR9REM )
					Wait Window '* REORDENANDO ARCHIVO DE ITEMS DE REMITOS *' Nowait

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(COMP9,2)+TIPO9+Str(SUCU9,2)+Str(NUME9,6)+Str(CODI9,<<gnCodi4>>) TO '&WARCH.1'
					ENDTEXT

					&lcCommand

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Inde On Str(CODI9,<<gnCodi4>>)+Dtos((FECH9)) To '&WARCH.2'
					ENDTEXT

					&lcCommand

					Inde On Str(COMP9,2)+TIPO9+Str(SUCU9,2)+Str(NUME9,6) Tag "ItePK"

					Index On GRUP9+ARTI9 Tag ArtPK
					Index On GRUP9 Tag GRUP9
					Index On ARTI9 Tag ARTI9
					Index On FECH9 Tag FECH9
					Index On CODI9 Tag CODI9
					Index On COMP9 Tag COMP9
					Index On TIPO9 Tag TIPO9
					Index On SUCU9 Tag SUCU9
					Index On NUME9 Tag NUME9

					Try

						Index On Art_Id Tag Art_Id

					Catch To oErr

						If Empty( Field( "Art_Id" ) )
							Try
								Alter Table xx9Rem Add	Column Art_Id I
								If !Empty( Field( "ArtId" ) )
									Replace All Art_Id With ArtId
								Endif
								Index On Art_Id Tag Art_Id

							Catch To oErr

							Finally

							Endtry


						Endif


					Finally

					Endtry

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech9
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

					Try

						Index On Cab_Id Tag Cab_Id

					Catch To oErr
						If Empty( Field( "Cab_Id" ) )
							Try
								Alter Table xx9Rem Add Column Cab_Id I
								Index On Cab_Id Tag Cab_Id

							Catch To oErr

							Finally

							Endtry


						Endif

					Finally

					Endtry

					Try

						Index On Desp_Id Tag Desp_Id

					Catch To oErr
						If Empty( Field( "Desp_Id" ) )
							Try
								Alter Table xx9Rem Add	Column Desp_Id I
								If !Empty( Field( "DespId" ) )
									Replace All Desp_Id With DespId
								Endif
								Index On Desp_Id Tag Desp_Id

							Catch To oErr

							Finally

							Endtry


						Endif

					Finally

					Endtry

				Endif


			Endif


		Endif

	Endif

	If Type('cAR12APP')="C"
		If !Empty( cAR12APP ) .And. !&ABORTA
			WARCH=Trim(drvPed)+"AR12APP"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Thisform.Comprimir( cAR12APP )
				Wait Window 'REORDENANDO ARCHIVO DE APLICACIONES DE PEDIDOS' Nowait

				If Empty( Field( "Ite9Id" ) )
					Try

						TEXT To lcCommand NoShow TextMerge Pretext 15
						Alter Table ( Alias() ) Add	Column Ite9Id I
						ENDTEXT

						&lcCommand

					Catch To oErr
						Logerror( oErr.Message,;
							Lineno(1),;
							Alias() + " - " + lcCommand )

					Finally

					Endtry

				Endif

				If Empty( Field( "Ped9Id" ) )
					Try

						TEXT To lcCommand NoShow TextMerge Pretext 15
						Alter Table ( Alias() ) Add	Column Ped9Id I
						ENDTEXT

						&lcCommand

					Catch To oErr
						Logerror( oErr.Message,;
							Lineno(1),;
							Alias() + " - " + lcCommand )

					Finally

					Endtry

				Endif

				Index On Comp12 Tag Comp12
				Index On Tipo12 Tag Tipo12
				Index On Sucu12 Tag Sucu12
				Index On Nume12 Tag Nume12
				Index On Sucp12 Tag Sucp12
				Index On Pedi12 Tag Pedi12
				Index On Arti12 Tag Arti12
				Index On Clie12 Tag Clie12
				Index On FECH12 Tag FECH12
				Index On Ite9Id Tag Ite9Id
				Index On Ped9Id Tag Ped9Id

				TEXT To lcCommand NoShow TextMerge Pretext 15
				Update <<Alias()>> Set
						TS = Fech12
					Where Empty( TS )
				ENDTEXT

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS", lcCommand )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

				If Thisform.OrdenarPor( "Art_Id" ) = 1

					M_Use( 0, Trim(DrComun)+"AR1ART" )

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Update ar12App Set
							Art_Id = ar1Art.Id
						From ar1Art
						Where ar1Art.Grup1+ar1Art.Nume1 = Substr( ar12App.Arti12, 1, 14 )
					ENDTEXT

					&lcCommand

					Use In Select( "ar1Art" )


				Endif

			Endif


		Endif
	Endif


	If Type('cAR0PRN')="C"
		If !Empty( cAR0PRN ) .And. !&ABORTA
			WARCH=Trim(DrComun)+"AR0PRN"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Thisform.Comprimir( cAR0PRN )
				Wait Window 'REORDENANDO ARCHIVO DE COLAS DE IMPRESION' Nowait
				Inde On TERMI0+Str(CODI0,2) To '&WARCH.1'
			Endif


		Endif
	Endif


	If Type('cAR7COM')="C"
		If !Empty( cAR7COM ) .And. !&ABORTA
			If WCLAV$'AM'
				WARCH=Trim(DRVA)+'AR7COM'
				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Delete For Empty( Nume7 )
					Thisform.Comprimir( cAR7COM )
					Wait Window 'REORDENANDO ARCHIVO DE COMPRAS' Nowait
					Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,4)+Str(Nume7,8)+Str(CODI7,4);
						+CUIT7 To '&WARCH.1'
					Inde On Str(CODI7,4)+Dtos((FECH7)) To '&WARCH.2'
					Inde On Dtos((FECC7))+Dtos((FECH7))+Str(SUCU7,4)+Str(Nume7,8) To '&WARCH.3'
					Inde On Dtos((VENC7))+Str(CODI7,4) To '&WARCH.4'
					Inde On Str(SUCU7,4)+Str(NREC7,8)+Str(CODI7,4) To '&WARCH.5'
					Inde On CUE17+Dtos((FECC7))+Dtos((FECH7))+Str(SUCU7,4)+Str(Nume7,8) To '&WARCH.6'
					Inde On NEXA7 To '&WARCH.7'

					Try

						Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,4)+Str(Nume7,8)+Str(CODI7,4)+CUIT7 Tag pk7Com Candidate For !Deleted()

					Catch To oErr

						If oErr.ErrorNo = 1884 && Uniqueness of index pk7Com is violated.
							Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,4)+Str(Nume7,8)+Str(CODI7,4)+CUIT7 Tag pk7Com
							Logerror( oErr.Message,;
								Lineno(1),;
								Alias() + " - Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,4)+Str(NUME7,8)+Str(CODI7,4)+CUIT7 " )

						Else
							Throw oErr

						Endif
					Finally

					Endtry

					Index On COMP7 Tag COMP7
					Index On FECH7 Tag FECH7
					Index On CODI7 Tag CODI7
					Index On FECC7 Tag FECC7
					Index On NEXA7 Tag NEXA7

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech7
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )


				Endif



			Endif


			If WCLAV$'BM'
				WARCH=Trim(DRVD)+'XX7COM'
				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Delete For Empty( Nume7 )
					Thisform.Comprimir( cAR7COM )
					Wait Window '* REORDENANDO ARCHIVO DE COMPRAS *' Nowait
					Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,4)+Str(Nume7,8)+Str(CODI7,4);
						+CUIT7 To '&WARCH.1'
					Inde On Str(CODI7,4)+Dtos((FECH7)) To '&WARCH.2'
					Inde On Dtos((FECC7))+Dtos((FECH7))+Str(SUCU7,4)+Str(Nume7,8) To '&WARCH.3'
					Inde On Dtos((VENC7))+Str(CODI7,4) To '&WARCH.4'
					Inde On Str(SUCU7,4)+Str(NREC7,8)+Str(CODI7,4) To '&WARCH.5'
					Inde On CUE17+Dtos((FECC7))+Dtos((FECH7))+Str(SUCU7,4)+Str(Nume7,8) To '&WARCH.6'
					Inde On NEXA7 To '&WARCH.7'

					Try

						Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,4)+Str(Nume7,8)+Str(CODI7,4)+CUIT7 Tag pk7Com Candidate For !Deleted()

					Catch To oErr

						If oErr.ErrorNo = 1884 && Uniqueness of index pk7Com is violated.
							Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,4)+Str(Nume7,8)+Str(CODI7,4)+CUIT7 Tag pk7Com
							Logerror( oErr.Message,;
								Lineno(1),;
								Alias() + " - Inde On Str(COMP7,2)+TIPO7+Str(SUCU7,4)+Str(NUME7,8)+Str(CODI7,4)+CUIT7 " )

						Else
							Throw oErr

						Endif
					Finally

					Endtry

					Index On COMP7 Tag COMP7
					Index On FECH7 Tag FECH7
					Index On CODI7 Tag CODI7
					Index On FECC7 Tag FECC7
					Index On NEXA7 Tag NEXA7

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech7
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

				Endif


			Endif


		Endif

	Endif

	If Type('cAR12APC')="C"
		If !Empty( cAR12APC ) .And. !&ABORTA
			If WCLAV$'AM'
				WARCH=Trim(DRVA)+'AR12APC'
				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR12APC )
					Wait Window 'REORDENANDO ARCHIVO DE APLICACIONES DE CREDITOS' Nowait
					Inde On Str(COMD12,2)+TIPD12+Str(SUCD12,4)+Str(NUMD12,8)+;
						STR(CODI12,4)+CUIT12 To '&WARCH.1'
					Inde On Str(COMH12,2)+TIPH12+Str(SUCH12,4)+Str(NUMH12,8)+;
						STR(CODI12,4)+CUIT12 To '&WARCH.2'

					Index On FECH12 Tag FECH12
					Index On CODI12 Tag CODI12
					Index On COMD12 Tag COMD12
					Index On TIPD12 Tag TIPD12
					Index On SUCD12 Tag SUCD12
					Index On NUMD12 Tag NUMD12
					Index On COMH12 Tag COMH12
					Index On TIPH12 Tag TIPH12
					Index On SUCH12 Tag SUCH12
					Index On NUMH12 Tag NUMH12

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech12
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

				Endif


			Endif


			If WCLAV$'BM'
				WARCH=Trim(DRVD)+'XX12APC'
				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR12APC )
					Wait Window '* REORDENANDO ARCHIVO DE APLICACIONES DE CREDITOS *' Nowait
					Inde On Str(COMD12,2)+TIPD12+Str(SUCD12,4)+Str(NUMD12,8)+;
						STR(CODI12,4)+CUIT12 To '&WARCH.1'
					Inde On Str(COMH12,2)+TIPH12+Str(SUCH12,4)+Str(NUMH12,8)+;
						STR(CODI12,4)+CUIT12 To '&WARCH.2'

					Index On FECH12 Tag FECH12
					Index On CODI12 Tag CODI12
					Index On COMD12 Tag COMD12
					Index On TIPD12 Tag TIPD12
					Index On SUCD12 Tag SUCD12
					Index On NUMD12 Tag NUMD12
					Index On COMH12 Tag COMH12
					Index On TIPH12 Tag TIPH12
					Index On SUCH12 Tag SUCH12
					Index On NUMH12 Tag NUMH12

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech12
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )


				Endif


			Endif


		Endif

	Endif

	If Type('cAR12RET')="C"
		If !Empty(cAR12RET) .And. !&ABORTA
			If WCLAV$'AM'

				* Cerificados de Retencion de Ganancias
				WARCH=Trim(DRVA)+'AR12CRG'

				If !FileExist( WARCH + ".Dbf" )
					TEXT To lcCommand NoShow TextMerge Pretext 15
					Create Table "<<WARCH>>"Free (
						Cert12 I,
						Comp12 I,
						Tipo12 C(1),
						Sucu12 I,
						Nume12 I,
						Codi12 I,
						Rete12 N(12,2),
						Fech12 D )
					ENDTEXT

					&lcCommand

					Use In Select( "AR12CRG" )

				Endif

				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Delete For Empty( Cert12 )
					Thisform.Comprimir( cAR12RET )
					Wait Window 'REORDENANDO ARCHIVO DE APLICACIONES DE RETENCIONES DE GANANCIAS....' Nowait

					If Empty( Field( "Total_Neto" ) )
						Alter Table ar12Crg ;
							Add Column Total_Neto N(12,2)

						Alter Table ar12Crg ;
							Add Column Descuentos N(12,2)

						Alter Table ar12Crg ;
							Add Column Saldo_Ante N(12,2)

						Alter Table ar12Crg ;
							Add Column No_Imponib N(12,2)

						Alter Table ar12Crg ;
							Add Column Tasa N(06,2)

						Alter Table ar12Crg ;
							Add Column Ya_Retenid N(12,2)

						Alter Table ar12Crg ;
							Add Column Razon_Soci c(80)

						Alter Table ar12Crg ;
							Add Column Direccion c(80)

						Alter Table ar12Crg ;
							Add Column Cuit c(13)

					Endif

					Index On Cert12 Tag Cert12 Candidate For !Deleted()
					Index On Comp12 Tag Comp12
					Index On Tipo12 Tag Tipo12
					Index On Sucu12 Tag Sucu12
					Index On Nume12 Tag Nume12
					Index On CODI12 Tag CODI12
					Index On Cuit 	Tag Cuit

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech12
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )


				Endif

				WARCH=Trim(DRVA)+'AR12CRGdet'

				If !FileExist( WARCH + ".Dbf" )
					TEXT To lcCommand NoShow TextMerge Pretext 15
					Create Table "<<WARCH>>"Free (
						Cert12 I,
						Fecha D,
						Comprobant C(30),
						NetoGravad N(12,2) )
					ENDTEXT

					&lcCommand

					Use In Select( "AR12CRGdet" )

				Endif

				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Delete For Empty( Cert12 )
					Thisform.Comprimir( cAR12RET )

					Index On Cert12 Tag Cert12

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fecha
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )


				Endif

				* Cerificados de Retencion de IIBB
				WARCH=Trim(DRVA)+'AR12RetIB'

				If !FileExist( WARCH + ".Dbf" )
					TEXT To lcCommand NoShow TextMerge Pretext 15
						Create Table "<<WARCH>>" Free (
							Codi12 I,
							ComH12 I,
							TipH12 C(1),
							SucH12 I,
							NumH12 I,
							Juri12 I,
							Nume12 I,
							Apli12 N(12,2),
							Fech12 D,
							Base12 N(12,2),
							Alic12 N(6,2),
							ComD12 I,
							TipD12 C(1),
							SucD12 I,
							NumD12 I,
							TranId I )

					ENDTEXT

					&lcCommand

					Use In Select( "AR12RetIB" )

				Endif

				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All

					Thisform.Comprimir( cAR12RET )
					Wait Window 'REORDENANDO ARCHIVO DE APLICACIONES DE RETENCIONES DE IIBB....' Nowait

					Index On CODI12 Tag CODI12
					Index On COMH12 Tag COMH12
					Index On TIPH12 Tag TIPH12
					Index On SUCH12 Tag SUCH12
					Index On NUMH12 Tag NUMH12
					Index On JURI12 Tag JURI12
					Index On Nume12 Tag Nume12
					Index On FECH12 Tag FECH12
					Index On COMD12 Tag COMD12
					Index On TIPD12 Tag TIPD12
					Index On SUCD12 Tag SUCD12
					Index On NUMD12 Tag NUMD12

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech12
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )


				Endif


			Endif

		Endif
	Endif

	If Type('cAR4PLA')="C"
		If !Empty( cAR4PLA ) .And. !&ABORTA
			WARCH=Trim(DRVA)+"AR4PLA"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Thisform.Comprimir( cAR4PLA )
				Wait Window 'REORDENANDO PLAZOS FIJOS/GASTOS' Nowait
				Inde On Dtos((FECH4))+Str(BANC4,3)+Str(ORDE4,2) To '&WARCH.1'
				Inde On Str(BANC4,3)+Dtos((FECH4))+Str(ORDE4,2) To '&WARCH.2'

				TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech4
				Where Empty( TS )
				ENDTEXT

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS", lcCommand )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

			Endif


		Endif

	Endif


	If Type('cAR7PLA')="C"
		If !Empty( cAR7PLA ) .And. !&ABORTA
			WARCH=Trim(DRVA)+"AR7PLA"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Thisform.Comprimir( cAR7PLA )
				Wait Window 'REORDENANDO PLANILLAS' Nowait
				Inde On Uppe(NOMB7) To '&WARCH.1'

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS" )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

			Endif


		Endif

	Endif



	If Type('cAR7Ped')="C"
		If !Empty( cAR7Ped ) .And. !&ABORTA
			WARCH=Trim(drvPed)+"AR7Ped"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Delete For Empty( Nume7 )
				Thisform.Comprimir( cAR7Ped )
				Wait Window 'REORDENANDO ARCHIVO DE PEDIDOS (CABECERA)' Nowait

				If Empty( Field( "Esta7" ) )
					Alter Table ar7Ped Add Column Esta7 I
				Endif

				Index On Str( COMP7, 2 ) + Str( SUCU7, 4 ) + Str( Nume7, 8 ) Tag PedPK

				Index On COMP7 Tag COMP7
				Index On SUCU7 Tag SUCU7
				Index On Nume7 Tag Nume7
				Index On CODI7 Tag CODI7
				Index On FECH7 Tag FECH7
				Index On FENT7 Tag FENT7

				TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech7
				Where Empty( TS )
				ENDTEXT

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS", lcCommand )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )


			Endif
		Endif
	Endif


	If Type('cAR9Ped')="C"
		If !Empty( cAR9Ped ) .And. !&ABORTA
			WARCH=Trim(drvPed)+"AR9Ped"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Thisform.Comprimir( cAR9Ped )
				Wait Window 'REORDENANDO ARCHIVO DE PEDIDOS (ITEM)' Nowait

				Index On Id Tag Id Candidate For !Deleted() And !Empty( Id )
				Index On Cab_Id Tag Cab_Id
				Index On Art_Id Tag Art_Id
				Index On FENT9 Tag FENT9
				
				If GetValue("CodStock", "ar0Art", "N" ) = "S"
					Thisform.VerificarCampo( "ArtSt_Id" )
					Index On ArtSt_Id Tag ArtSt_Id
				EndIf

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS" )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )


			Endif
		Endif
	Endif

	If Type('cAR7Presu')="C"
		If !Empty( cAR7Presu ) .And. !&ABORTA
			WARCH=Trim(DRVA)+"AR7Presu"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All

				Delete For Empty( Nume7 )

				Thisform.Comprimir( cAR7Presu )
				Wait Window 'REORDENANDO ARCHIVO DE PRESUPUESTOS (CABECERA)' Nowait

				TEXT To lcCommand NoShow TextMerge Pretext 15
				Update <<Alias()>> Set
						TS = Fech7
					Where Empty( TS )
				ENDTEXT

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS", lcCommand )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

				Index On Str( COMP7, 2 ) + Str( SUCU7, 4 ) + Str( Nume7, 8 ) Tag PresuPK Candidate For !Deleted()

				Index On COMP7 Tag COMP7
				Index On SUCU7 Tag SUCU7
				Index On Nume7 Tag Nume7
				Index On CODI7 Tag CODI7
				Index On FECH7 Tag FECH7

			Endif
		Endif
	Endif


	If Type('cAR9Presu')="C"
		If !Empty( cAR9Presu ) .And. !&ABORTA
			WARCH=Trim(DRVA)+"AR9Presu"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All

				Thisform.Comprimir( cAR9Presu )
				Wait Window 'REORDENANDO ARCHIVO DE PRESUPUESTOS (ITEM)' Nowait

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS" )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

				Try

					Index On Cab_Id Tag Cab_Id

				Catch To oErr
					If Empty( Field( "Cab_Id" ) )
						Try
							Alter Table ar9Presu Add Column Cab_Id I

							M_Use( 0, Trim(DRVA)+"ar7Presu" )

							TEXT To lcCommand NoShow TextMerge Pretext 15
							Update ar9Presu Set
									Cab_Id = ar7Presu.Id
								From ar7Presu
								Where Str( ar7Presu.COMP7, 2 ) + Str( ar7Presu.SUCU7, 4 ) + Str( ar7Presu.Nume7, 8 ) = Where Str( ar9Presu.COMP9, 2 ) + Str( ar9Presu.SUCU9, 4 ) + Str( ar9Presu.Nume9, 8 )
							ENDTEXT

							&lcCommand

							Index On Cab_Id Tag Cab_Id

						Catch To oErr

						Finally

						Endtry


					Endif

				Finally

				Endtry


				Try

					Index On Art_Id Tag Art_Id

				Catch To oErr

					Try
						Alter Table ar9Presu Add	Column Art_Id I
						M_Use( 0, Trim(DrComun)+"AR1ART" )

						TEXT To lcCommand NoShow TextMerge Pretext 15
						Update ar9Presu Set
								Art_Id = ar1Art.Id
							From ar1Art
							Where ar1Art.Grup1+ar1Art.Nume1 = ar9Presu.GRUP9+ar9Presu.ARTI9
						ENDTEXT

						&lcCommand

						Use In Select("ar1Art")

						Select ar9Presu


						Index On Art_Id Tag Art_Id


					Catch To oErr

					Finally

					Endtry


				Finally

				Endtry


			Endif
		Endif
	Endif

	If Type('cAR7PRE')="C"
		If !Empty(cAR7PRE) .And. !&ABORTA
			WARCH=Trim(DRVA)+"AR7PRE"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Thisform.Comprimir( cAR7PRE )
				Wait Window 'Reordenando archivo de PRESUPUESTOS' Nowait
				Inde On Nume7 To '&WARCH.1'
				Inde On Str(CODI7,4)+Dtos((FECH7)) To '&WARCH.2'

				TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech7
				Where Empty( TS )
				ENDTEXT

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS", lcCommand )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

			Endif

		Endif
	Endif

	If Type('cAR9IPR')="C"
		If !Empty(cAR9IPR) .And. !&ABORTA
			WARCH=Trim(DRVA)+"AR9IPR"
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Thisform.Comprimir( cAR9IPR )
				Wait Window 'Reordenando archivo de ITEMS DE PRESUPUESTOS' Nowait
				Inde On Str(NUME9,6)+Str(CODI9,4) To '&WARCH.1'
				Inde On Str(CODI9,4)+GRUP9+ARTI9+Dtos((FECH9)) To '&WARCH.2'
				Inde On GRUP9+ARTI9+Dtos((FECH9))+Str(CODI9,4) To '&WARCH.3'

				TEXT To lcCommand NoShow TextMerge Pretext 15
				Update <<Alias()>> Set
						TS = Fech9
					Where Empty( TS )
				ENDTEXT

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS", lcCommand )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

			Endif

		Endif
	Endif



	If Type('cAR15PED')="C"
		If !Empty( cAR15PED ) .And. !&ABORTA
			WARCH=Trim(drvPed)+'AR15PED'
			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Thisform.Comprimir( cAR15PED )
				Wait Window 'REORDENANDO ARCHIVO DE PEDIDOS' Nowait
				Inde On Str(SUCU15,4)+Str(NUME15,8) To '&WARCH.1'

				TEXT To lcCommand NoShow TextMerge Pretext 15
				Inde On ARTI15+Str(CLIE15, <<gnCodi4>> )+Dtos((FECH15)) To '&WARCH.2'
				ENDTEXT

				&lcCommand

				Inde On ARTI15+Dtos((FECH15))+Str(NUME15,8) To '&WARCH.3'

				TEXT To lcCommand NoShow TextMerge Pretext 15
				Inde On Str(CLIE15, <<gnCodi4>> )+ARTI15 To '&WARCH.4'
				ENDTEXT

				&lcCommand



				TEXT To lcCommand NoShow TextMerge Pretext 15
				Inde On ARTI15+Str(CLIE15, <<gnCodi4>> )+Str( -Val( Dtos((FECH15))),9 ) To '&WARCH.5'
				ENDTEXT

				&lcCommand


				TEXT To lcCommand NoShow TextMerge Pretext 15
				Inde On Str(CLIE15, <<gnCodi4>> )+Dtos((FECH15))+Str(SUCU15,4)+Str(NUME15,8) To '&WARCH.6'
				ENDTEXT

				&lcCommand

				Inde On Str(VEND15,4)+Dtos((FECH15))+Str(SUCU15,4)+Str(NUME15,8) To '&WARCH.7'

				Index On Str(SUCU15,4)+Str(NUME15,8) Tag PedPK

				TEXT To lcCommand NoShow TextMerge Pretext 15
				Inde On ARTI15+Str(CLIE15, <<gnCodi4>> )+Dtos((FECH15)) Tag Descarga
				ENDTEXT

				&lcCommand


				TEXT To lcCommand NoShow TextMerge Pretext 15
				Inde On ARTI15+Str(CLIE15, <<gnCodi4>> )+Dtos((ENTR15)) Tag Carga
				ENDTEXT

				&lcCommand

				Index On SUCU15 Tag SUCU15
				Index On NUME15 Tag NUME15
				Index On ARTI15 Tag ARTI15
				Index On Clie15 Tag Clie15
				Index On FECH15 Tag FECH15
				Index On Entr15 Tag Entr15
				Index On VEND15 Tag VEND15

				TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech15
				Where Empty( TS )
				ENDTEXT

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS", lcCommand )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

			Endif


		Endif

	Endif

	If Type('cAR12APR')="C"
		If !Empty( cAR12APR ) .And. !&ABORTA

			WARCH=Trim(DRVA)+'AR12APR'

			If !FileExist( WARCH + ".Dbf" )
				TEXT To lcCommand NoShow TextMerge Pretext 15
					Create Table "<<WARCH>>"Free (
						Comf12 I,
						Tipf12 C(1),
						Sucf12 I,
						Numf12 I,
						Codi12 I,
						Fech12 D,
						Comr12 I,
						Tipr12 C(1),
						Sucr12 I,
						Numr12 I,
						TranId I )
				ENDTEXT

				&lcCommand

				Use In Select( "AR12APR" )

			Endif

			If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
				Delete Tag All
				Thisform.Comprimir( cAR12APR )
				Wait Window 'REORDENANDO ARCHIVO DE REMITOS/FACTURAS' Nowait
				Inde On Str(COMF12,2)+TIPF12+Str(SUCF12,2)+Str(NUMF12,6) To '&WARCH.1'
				Inde On Str(COMR12,2)+TIPR12+Str(SUCR12,2)+Str(NUMR12,6) To '&WARCH.2'

				TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech12
				Where Empty( TS )
				ENDTEXT

				Thisform.OrdenarPor( "Id" )
				Thisform.OrdenarPor( "TS", lcCommand )
				Thisform.OrdenarPor( "UTS", "Default" )
				Thisform.OrdenarPor( "TranId" )

			Endif


			If WCLAV$'BM'
				WARCH=Trim(DRVD)+"XX12APR"

				If !FileExist( WARCH + ".Dbf" )

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Create Table "<<WARCH>>"Free (
						Comf12 I,
						Tipf12 C(1),
						Sucf12 I,
						Numf12 I,
						Codi12 I,
						Fech12 D,
						Comr12 I,
						Tipr12 C(1),
						Sucr12 I,
						Numr12 I,
						TranId I )
					ENDTEXT

					&lcCommand

					Use In Select( "XX12APR" )

				Endif

				If M_FILE(0,.T.,.T.,'U',WARCH,.T.)
					Delete Tag All
					Thisform.Comprimir( cAR12APR )
					Wait Window 'REORDENANDO ARCHIVO DE REMITOS/FACTURAS' Nowait
					Inde On Str(COMF12,2)+TIPF12+Str(SUCF12,2)+Str(NUMF12,6) To '&WARCH.1'
					Inde On Str(COMR12,2)+TIPR12+Str(SUCR12,2)+Str(NUMR12,6) To '&WARCH.2'

					TEXT To lcCommand NoShow TextMerge Pretext 15
			Update <<Alias()>> Set
					TS = Fech12
				Where Empty( TS )
					ENDTEXT

					Thisform.OrdenarPor( "Id" )
					Thisform.OrdenarPor( "TS", lcCommand )
					Thisform.OrdenarPor( "UTS", "Default" )
					Thisform.OrdenarPor( "TranId" )

				Endif

			Endif

		Endif
	Endif


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )

Finally
	loArticulo = Null
	Thisform.Reset()

Endtry

ENDPROC
PROCEDURE reset
Local array laTables[1]
Local lnLen as Integer
Local i as Integer

Try


	* Vaciar Grilla
	Thisform.grdArchivos.Archivos.ControlSource = ""
	Thisform.grdArchivos.Seleccion.ControlSource = ""
	Thisform.grdArchivos.RecordSource = ""

	lnLen = AUsed( laTables )
	
	For i = 1 to lnLen
		Use in ( laTables[ i, 1 ] )
	EndFor


	Thisform.cStatus = ""

	Thisform.cmdCancelar.FontBold = .F.
	Thisform.CmdAceptar.FontBold = .F.

	Thisform.cmdCancelar.FontItalic = .F.
	Thisform.CmdAceptar.FontItalic = .F.


	* Sincronizar Botones
	
	ThisForm.chkGlobal.Enabled = .F.
	ThisForm.chkGlobal.Value = .F.

	Thisform.OptionGroup.Enabled = .T.
	Thisform.cmdCancelar.Enabled = .T.
	Thisform.cmdAceptar.Enabled = .F.

	Thisform.cmdCargar.Enabled = .T.
	Thisform.cmdCargar.SetFocus()


Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )

Finally
	Use In Select( Thisform.cCursorName )

Endtry

ENDPROC
PROCEDURE synchronizebuttons
Lparameters uTag As Variant

Local lcCommand As String

Try

	lcCommand = ""

	If Vartype( uTag ) == "C"

		If Thisform.lIngTipActivo
			Thisform.SetAll( "Enabled", .F. )
			Thisform.Enabled = .T.
			Thisform.CmdAceptar.Enabled = .T.
			Thisform.CmdCancelar.Enabled = .T.

		Else
			Thisform.SetAll( "Enabled", .T. )
			Thisform.CmdAceptar.Enabled = .F.
			Thisform.cmdCargar.SetFocus()
			
		Endif
	Endif

Catch To oErr
	Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.cRemark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE verificarcampo
Lparameters cFieldName As String

Local lcCommand As String

Try

	lcCommand = ""
	If Vartype( cFieldName ) # "C"
		cFieldName = ""
	Endif

	Do Case
		Case Upper( cFieldName ) = "TRANID"
			If Empty( Field( cFieldName ) )
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Alter Table ( Alias() ) Add	Column TranId I
					ENDTEXT

					&lcCommand

				Catch To oErr
					Logerror( oErr.Message,;
						Lineno(1),;
						Alias() + " - " + lcCommand )

				Finally

				Endtry

			EndIf
	
		Case Upper( cFieldName ) = "TS"
			If Empty( Field( cFieldName ) )
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Alter Table ( Alias() ) Add	Column TS D
					ENDTEXT

					&lcCommand

				Catch To oErr
					Logerror( oErr.Message,;
						Lineno(1),;
						Alias() + " - " + lcCommand )

				Finally

				Endtry

			Endif
	
		Case Upper( cFieldName ) = "UTS"
			If Empty( Field( cFieldName ) )
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Alter Table ( Alias() ) Add	Column UTS D
					ENDTEXT

					&lcCommand

				Catch To oErr
					Logerror( oErr.Message,;
						Lineno(1),;
						Alias() + " - " + lcCommand )

				Finally

				Endtry

			Endif

		Case Upper( cFieldName ) = "CAE7"
			If Empty( Field( cFieldName ) )
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Alter Table ( Alias() ) Add	Column Cae7 C(14)
					ENDTEXT

					&lcCommand

				Catch To oErr
					Logerror( oErr.Message,;
						Lineno(1),;
						Alias() + " - " + lcCommand )

				Finally

				Endtry

			Endif

		Case Upper( cFieldName ) = "NOMF7"
			If Empty( Field( cFieldName ) )
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Alter Table ( Alias() ) Add	Column Nomf7 C(60)
					ENDTEXT

					&lcCommand

				Catch To oErr
					Logerror( oErr.Message,;
						Lineno(1),;
						Alias() + " - " + lcCommand )

				Finally

				Endtry

			Endif

		Case Upper( cFieldName ) = "CODIGOCOMP"
			If Empty( Field( cFieldName ) )
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Alter Table ( Alias() ) Add	Column CodigoComp I
					ENDTEXT

					&lcCommand

				Catch To oErr
					Logerror( oErr.Message,;
						Lineno(1),;
						Alias() + " - " + lcCommand )

				Finally

				Endtry

			EndIf
			
		Case Upper( cFieldName ) = "CGOBARRA"
			If Empty( Field( cFieldName ) )
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Alter Table ( Alias() ) Add	Column CgoBarra C(40)
					ENDTEXT

					&lcCommand

				Catch To oErr
					Logerror( oErr.Message,;
						Lineno(1),;
						Alias() + " - " + lcCommand )

				Finally

				Endtry

			Endif
			
		Case Upper( cFieldName ) = "VENCCAE"
			If Empty( Field( cFieldName ) )
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Alter Table ( Alias() ) Add	Column VencCae D
					ENDTEXT

					&lcCommand

				Catch To oErr
					Logerror( oErr.Message,;
						Lineno(1),;
						Alias() + " - " + lcCommand )

				Finally

				Endtry

			EndIf
			
		Case Upper( cFieldName ) = "CPOS7"
			If Empty( Field( cFieldName ) )
				Try

					TEXT To lcCommand NoShow TextMerge Pretext 15
					Alter Table ( Alias() ) Add	Column Cpos7 C(8)
					ENDTEXT

					&lcCommand

				Catch To oErr
					Logerror( oErr.Message,;
						Lineno(1),;
						Alias() + " - " + lcCommand )

				Finally

				Endtry

			Endif
			


	Endcase

Catch To loErr
	Local loError As ErrorHandler Of 'Tools\ErrorHandler\Prg\ErrorHandler.prg'
	loError = _NewObject ( 'ErrorHandler', 'ErrorHandler\Prg\ErrorHandler.prg' )
	loError.cRemark = lcCommand
	loError.Process ( m.loErr )
	Throw loError

Finally


Endtry

ENDPROC
PROCEDURE wclav_assign
Lparameters tWCLAV

This.WCLAV = tWCLAV
This.cStatus = tWCLAV

If Inlist( tWCLAV, "A", "B", "M" )
	Thisform.lIngTipActivo = .F.

	Do Case
		Case tWCLAV = "B"
			Thisform.Caption = "* " + Thisform.Caption

		Case tWCLAV = "M"
			Thisform.Caption = "** " + Thisform.Caption
			
		Otherwise

	Endcase
Endif


ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
13[END RESERVED2]
[START RESERVED3]
_memberdata XML Metadata for customizable properties
nopcion
ccursorname
nfirst
nsecond
cstatus
wclav
lingtip Indica si llama a I_IngTip
lingtipactivo
loldkeypreview
ningtip1 Primera Tecla
ningtip2 Segunda Tecla
ningtipaction 1: A,B ; 2; A,B,M
ningtipstatus
*cancelar 
*cargararchivos 
*process 
*reset Resets the Timer control so that it starts counting from 0.
*assigningtip 
*pack 
*comprimir 
*globalselection 
*hookbeforecargararchivos 
*hookaftercargararchivos 
*wclav_assign 
*lingtipactivo_assign 
*synchronizebuttons 
*i_ingtip 
*ordenarpor 
*verificarcampo 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53DL
[CLASS] grid
[BASECLASS] grid
[OBJNAME] grdArchivos
[PARENT] frmindexa
[START PROPERTIES]
ColumnCount = 2
AllowHeaderSizing = .F.
AllowRowSizing = .F.
DeleteMark = .F.
GridLines = 1
HeaderHeight = 24
Height = 312
Left = 12
RecordMark = .F.
ScrollBars = 2
TabIndex = 2
Top = 72
Width = 372
HighlightStyle = 2
AllowAutoColumnFit = 2
Name = "grdArchivos"
Column1.Width = 300
Column1.ReadOnly = .T.
Column1.Sparse = .F.
Column1.Name = "Archivos"
Column2.CurrentControl = "Check"
Column2.Width = 48
Column2.Sparse = .F.
Column2.Name = "Seleccion"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53E1
[CLASS] header
[BASECLASS] header
[OBJNAME] Header1
[PARENT] frmindexa.grdArchivos.Archivos
[START PROPERTIES]
Alignment = 2
Caption = "Archivos"
Name = "Header1"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53E2
[CLASS] textbox
[BASECLASS] textbox
[OBJNAME] Text1
[PARENT] frmindexa.grdArchivos.Archivos
[START PROPERTIES]
BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
[END PROPERTIES]
[START METHODS]
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

#INCLUDE "FW\Comunes\Include\Praxis.h"

Do Case
	Case nShiftAltCtrl = 0
		Do Case
			Case nKeyCode = KEY_BARRA_ESPACIADORA
				*This.Parent.Parent.Seleccion.Check.Value = !This.Parent.Parent.Seleccion.Check.Value
				Replace TIPOTR With !TIPOTR
				Skip
				If Eof()
					Go Bottom
				Endif
				Thisform.grdArchivos.Refresh()

			Otherwise
				DoDefault( nKeyCode, nShiftAltCtrl )
		Endcase

	Otherwise
		DoDefault( nKeyCode, nShiftAltCtrl )

Endcase

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53EG
[CLASS] header
[BASECLASS] header
[OBJNAME] Header1
[PARENT] frmindexa.grdArchivos.Seleccion
[START PROPERTIES]
FontName = "Wingdings 2"
Alignment = 2
Caption = "P"
Name = "Header1"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53EH
[CLASS] textbox
[BASECLASS] textbox
[OBJNAME] Text1
[PARENT] frmindexa.grdArchivos.Seleccion
[START PROPERTIES]
BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53EI
[CLASS] checkbox
[BASECLASS] checkbox
[OBJNAME] Check
[PARENT] frmindexa.grdArchivos.Seleccion
[START PROPERTIES]
Top = 60
Left = 312
Height = 17
Width = 20
Alignment = 2
Caption = ""
Value = .F.
Name = "Check"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Skip
If Eof()
	Skip -1
	Thisform.grdArchivos.Refresh()
*	Go Bottom
Endif
Thisform.grdArchivos.Refresh()

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53EJ
[CLASS] optiongroup
[BASECLASS] optiongroup
[OBJNAME] OptionGroup
[PARENT] frmindexa
[START PROPERTIES]
ButtonCount = 2
Value = 1
Height = 48
Left = 12
Top = 12
Width = 108
TabIndex = 6
Visible = .F.
Name = "OptionGroup"
Option1.Caption = "Actual"
Option1.Value = 1
Option1.Height = 17
Option1.Left = 5
Option1.Top = 5
Option1.Width = 51
Option1.AutoSize = .T.
Option1.Name = "Actual"
Option2.Caption = "Histórico"
Option2.Height = 17
Option2.Left = 5
Option2.Top = 24
Option2.Width = 67
Option2.AutoSize = .T.
Option2.Name = "Historico"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Thisform.nOpcion = This.Value
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53EK
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdCargar
[PARENT] frmindexa
[START PROPERTIES]
Top = 12
Left = 12
Height = 48
Width = 204
FontBold = .T.
FontSize = 12
WordWrap = .T.
Caption = "Cargar Archivos"
TabIndex = 1
Name = "cmdCargar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.HookBeforeCargarArchivos()
Thisform.CargarArchivos()
Thisform.HookAfterCargarArchivos()
ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

*!*	Do Case
*!*		Case InList( Thisform.cStatus, "A", "B", "M" )
*!*			* No hacer Nada
*!*			
*!*		Case Inlist( nKeyCode, F9, F10 )
*!*			If Thisform.nFirst = 0
*!*				Thisform.nFirst = nKeyCode

*!*			Else
*!*				Thisform.nSecond = nKeyCode
*!*				If !Inlist( Thisform.nFirst, F9, F10 )
*!*					Thisform.nFirst = 0
*!*					Thisform.nSecond = 0

*!*				EndIf
*!*				Thisform.AssignIngtip()


*!*			Endif


*!*		Otherwise
*!*			Thisform.nFirst = 0
*!*			Thisform.nSecond = 0
*!*			Thisform.AssignIngtip()
*!*	Endcase

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53EL
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdCancelar
[PARENT] frmindexa
[START PROPERTIES]
Top = 396
Left = 12
Height = 24
Width = 84
Picture = ..\..\fw\comunes\image\bmp\close.bmp
Cancel = .T.
Caption = "Cancelar"
TabIndex = 7
PicturePosition = 1
Name = "cmdCancelar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Cancelar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53EM
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdAceptar
[PARENT] frmindexa
[START PROPERTIES]
AutoSize = .T.
Top = 396
Left = 269
Height = 27
Width = 116
Picture = ..\..\fw\comunes\image\bmp\ok.bmp
Caption = "Ingresar Datos"
TabIndex = 3
PicturePosition = 1
Name = "cmdAceptar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
If Thisform.lIngTipActivo
	Thisform.WCLAV = "A"

Else
	Thisform.Process()
	Wait Clear
	Inform( "Proceso Terminado" )

Endif




ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2T10VM7KL
[CLASS] checkbox
[BASECLASS] checkbox
[OBJNAME] chkPack
[PARENT] frmindexa
[START PROPERTIES]
Top = 12
Left = 228
Height = 17
Width = 156
Alignment = 0
Caption = "Comprimir los Archivos"
Value = .F.
TabIndex = 4
Name = "chkPack"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2U513UE2C
[CLASS] checkbox
[BASECLASS] checkbox
[OBJNAME] chkGlobal
[PARENT] frmindexa
[START PROPERTIES]
Top = 43
Left = 228
Height = 17
Width = 111
AutoSize = .T.
Alignment = 0
Caption = "Selección Global"
Value = .F.
TabIndex = 5
Name = "chkGlobal"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Thisform.GlobalSelection( This.Value )
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] frmindexa
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
Wingdings 2, 0, 9, 10, 14, 11, 13, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
[END PROPERTIES]
[START RESERVED1]
 ! ..\..\fw\comunes\include\praxis.h}s~\V! ..\..\fw\comunes\include\foxpro.h~ÊrûF" ..\..\fw\comunes\include\strings.hZŠOJ' ..\..\tools\namespaces\include\system.h&€±ÙF[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53D5
[CLASS] form
[BASECLASS] form
[OBJNAME] frmmenus
[START PROPERTIES]
Height = 432
Width = 697
ShowWindow = 2
DoCreate = .T.
AutoCenter = .T.
Caption = "Administración de Menues"
Closable = .F.
MaxButton = .F.
MinButton = .F.
WindowType = 1
_memberdata =     1255<VFPData><memberdata name="cancelar" display="Cancelar"/><memberdata name="cargararchivos" display="CargarArchivos"/><memberdata name="process" display="Process"/><memberdata name="nopcion" display="nOpcion"/><memberdata name="reset" display="Reset"/><memberdata name="ccursorname" display="cCursorName"/><memberdata name="nfirst" display="nFirst"/><memberdata name="nsecond" display="nSecond"/><memberdata name="assigningtip" display="AssignIngtip"/><memberdata name="cstatus" display="cStatus"/><memberdata name="pack" display="Pack"/><memberdata name="comprimir" display="Comprimir"/><memberdata name="globalselection" display="GlobalSelection"/><memberdata name="hookbeforecargararchivos" display="HookBeforeCargarArchivos"/><memberdata name="hookaftercargararchivos" display="HookAfterCargarArchivos"/><memberdata name="cargarmenues" type="property" display="CargarMenues"/><memberdata name="creargrilla" type="method" display="CrearGrilla"/><memberdata name="modificado" type="method" display="Modificado"/><memberdata name="csetmultilocks" type="property" display="cSetMultilocks"/><memberdata name="ncbomenulistindex" type="property" display="nCboMenuListIndex"/><memberdata name="limpiargrilla" type="method" display="LimpiarGrilla"/></VFPData>

nopcion = 1
ccursorname = 
nfirst = 0
nsecond = 0
cstatus = 
csetmultilocks = 
ncbomenulistindex = 0
Name = "frmmenus"
[END PROPERTIES]
[START METHODS]
PROCEDURE Destroy
Local lcSetMultilocks As String
Local lcCommand As String

Try

	Set Sysmenu Automatic

	If Set("Multilocks") # Thisform.cSetMultilocks
		TEXT To lcCommand NoShow TextMerge Pretext 15
		Set Multilocks <<Thisform.cSetMultilocks>>
		ENDTEXT

		&lcCommand

	Endif



Catch To oErr
*!*		Local loError As PrxErrorHandler Of "fw\ErrorHandler\prxErrorHandler.prg"

*!*		loError = Newobject( "PrxErrorHandler", "prxErrorHandler.prg" )
*!*		loError.Process( oErr )

Finally

Endtry





ENDPROC
PROCEDURE Init
Local llOk As Boolean

Try

	This.cSetMultilocks = Set("Multilocks")
	
	Set Multilocks ON
	Set Sysmenu Off

	llOk = .T.

	Thisform.Icon = _Screen.Icon

	Thisform.cmdAceptar.Enabled = .F.
	ThisForm.cmdCargar.Enabled = .F.
	
	ThisForm.lblGlobal.Enabled = .F.
	ThisForm.Chk0.Enabled = .F.
	ThisForm.Chk1.Enabled = .F.
	ThisForm.Chk2.Enabled = .F.
	ThisForm.Chk3.Enabled = .F.
	ThisForm.Chk4.Enabled = .F.
	ThisForm.Chk5.Enabled = .F.
	
	Thisform.CrearGrilla()
	Thisform.CargarMenues()

Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	llOk = .F.
	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )

Finally
	Use In Select( "cTemp" )

Endtry

Return llOk






ENDPROC
PROCEDURE Load
Close Databases all


	Restore From "s:\Fenix\DatosFH\FH2008\ARPARAME.MEM"
	
	CLAVE = "A"

ENDPROC
PROCEDURE assigningtip
Try

	Do Case
		Case Thisform.nFirst = F9
			Thisform.cStatus = "B"

			Thisform.cmdCancelar.FontBold = .T.
			Thisform.CmdAceptar.FontBold = .T.


		Case Thisform.nFirst = F10
			Thisform.cStatus = "M"
			Thisform.cmdCancelar.FontBold = .T.
			Thisform.CmdAceptar.FontBold = .T.

			Thisform.cmdCancelar.FontItalic = .T.
			Thisform.CmdAceptar.FontItalic = .T.

		Otherwise
			Thisform.cStatus = "A"

	Endcase


Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

Endtry

ENDPROC
PROCEDURE cancelar
Local llExit As Boolean
Local lcMsg as String

Try

	llExit = .T.

	If This.Modificado( Thisform.cCursorName )
		Text To lcMsg NoShow TextMerge Pretext 03
		Se perderan los cambios realizados
		
		¿Confirma salir sin grabar?
		EndText

		llExit = Confirm( lcMsg, Thisform.Caption, .F. )

	Endif

	If llExit
		Use In Select( Thisform.cCursorName )
		Thisform.Release()

	Endif



Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

Endtry

ENDPROC
PROCEDURE cargararchivos
Local lcMnu As Character
Local lcMenusFolder As String,;
	lcFileName As String
Local lcCommand As String
Local i As Integer
Local loGrid As Grid

Try

	lcCommand = ""

	Thisform.cCursorName = ""

	Use In Select( Thisform.cCursorName )
	Use In Select( "MenuDBF" )

	loGrid =  Thisform.grdOpciones

	loGrid.Opcion.ControlSource = ""

	For i = 0 To 5
		TEXT To lcCommand NoShow TextMerge Pretext 15
		loGrid.Nivel<<i>>.ControlSource = ""
		ENDTEXT

		&lcCommand

	Endfor

	loGrid.RecordSource = ""


	* Abrir archivo de Menu
	lcMenusFolder 	= Addbs( Alltrim( GetValue( "RutaMenues", "ar0Var", "S:\Fenix\Ejecutable\Datos\" ) ))
	lcFileName 		= Thisform.cboMenus.List[ ThisForm.cboMenus.ListIndex, 2 ]
	lcMnu  			= Thisform.cboMenus.List[ ThisForm.cboMenus.ListIndex, 3 ]

	Use ( lcMenusFolder + lcFileName ) Alias MenuDBF Shared In 0

	TEXT To lcCommand NoShow TextMerge Pretext 15
		Select 	Recno() as Registro,
				m<<lcMnu>>Des as Descripcion,
				m<<lcMnu>>Nom as Nombre,
				m<<lcMnu>>Cl0 as Nivel0,
				m<<lcMnu>>Cl1 as Nivel1,
				m<<lcMnu>>Cl2 as Nivel2,
				m<<lcMnu>>Cl3 as Nivel3,
				m<<lcMnu>>Cl4 as Nivel4,
				m<<lcMnu>>Cl5 as Nivel5
			From <<lcMenusFolder>><<lcFileName>>
			Where !Empty( m<<lcMnu>>Des )
			Into Cursor cMenuDBF
	ENDTEXT

	&lcCommand

	TEXT To lcCommand NoShow TextMerge Pretext 15
		Select * From (
		Select 	Registro,
				000 as Padre,
				000 as Abuelo,
				Descripcion,
				Nombre,
				Nivel0,
				Nivel1,
				Nivel2,
				Nivel3,
				Nivel4,
				Nivel5
			From cMenuDBF
			Where Between( Registro, 1, 9 )
		Union
		Select 	Registro,
				Int( Registro / 10 ) as Padre,
				Int( Registro / 100 ) as Abuelo,
				Descripcion,
				Nombre,
				Nivel0,
				Nivel1,
				Nivel2,
				Nivel3,
				Nivel4,
				Nivel5
			From cMenuDBF
			Where Between( Registro, 10, 99 )
		Union
		Select 	Registro,
				Int( Registro / 10 ) as Padre,
				Int( Registro / 100 ) Abuelo,
				Descripcion,
				Nombre,
				Nivel0,
				Nivel1,
				Nivel2,
				Nivel3,
				Nivel4,
				Nivel5
			From cMenuDBF
			Where Between( Registro, 100, 999 ) ) t1
		Where !Empty( Nombre )
		Into Cursor cProgramas ReadWrite
	ENDTEXT

	&lcCommand

	TEXT To lcCommand NoShow TextMerge Pretext 15
		Select 	Padr( Nvl( Alltrim( m1.Descripcion )  + " - ", "" ) + Nvl( Alltrim( m2.Descripcion ) + " - ", "" ) + Nvl( Alltrim( p.Descripcion ), "" ), 60 ) as Referencia,
				p.Nivel0,
				p.Nivel1,
				p.Nivel2,
				p.Nivel3,
				p.Nivel4,
				p.Nivel5,
				p.Registro,
				Padr( Transform( p.Registro ), 3, "0" ) as Orden
			From cProgramas p
			Left Outer Join cMenuDBF m2
				On m2.Registro = p.Padre
			Left Outer Join cMenuDBF m1
				On m1.Registro = Iif( !Empty( p.Abuelo ), p.Abuelo, 0 )
			Order By Orden
			Into Cursor c<<lcFileName>> ReadWrite
	ENDTEXT

	&lcCommand

	Thisform.cCursorName = Alias()

	CursorSetProp("Buffering", 5, Thisform.cCursorName )

	loGrid.Opcion.ControlSource = Thisform.cCursorName + ".Referencia"

	For i = 0 To 5
		TEXT To lcCommand NoShow TextMerge Pretext 15
		loGrid.Nivel<<i>>.ControlSource = "c<<lcFileName>>.Nivel<<i>>"
		ENDTEXT

		&lcCommand

	Endfor

	loGrid.RecordSource = Thisform.cCursorName

	ThisForm.lblGlobal.Enabled = .T.
	ThisForm.Chk0.Enabled = .T.
	ThisForm.Chk1.Enabled = .T.
	ThisForm.Chk2.Enabled = .T.
	ThisForm.Chk3.Enabled = .T.
	ThisForm.Chk4.Enabled = .T.
	ThisForm.Chk5.Enabled = .T.


	loGrid.Refresh()
	ThisForm.cmdCargar.Enabled = .T.


Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Thisform.Reset()


Finally
	Use In Select( lcFileName )
	Use In Select( "cProgramas" )
	loGrid = Null

Endtry

ENDPROC
PROCEDURE cargarmenues
Try

	With Thisform.cboMenus As ComboBox

		.AddItem( 'Acreedores' )
		.List[.NewIndex, 2] = 'prCCAcre'
		.List[.NewIndex, 3] = '5'

		.AddItem( 'Archivos' )
		.List[.NewIndex, 2] = 'prTraArc'
		.List[.NewIndex, 3] = '5'

		.AddItem( 'Compras' )
		.List[.NewIndex, 2] = 'prGesCom'
		.List[.NewIndex, 3] = '5'

		.AddItem( 'Contabilidad' )
		.List[.NewIndex, 2] = 'prContab'
		.List[.NewIndex, 3] = '6'

		.AddItem( 'Deudores' )
		.List[.NewIndex, 2] = 'prCCDeud'
		.List[.NewIndex, 3] = '5'

		.AddItem( 'Facturación' )
		.List[.NewIndex, 2] = 'FHuesped'
		.List[.NewIndex, 3] = '5'

		.AddItem( 'Utiles' )
		.List[.NewIndex, 2] = 'prUtiles'
		.List[.NewIndex, 3] = '5'

		.AddItem( 'Valores' )
		.List[.NewIndex, 2] = 'prValores'
		.List[.NewIndex, 3] = '5'

	EndWith
	

Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

Endtry

ENDPROC
PROCEDURE comprimir
Lparameters lcFileName as String

Try

	If ThisForm.chkPack.Value
		Wait Window 'Comprimiendo &lcFileName.....' Nowait	
		Pack
	EndIf
	

Catch To oErr
	Local loError as   Errorhandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

ENDPROC
PROCEDURE creargrilla
Local loGrid As Grid
Local loHeader As Header
Local loColumn As Column
Local loCheck As Checkbox

Local lnWidth As Integer

Try

	loGrid = ThisForm.grdOpciones
	
	loGrid.ColumnCount = 7
	

	lnWidth = 0

	For i = 1 To loGrid.ColumnCount

		loColumn = loGrid.Columns[ i ]
		loColumn.Sparse = .F.
		

		If i = 1
			loColumn.Name = "Opcion"
			loColumn.Width = 400
			loColumn.ReadOnly = .T.
			
			loHeader = loColumn.Controls[ 1 ]
			loHeader.Caption = "Opción"
			loHeader.Alignment = 2
			
			
			
		Else

			loColumn = loGrid.Columns[ i ]

			loColumn.Sparse = .F.
			loColumn.Name = "Nivel" + Transform( i - 2 )
			loColumn.Width = 40
			loColumn.Alignment = 2
			

			loHeader = loColumn.Controls[ 1 ]
			loHeader.Caption = Transform( i - 2 )
			loHeader.Alignment = 2

			loColumn.AddObject( "Check", "CheckBox" )
			loColumn.CurrentControl = "Check"

			loCheck = loColumn.Controls[ 3 ]
			loCheck.Visible = .T.
			loCheck.Caption = ""
			loCheck.Value = .F.
			loCheck.Centered = .T.

		EndIf
		
		lnWidth = lnWidth + loColumn.Width

	Endfor

	loGrid.Width = lnWidth + 30


Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally
	loGrid 		= Null
	loHeader 	= Null
	loColumn 	= Null

Endtry

ENDPROC
PROCEDURE globalselection
Lparameters tlSelection as Boolean

Try

	Select Alias( Thisform.cCursorName )
	
	Replace All TIPOTR with tlSelection
	Go Top
	ThisForm.grdOpciones.Refresh()
	

Catch To oErr
	Local loError as   Errorhandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

ENDPROC
PROCEDURE hookaftercargararchivos
* Habilitar Boton

Thisform.cmdAceptar.Enabled = .T.


ENDPROC
PROCEDURE limpiargrilla
Local lcCommand As String
Local i As Integer
Local loGrid As Grid

Try

	lcCommand = ""

	Thisform.cCursorName = ""

	loGrid =  Thisform.grdOpciones

	loGrid.Opcion.ControlSource = ""

	For i = 0 To 5
		TEXT To lcCommand NoShow TextMerge Pretext 15
		loGrid.Nivel<<i>>.ControlSource = ""
		ENDTEXT

		&lcCommand

	Endfor

	ThisForm.lblGlobal.Enabled = .F.
	ThisForm.Chk0.Enabled = .F.
	ThisForm.Chk1.Enabled = .F.
	ThisForm.Chk2.Enabled = .F.
	ThisForm.Chk3.Enabled = .F.
	ThisForm.Chk4.Enabled = .F.
	ThisForm.Chk5.Enabled = .F.

	loGrid.RecordSource = ""
	loGrid.Refresh()


Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally
	loGrid = Null
	
Endtry

ENDPROC
PROCEDURE modificado
Lparameters lcFile As String

Local lcModifCtrl As String, llRetVal As Boolean
Try

	llRetVal = .F.

	If Used( lcFile )
		lcModifCtrl = Replicate( "1", Fcount( lcFile ) + 1 )
		Do Case
			Case Recno() < 0 And Deleted()  		&& Agregado y Borrado.
				llRetVal = .F.

			Case lcModifCtrl == Getfldstate( -1, lcFile )	&& No modificado.
				llRetVal = .F.

			Otherwise
				llRetVal = .T.

		Endcase
	Endif


Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

Endtry

Return llRetVal

ENDPROC
PROCEDURE process
Local lcMnu as Character
Local lnRecno as Integer

Try
	lcMnu = Thisform.cboMenus.List[ ThisForm.cboMenus.ListIndex, 3 ]

	TEXT To lcCommand NoShow TextMerge Pretext 15
	Update MenuDBF Set
		    MenuDBF.m<<lcMnu>>Cl0 = <<Thisform.cCursorName>>.Nivel0,
		    MenuDBF.m<<lcMnu>>Cl1 = <<Thisform.cCursorName>>.Nivel1,
		    MenuDBF.m<<lcMnu>>Cl2 = <<Thisform.cCursorName>>.Nivel2,
		    MenuDBF.m<<lcMnu>>Cl3 = <<Thisform.cCursorName>>.Nivel3,
		    MenuDBF.m<<lcMnu>>Cl4 = <<Thisform.cCursorName>>.Nivel4,
		    MenuDBF.m<<lcMnu>>Cl5 = <<Thisform.cCursorName>>.Nivel5
	    From <<Thisform.cCursorName>>
	    With ( Buffering = .T. )
	    Where Recno( "MenuDBF" ) = <<Thisform.cCursorName>>.Registro
	ENDTEXT

	&lcCommand
	
	Thisform.LimpiarGrilla()


Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally

Endtry

ENDPROC
PROCEDURE reset
Local array laTables[1]
Local lnLen as Integer
Local i as Integer

Try


	* Vaciar Grilla
	Thisform.grdOpciones.Archivos.ControlSource = ""
	Thisform.grdOpciones.Seleccion.ControlSource = ""
	Thisform.grdOpciones.RecordSource = ""

	lnLen = AUsed( laTables )
	
	For i = 1 to lnLen
		Use in ( laTables[ i, 1 ] )
	EndFor


	Thisform.cStatus = ""

	Thisform.cmdCancelar.FontBold = .F.
	Thisform.CmdAceptar.FontBold = .F.

	Thisform.cmdCancelar.FontItalic = .F.
	Thisform.CmdAceptar.FontItalic = .F.


	* Sincronizar Botones
	
	Thisform.cmdCancelar.Enabled = .T.
	Thisform.cmdAceptar.Enabled = .F.

	Thisform.cmdCargar.Enabled = .T.
	Thisform.cmdCargar.SetFocus()


Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )

Finally
	Use In Select( Thisform.cCursorName )

Endtry

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
14[END RESERVED2]
[START RESERVED3]
_memberdata XML Metadata for customizable properties
nopcion
ccursorname
nfirst
nsecond
cstatus
csetmultilocks
ncbomenulistindex
*cancelar 
*cargararchivos 
*process 
*reset Resets the Timer control so that it starts counting from 0.
*assigningtip 
*pack 
*comprimir 
*globalselection 
*hookbeforecargararchivos 
*hookaftercargararchivos 
*cargarmenues 
*creargrilla 
*modificado 
*limpiargrilla 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53DL
[CLASS] grid
[BASECLASS] grid
[OBJNAME] grdOpciones
[PARENT] frmmenus
[START PROPERTIES]
AllowHeaderSizing = .F.
AllowRowSizing = .F.
DeleteMark = .F.
GridLines = 1
HeaderHeight = 24
Height = 276
Left = 12
RecordMark = .F.
ScrollBars = 2
TabIndex = 2
Top = 108
Width = 672
HighlightStyle = 2
AllowAutoColumnFit = 2
Name = "grdOpciones"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53EK
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdCargar
[PARENT] frmmenus
[START PROPERTIES]
Top = 32
Left = 422
Height = 24
WordWrap = .T.
Caption = "Cargar Menú"
TabIndex = 1
Name = "cmdCargar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.HookBeforeCargarArchivos()
Thisform.CargarArchivos()
Thisform.HookAfterCargarArchivos()

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53EL
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdCancelar
[PARENT] frmmenus
[START PROPERTIES]
Top = 396
Left = 12
Height = 24
Width = 84
Picture = ..\..\fw\comunes\image\bmp\close.bmp
Cancel = .T.
Caption = "Cancelar"
TabIndex = 7
PicturePosition = 1
Name = "cmdCancelar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Cancelar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2TT0O53EM
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdAceptar
[PARENT] frmmenus
[START PROPERTIES]
Top = 396
Left = 599
Height = 24
Width = 84
Picture = ..\..\fw\comunes\image\bmp\ok.bmp
Caption = "Aceptar"
TabIndex = 3
PicturePosition = 1
Name = "cmdAceptar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Process()
Wait Clear

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3G80NR5IH
[CLASS] combobox
[BASECLASS] combobox
[OBJNAME] cboMenus
[PARENT] frmmenus
[START PROPERTIES]
BoundColumn = 2
Height = 24
Left = 12
Top = 32
Width = 396
BoundTo = .F.
Name = "cboMenus"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local llExit As Boolean
Local lcMsg as String

Try

	llExit = .T.

	If Thisform.Modificado( Thisform.cCursorName )
		Text To lcMsg NoShow TextMerge Pretext 03
		Se perderan los cambios realizados
		
		¿Confirma cambiar de menú sin grabar?
		EndText

		llExit = Confirm( lcMsg, Thisform.Caption, .F. )

	Endif

	If llExit
		Thisform.nCboMenuListIndex = This.ListIndex
		ThisForm.cmdCargar.Enabled = .T.
		Thisform.LimpiarGrilla()
		
		
		
	Else 	
		This.SelectedID = Thisform.nCboMenuListIndex
		ThisForm.cmdCargar.Enabled = .F.
		
	Endif



Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

Endtry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3G80VAT0P
[CLASS] label
[BASECLASS] label
[OBJNAME] lblNivel
[PARENT] frmmenus
[START PROPERTIES]
BackStyle = 0
Caption = "Nivel"
Height = 17
Left = 515
Top = 92
Width = 40
Name = "lblNivel"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2WZ125D0E
[CLASS] checkbox
[BASECLASS] checkbox
[OBJNAME] Chk0
[PARENT] frmmenus
[START PROPERTIES]
Top = 71
Left = 417
Height = 17
Width = 40
Alignment = 0
BackStyle = 0
Caption = ""
Value = .F.
Name = "Chk0"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local lcCommand as String
Local lcMnu as Character,;
	lcNvl as Character
Local lnRecNo as Integer

Try
	lcMnu = Thisform.cboMenus.List[ ThisForm.cboMenus.ListIndex, 3 ]
	lcNvl = Right( This.Name, 1 )

	Select Alias( Thisform.cCursorName )
	lnRecNo = Recno( Thisform.cCursorName )

	lcCommand = ""
	
	Text To lcCommand NoShow TextMerge Pretext 15
	Update <<Thisform.cCursorName>> Set
		Nivel<<lcNvl>> = <<This.Value>>
	EndText

	&lcCommand
	
	Select Alias( Thisform.cCursorName )
	Goto lnRecNo
	
	ThisForm.grdOpciones.Refresh()


Catch To oErr
	Local loError as   Errorhandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3G8151VF1
[CLASS] checkbox
[BASECLASS] checkbox
[OBJNAME] Chk1
[PARENT] frmmenus
[START PROPERTIES]
Top = 71
Left = 461
Height = 17
Width = 40
Alignment = 0
BackStyle = 0
Caption = ""
Value = .F.
Name = "Chk1"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local lcCommand as String
Local lcMnu as Character,;
	lcNvl as Character
Local lnRecNo as Integer

Try
	lcMnu = Thisform.cboMenus.List[ ThisForm.cboMenus.ListIndex, 3 ]
	lcNvl = Right( This.Name, 1 )

	Select Alias( Thisform.cCursorName )
	lnRecNo = Recno( Thisform.cCursorName )

	lcCommand = ""
	
	Text To lcCommand NoShow TextMerge Pretext 15
	Update <<Thisform.cCursorName>> Set
		Nivel<<lcNvl>> = <<This.Value>>
	EndText

	&lcCommand
	
	Select Alias( Thisform.cCursorName )
	Goto lnRecNo
	
	ThisForm.grdOpciones.Refresh()


Catch To oErr
	Local loError as   Errorhandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3G8151VGR
[CLASS] checkbox
[BASECLASS] checkbox
[OBJNAME] Chk2
[PARENT] frmmenus
[START PROPERTIES]
Top = 71
Left = 505
Height = 17
Width = 40
Alignment = 0
BackStyle = 0
Caption = ""
Value = .F.
Name = "Chk2"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local lcCommand as String
Local lcMnu as Character,;
	lcNvl as Character
Local lnRecNo as Integer

Try
	lcMnu = Thisform.cboMenus.List[ ThisForm.cboMenus.ListIndex, 3 ]
	lcNvl = Right( This.Name, 1 )

	Select Alias( Thisform.cCursorName )
	lnRecNo = Recno( Thisform.cCursorName )

	lcCommand = ""
	
	Text To lcCommand NoShow TextMerge Pretext 15
	Update <<Thisform.cCursorName>> Set
		Nivel<<lcNvl>> = <<This.Value>>
	EndText

	&lcCommand
	
	Select Alias( Thisform.cCursorName )
	Goto lnRecNo
	
	ThisForm.grdOpciones.Refresh()


Catch To oErr
	Local loError as   Errorhandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3G8151VH7
[CLASS] checkbox
[BASECLASS] checkbox
[OBJNAME] Chk3
[PARENT] frmmenus
[START PROPERTIES]
Top = 71
Left = 551
Height = 17
Width = 40
Alignment = 0
BackStyle = 0
Caption = ""
Value = .F.
Name = "Chk3"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local lcCommand as String
Local lcMnu as Character,;
	lcNvl as Character
Local lnRecNo as Integer

Try
	lcMnu = Thisform.cboMenus.List[ ThisForm.cboMenus.ListIndex, 3 ]
	lcNvl = Right( This.Name, 1 )

	Select Alias( Thisform.cCursorName )
	lnRecNo = Recno( Thisform.cCursorName )

	lcCommand = ""
	
	Text To lcCommand NoShow TextMerge Pretext 15
	Update <<Thisform.cCursorName>> Set
		Nivel<<lcNvl>> = <<This.Value>>
	EndText

	&lcCommand
	
	Select Alias( Thisform.cCursorName )
	Goto lnRecNo
	
	ThisForm.grdOpciones.Refresh()


Catch To oErr
	Local loError as   Errorhandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3G8151VHN
[CLASS] checkbox
[BASECLASS] checkbox
[OBJNAME] Chk4
[PARENT] frmmenus
[START PROPERTIES]
Top = 71
Left = 595
Height = 17
Width = 40
Alignment = 0
BackStyle = 0
Caption = ""
Value = .F.
Name = "Chk4"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local lcCommand as String
Local lcMnu as Character,;
	lcNvl as Character
Local lnRecNo as Integer

Try
	lcMnu = Thisform.cboMenus.List[ ThisForm.cboMenus.ListIndex, 3 ]
	lcNvl = Right( This.Name, 1 )

	Select Alias( Thisform.cCursorName )
	lnRecNo = Recno( Thisform.cCursorName )

	lcCommand = ""
	
	Text To lcCommand NoShow TextMerge Pretext 15
	Update <<Thisform.cCursorName>> Set
		Nivel<<lcNvl>> = <<This.Value>>
	EndText

	&lcCommand
	
	Select Alias( Thisform.cCursorName )
	Goto lnRecNo
	
	ThisForm.grdOpciones.Refresh()


Catch To oErr
	Local loError as   Errorhandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3G8151VI2
[CLASS] checkbox
[BASECLASS] checkbox
[OBJNAME] Chk5
[PARENT] frmmenus
[START PROPERTIES]
Top = 71
Left = 638
Height = 17
Width = 40
Alignment = 0
BackStyle = 0
Caption = ""
Value = .F.
Name = "Chk5"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local lcCommand as String
Local lcMnu as Character,;
	lcNvl as Character
Local lnRecNo as Integer

Try
	lcMnu = Thisform.cboMenus.List[ ThisForm.cboMenus.ListIndex, 3 ]
	lcNvl = Right( This.Name, 1 )

	Select Alias( Thisform.cCursorName )
	lnRecNo = Recno( Thisform.cCursorName )

	lcCommand = ""
	
	Text To lcCommand NoShow TextMerge Pretext 15
	Update <<Thisform.cCursorName>> Set
		Nivel<<lcNvl>> = <<This.Value>>
	EndText

	&lcCommand
	
	Select Alias( Thisform.cCursorName )
	Goto lnRecNo
	
	ThisForm.grdOpciones.Refresh()


Catch To oErr
	Local loError as   Errorhandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

EndTry

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3G8159FVZ
[CLASS] label
[BASECLASS] label
[OBJNAME] lblGlobal
[PARENT] frmmenus
[START PROPERTIES]
BackStyle = 0
Caption = "Global"
Height = 17
Left = 362
Top = 71
Width = 40
Name = "lblGlobal"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] frmmenus
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2UV13WAXY
[CLASS] frmdisplaywindow
[CLASSLOC] clipper2fox.vcx
[BASECLASS] form
[OBJNAME] frmsavescreen
[START PROPERTIES]
DoCreate = .T.
WindowType = 1
oparam = .NULL.
omain = .NULL.
_memberdata = <VFPData><memberdata name="oparam" display="oParam"/><memberdata name="omain" display="oMain"/></VFPData>
Name = "frmsavescreen"
Label21.Name = "Label21"
Label22.Name = "Label22"
cntTitulo.lblFecha.Name = "lblFecha"
cntTitulo.lblTitulo.Name = "lblTitulo"
cntTitulo.Label1.Name = "Label1"
cntTitulo.lblObservaciones.Name = "lblObservaciones"
cntTitulo.Name = "cntTitulo"
cntMessages.Label23.Name = "Label23"
cntMessages.Label24.Name = "Label24"
cntMessages.lblNavegar.Name = "lblNavegar"
cntMessages.Name = "cntMessages"
[END PROPERTIES]
[START METHODS]
PROCEDURE Activate

Local lcCommand As String
Local oErr as Exception

If This.lFirstTime
	Try

		lcCommand = ""
		
		This.lFirstTime = .F.

		lcCommand = This.cCommand

		On Key Label F1 Do Dummy In Rutina

		SetColor()
		
		Do Case
		Case IsEmpty( Thisform.oParam )
			Do &lcCommand		
			
		Case Vartype( Thisform.oMain ) == "O"
			If PemStatus( Thisform.oMain, "pnMaxCol", 5 )
				Thisform.oMain.pnMaxCol = Thisform.oParam.Width
				Thisform.oMain.pnMaxRow = Thisform.oParam.Height
			EndIf
			
			Thisform.oMain.&lcCommand
		
		Otherwise
			Do &lcCommand With Thisform.oParam
			
		EndCase

	Catch To oErr
		Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

		loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
		
		Do Case
		Case oErr.ErrorNo = 10
			loError.Cremark = lcCommand
			
		EndCase

		loError.Process( oErr )

	Finally
		Thisform.Release()

	Endtry

Endif

ENDPROC
PROCEDURE Init
Lparameters tcCommand As String, toParam As Object

Local oErr As Exception
Local lnHeight As Integer
Local lnWidth As Integer
Local lnGap As Integer
Local llAutocenter As Boolean
Local llPlain As Boolean
Local loFont As Object

Try

	If Empty( tcCommand )
		Error "No se recibió el comando a ejecutar"
	Endif

	Thisform.Icon = _Screen.Icon

	llAutocenter 	= .T.
	llPlain 		= .F.

	This.cCommand 	= tcCommand
	This.oParam 	= toParam
	lnGap 			= 02
	lnHeight 		= 25
	lnWidth 		= 80

	If Pemstatus( _Screen, "oApp", 5 )
		If Pemstatus( _Screen.oApp, "oColFonts", 5 )
			loFont = _Screen.oApp.oColFonts.Item( "screen" )

			This.FontName = loFont.FontName
			This.FontSize = loFont.FontSize

		Else
			This.FontName = _Screen.oApp.FontName
			This.FontSize = _Screen.oApp.FontSize

		Endif

	Endif


	If Vartype( toParam ) = "O"
		If PemStatus( toParam, "Caption", 5 )
			Thisform.Caption = toParam.Caption
		Endif

		If PemStatus( toParam, "Width", 5 )
			lnWidth = toParam.Width
			
		Else
			AddProperty( toParam, "Width", lnWidth )
			 	
		Endif

		If PemStatus( toParam, "Height", 5 )
			lnHeight = toParam.Height
			
		Else
			AddProperty( toParam, "Height", lnHeight )
			 	
		Endif

		If PemStatus( toParam, "Top", 5 )
			If toParam.Top >= 0
				Thisform.Top = toParam.Top
				llAutocenter = .F.
			EndIf
		Endif

		If PemStatus( toParam, "Left", 5 )
			If toParam.Left >= 0
				Thisform.Left = toParam.Left
				llAutocenter = .F.
			EndIf
		Endif

		If PemStatus( toParam, "Plain", 5 )
			llPlain = toParam.Plain
		Endif

		If PemStatus( toParam, "oMain", 5 )
			Thisform.oMain = toParam.oMain
		EndIf
		
	Endif

	This.Width 		= This.TextWidth( Replicate( "X", lnWidth ))
	This.Height 	= This.TextHeight( "X" ) * lnHeight
	This.AutoCenter = llAutocenter

	If Pemstatus( _Screen, "oApp", 5 )
		_Screen.oApp.nKeyCode 		= 0
		_Screen.oApp.nShiftAltCtrl 	= 0
	Endif

	If llPlain
		Thisform.cntMessages.Visible 	= .F.
		Thisform.cntTitulo.Visible 		= .F.

	Else
		Thisform.cntMessages.Label23.FontSize 	= Thisform.FontSize
		Thisform.cntMessages.Label24.FontSize 	= Thisform.FontSize
		Thisform.cntTitulo.lblFecha.FontSize 	= Thisform.FontSize
		Thisform.cntTitulo.lblTitulo.FontSize 	= Thisform.FontSize

		Thisform.cntMessages.Label23.Height = Int( Thisform.TextHeight( "[Xp]" ) * 1.25 )
		Thisform.cntMessages.Label24.Height = Int( Thisform.TextHeight( "[Xp]" ) * 1.25 )
		Thisform.cntTitulo.lblFecha.Height 	= Int( Thisform.TextHeight( "[Xp]" ) * 1.15 )
		Thisform.cntTitulo.lblTitulo.Height = Int( Thisform.TextHeight( "[Xp]" ) * 1.15 )

		lnTop 		= This.Height
		This.Height = This.Height + ( Thisform.Label21.Height * 0 )

		Thisform.cntMessages.Height = ( lnGap * 3 ) + Thisform.cntMessages.Label23.Height + Thisform.cntMessages.Label24.Height
		Thisform.cntTitulo.Height 	= Thisform.cntTitulo.lblFecha.Height + 06

		Thisform.cntMessages.Label23.Top = lnGap
		Thisform.cntMessages.Label24.Top = Thisform.cntMessages.Label23.Top + Thisform.cntMessages.Label23.Height + lnGap

		Thisform.cntMessages.Top 	= Thisform.Height - Thisform.cntMessages.Height - 02
		Thisform.cntTitulo.Top 		= 0

		Thisform.cntMessages.Width 			= Thisform.Width - 10
		Thisform.cntMessages.Label23.Width 	= Thisform.Width
		Thisform.cntMessages.Label24.Width 	= Thisform.Width

		Thisform.cntTitulo.Width = Thisform.Width

		Thisform.cntMessages.Label23.Left = 0
		Thisform.cntMessages.Label24.Left = 0
		Thisform.cntTitulo.Left 	= 0
		Thisform.cntMessages.Left 	= 05


		Thisform.cntMessages.Label23.Caption = ""
		Thisform.cntMessages.Label24.Caption = ""
		Thisform.cntTitulo.lblFecha.Caption = ""
		Thisform.cntTitulo.lblTitulo.Caption = ""
		Thisform.cntTitulo.LblObservaciones.Caption = ""

		Thisform.cntTitulo.lblFecha.AutoSize = .T.
		Thisform.cntTitulo.lblTitulo.AutoSize = .T.
		Thisform.cntTitulo.LblObservaciones.AutoSize = .T.
		
	Endif

Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally
	loFont = Null

Endtry



ENDPROCPROCEDURE Unload
Return Thisform.oParam
ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED3]
oparam
omain Referencia al Objeto  que se ejecutará
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] frmsavescreen
[START PROPERTIES]
Lucida Console, 0, 11, 9, 15, 12, 9, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2WZ125D0E
[CLASS] container
[BASECLASS] container
[OBJNAME] cntscreenlog
[START PROPERTIES]
Width = 597
Height = 228
BackStyle = 0
_memberdata = <VFPData><memberdata name="collapse" display="Collapse"/><memberdata name="expand" display="Expand"/><memberdata name="autosize" display="AutoSize"/></VFPData>
Name = "cntscreenlog"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
This.AutoSize()
ENDPROC
PROCEDURE autosize
Local lcCommand As String
Local lnLabelLeft As Integer,;
    lnDataLeft As Integer,;
    lnTop As Integer,;
    lnWidht As Integer,;
    lnHeight As Integer,;
    lnLabelHeight As Integer

Local loBackEnd As oBackEndSettings Of "FW\Comunes\prg\BackEndSettings.prg"

Try

    lcCommand = ""

    lnTop 			= 10
    lnLabelLeft 	= 10
    lnDataLeft 		= 120
    lnLabelHeight 	= 30

    loGlobalSettings = NewGlobalSettings()

    * Fecha
    This.Label_Fecha.Top 	= lnTop
    This.lblFecha.Top 		= lnTop
    This.lblFecha.Caption 	= DateMask( FECHAHOY )

    lnTop = lnTop + 30

    * Empresa
    This.Label_Empresa.Top 	= lnTop
    This.LblEmpresa.Top 	= lnTop
    This.lblEmpresa.Caption = loGlobalSettings.cDescripcionEmpresaActiva

    lnTop = lnTop + 30

    * Sucursal
    This.Label_Sucursal.Top 	= lnTop
    This.LblSucursal.Top 		= lnTop
    This.LblSucursal.Caption 	= loGlobalSettings.cDescripcionSucursalActiva

    lnTop = lnTop + 30

    * Usuario
    This.Label_Usuario.Top 		= lnTop
    This.LblUsuario.Top 		= lnTop
    This.LblUsuario.Caption 	= _Screen.oApp.oUser.Nombre + " " + _Screen.oApp.oUser.Apellido

    lnTop = lnTop + 30

    If _Screen.oApp.oUser.lIsStaff
        loBackEnd = NewBackEnd()

        * URL
        This.Label_Url.Top 		= lnTop
        This.LblUrl.Top 		= lnTop
        This.LblUrl.Caption 	= loBackEnd.cBaseUrl
        This.Label_Url.Visible 	= .T.
        This.LblUrl.Visible 	= .T.

        lnTop = lnTop + 30

    Endif


    This.Height = lnTop + 10


Catch To oErr
    Local loError As ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
    loError = Newobject( "ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
    loError.cRemark = lcCommand
    loError.Process( oErr )
    Throw loError

Finally
    loBackEnd = Null
    loGlobalSettings = Null

Endtry

ENDPROC
PROCEDURE collapse
This.Height = 70
ENDPROC
PROCEDURE expand
If Empty( This.lblGrupo.Caption )
	This.Height = 100
	
Else
	This.Height = 130
		
EndIf


ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
15[END RESERVED2]
[START RESERVED3]
_memberdata XML Metadata for customizable properties
*collapse 
*expand 
*autosize Redimensiona el control
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2T10VM7KL
[CLASS] label
[BASECLASS] label
[OBJNAME] Label_Fecha
[PARENT] cntscreenlog
[START PROPERTIES]
FontName = "Times New Roman"
FontSize = 16
Alignment = 1
BackStyle = 0
Caption = "Fecha:"
Height = 30
Left = 10
Top = 10
Width = 100
Name = "Label_Fecha"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2WZ125D0E
[CLASS] label
[BASECLASS] label
[OBJNAME] Label_Usuario
[PARENT] cntscreenlog
[START PROPERTIES]
FontName = "Times New Roman"
FontSize = 16
Alignment = 1
BackStyle = 0
Caption = "Usuario:"
Height = 30
Left = 10
Top = 108
Width = 100
Name = "Label_Usuario"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _37Z0XL3ZH
[CLASS] label
[BASECLASS] label
[OBJNAME] Label_Empresa
[PARENT] cntscreenlog
[START PROPERTIES]
FontName = "Times New Roman"
FontSize = 16
Alignment = 1
BackStyle = 0
Caption = "Empresa:"
Height = 30
Left = 10
Top = 40
Width = 100
Name = "Label_Empresa"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2T10VM7KL
[CLASS] label
[BASECLASS] label
[OBJNAME] lblFecha
[PARENT] cntscreenlog
[START PROPERTIES]
FontBold = .T.
FontSize = 14
Anchor = 10
BackStyle = 0
Caption = ( DateMask())
Height = 30
Left = 120
Top = 10
Width = 470
ForeColor = 0,0,255
Name = "lblFecha"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
This.Caption = DateMask()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] RESERVED  
[CLASS] label
[BASECLASS] label
[OBJNAME] lblEmpresa
[PARENT] cntscreenlog
[START PROPERTIES]
FontBold = .T.
FontSize = 14
Anchor = 10
BackStyle = 0
Caption = "Empresa"
Height = 30
Left = 120
Top = 40
Width = 470
ForeColor = 0,0,255
Name = "lblEmpresa"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2T10VM7KL
[CLASS] label
[BASECLASS] label
[OBJNAME] lblUsuario
[PARENT] cntscreenlog
[START PROPERTIES]
FontBold = .T.
FontSize = 14
Anchor = 10
BackStyle = 0
Caption = "Usuario"
Height = 30
Left = 120
Top = 108
Width = 470
ForeColor = 0,0,255
Name = "lblUsuario"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _37Z0XL3ZH
[CLASS] label
[BASECLASS] label
[OBJNAME] Label_Grupo
[PARENT] cntscreenlog
[START PROPERTIES]
FontName = "Times New Roman"
FontSize = 16
Alignment = 1
BackStyle = 0
Caption = "Grupo:"
Height = 30
Left = 9
Top = 139
Visible = .F.
Width = 100
Name = "Label_Grupo"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] RESERVED  
[CLASS] label
[BASECLASS] label
[OBJNAME] lblGrupo
[PARENT] cntscreenlog
[START PROPERTIES]
FontBold = .T.
FontSize = 14
Anchor = 10
BackStyle = 0
Caption = "Grupo"
Height = 30
Left = 119
Top = 139
Visible = .F.
Width = 470
ForeColor = 0,0,255
Name = "lblGrupo"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _37Z0XL3ZH
[CLASS] label
[BASECLASS] label
[OBJNAME] Label_Ejercicio
[PARENT] cntscreenlog
[START PROPERTIES]
FontName = "Times New Roman"
FontSize = 16
Alignment = 1
BackStyle = 0
Caption = "Ejercicio:"
Height = 30
Left = 9
Top = 169
Width = 100
Name = "Label_Ejercicio"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] RESERVED  
[CLASS] label
[BASECLASS] label
[OBJNAME] lblEjercicio
[PARENT] cntscreenlog
[START PROPERTIES]
FontBold = .T.
FontSize = 14
Anchor = 10
BackStyle = 0
Caption = "Ejercicio"
Height = 30
Left = 119
Top = 169
Width = 470
ForeColor = 0,0,255
Name = "lblEjercicio"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6HQ11PW3F
[CLASS] label
[BASECLASS] label
[OBJNAME] Label_Url
[PARENT] cntscreenlog
[START PROPERTIES]
FontName = "Times New Roman"
FontSize = 16
Alignment = 1
BackStyle = 0
Caption = "URL:"
Height = 30
Left = 9
Top = 199
Width = 100
Name = "Label_Url"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6HQ11PW3G
[CLASS] label
[BASECLASS] label
[OBJNAME] lblUrl
[PARENT] cntscreenlog
[START PROPERTIES]
FontBold = .T.
FontSize = 14
Anchor = 10
BackStyle = 0
Caption = "URL"
Height = 30
Left = 119
Top = 199
Width = 470
ForeColor = 0,0,255
Name = "lblUrl"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6K60LS04X
[CLASS] label
[BASECLASS] label
[OBJNAME] Label_Sucursal
[PARENT] cntscreenlog
[START PROPERTIES]
FontName = "Times New Roman"
FontSize = 16
Alignment = 1
BackStyle = 0
Caption = "Sucursal:"
Height = 30
Left = 10
Top = 72
Width = 100
Name = "Label_Sucursal"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _6K60LS04Y
[CLASS] label
[BASECLASS] label
[OBJNAME] lblSucursal
[PARENT] cntscreenlog
[START PROPERTIES]
FontBold = .T.
FontSize = 14
Anchor = 10
BackStyle = 0
Caption = "Sucursal"
Height = 30
Left = 120
Top = 72
Width = 470
ForeColor = 0,0,255
Name = "lblSucursal"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] cntscreenlog

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _37Z0XL3ZH
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdmenu
[START PROPERTIES]
Height = 43
Width = 121
Caption = ""
Alignment = 0
cfolder = 
_memberdata =      483<VFPData><memberdata name="cfolder" display="cFolder"/><memberdata name="cprograma" display="cPrograma"/><memberdata name="cparam" display="cParam"/><memberdata name="ldoprg" display="lDoPrg"/><memberdata name="nparam5" display="nParam5"/><memberdata name="nparam4" display="nParam4"/><memberdata name="nparam3" display="nParam3"/><memberdata name="nparam2" display="nParam2"/><memberdata name="doexecute" display="DoExecute"/><memberdata name="nparam1" display="nParam1"/></VFPData>
cprograma = 
cparam = 
nparam5 = 0
nparam4 = 0
nparam3 = 0
nparam2 = 0
nparam1 = 0
Name = "cmdmenu"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
If This.Cancel = .T.
	If PemStatus( _Screen, "oApp", 5 )
		_Screen.oApp.Exit()
		
	Else
		Thisform.Release
		
	EndIf
	
Else
	This.DoExecute()	
	
EndIf
ENDPROCPROCEDURE doexecute
Local lcCommandAction As String

Try

	Do Case
		Case !Empty( This.nParam5 )
			TEXT To lcParam NoShow TextMerge Pretext 15
			With <<This.nParam1>>,<<This.nParam2>>,<<This.nParam3>>,<<This.nParam4>>,<<This.nParam5>>
			ENDTEXT

		Case !Empty( This.nParam4 )
			TEXT To lcParam NoShow TextMerge Pretext 15
			With <<This.nParam1>>,<<This.nParam2>>,<<This.nParam3>>,<<This.nParam4>>
			ENDTEXT

		Case !Empty( This.nParam3 )
			TEXT To lcParam NoShow TextMerge Pretext 15
			With <<This.nParam1>>,<<This.nParam2>>,<<This.nParam3>>
			ENDTEXT

		Case !Empty( This.nParam2 )
			TEXT To lcParam NoShow TextMerge Pretext 15
			With <<This.nParam1>>,<<This.nParam2>>
			ENDTEXT

		Case !Empty( This.nParam1 )
			TEXT To lcParam NoShow TextMerge Pretext 15
			With <<This.nParam1>>
			ENDTEXT

		Otherwise
			lcParam = ""

	Endcase

	TEXT TO lcCommandAction TEXTMERGE NOSHOW PRETEXT 15
	Do Execute With "'<<Addbs(This.cFolder)>><<This.cPrograma>>' <<lcParam>>", <<This.lDoPrg>>
	ENDTEXT

	&lcCommandAction

Catch To oErr
	Local loError As   ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally

Endtry

Return

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED3]
cfolder
_memberdata XML Metadata for customizable properties
cprograma
cparam
ldoprg
nparam5
nparam4
nparam3
nparam2
nparam1
*doexecute 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] cmdmenu
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HL17M3PE
[CLASS] form
[BASECLASS] form
[OBJNAME] frmshowingrid
[START PROPERTIES]
Height = 373
Width = 575
DoCreate = .T.
AutoCenter = .T.
Caption = "Show Grid"
ControlBox = .F.
Closable = .F.
MaxButton = .F.
MinButton = .F.
MinHeight = 300
MinWidth = 300
Visible = .F.
WindowType = 1
_memberdata =      763<VFPData><memberdata name="cancelar" display="Cancelar"/><memberdata name="aceptar" display="Aceptar"/><memberdata name="oparam" display="oParam"/><memberdata name="definetable" display="DefineTable"/><memberdata name="ocolgridlayout" display="oColGridLayout"/><memberdata name="ocolgridlayout_access" display="oColGridLayout_Access"/><memberdata name="setgridlayout" display="SetGridLayout"/><memberdata name="otable" display="oTable"/><memberdata name="otable_access" display="oTable_Access"/><memberdata name="cmaincursorname" display="cMainCursorName"/><memberdata name="cmaincursorname_access" display="cMainCursorName_Access"/><memberdata name="performgridlayout" display="PerformGridLayout"/><memberdata name="armargrilla" display="ArmarGrilla"/></VFPData>
oparam = .NULL.
ocolgridlayout = .NULL.
otable = .NULL.
cmaincursorname = 
Name = "frmshowingrid"
[END PROPERTIES]
[START METHODS]
PROCEDURE aceptar
Local lcCommand as String

Try

	lcCommand = ""

Catch To oErr
	Local loError As   ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "  ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )

Finally
	
	
EndTry

ENDPROC
PROCEDURE armargrilla
Local lcCommand As String
Local lnColumns As Integer,;
	lnGridWidth As Integer
Local i As Integer
Local q As Integer
Local llLockScreen As Boolean
Local llDone As Boolean
Local loError As   ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
Local lcAsociatedCursor As String
Local laColumnWidth[ 1 ] As Integer
Local llRestoreColW As Boolean

Local loGrid As Grid

Try

	lcCommand = ""

	llLockScreen = Thisform.LockScreen
	*Thisform.LockScreen = .T.
	*!*		Thisform.BindControls = .F.

	loGrid = Thisform.Grid

	lcAsociatedCursor = Thisform.cMainCursorName
	llRestoreColW = .F.

	If Used( lcAsociatedCursor )

		* Builds the grid
		llDone = .F.


		* A veces quedaba una columna, pese a que ColumnCount = 0
		* Con esto me aseguro de eliminar todas las columnas (RA: 01/10/2008)
		Do While ! llDone
			Try
				loColumn = loGrid.Columns( 1 )
				loGrid.RemoveObject( loColumn.Name )

			Catch To oErr
				llDone = .T.

			Finally
			Endtry
		Enddo


		loGrid.ColumnCount = -1
		loGrid.RecordSource = ""

		lnColumns = This.oColGridLayout.Count

		loGrid.ColumnCount = lnColumns

		loGrid.RecordSource = lcAsociatedCursor

		lnGridWidth = 0

		For q = 1 To lnColumns
			With loGrid.Columns[ q ] As Column
				loGrid.ReadOnly = .T.
				Thisform.PerformGridLayout( loGrid.Columns[ q ], This.oColGridLayout.Item( q ) )
				.ControlSource = lcAsociatedCursor + "." + .ControlSource
				.Sparse = .F.

				If .Visible
					lnGridWidth = lnGridWidth + .Width
				Endif

			Endwith
		Next

		If lnColumns = 1
			* Si muestro una sola columna, saco las líneas divisorias y pongo
			* el ancho de la columna al máximo
			loGrid.GridLines = 0
			loGrid.Columns[ 1 ].Width = This.Width

		Else && lnColumns = 1
			loGrid.GridLines = 3
			*loGrid.LockColumns = 2

		Endif && lnColumns = 1


		* loGrid.Refresh()

	Endif

	Thisform.BindControls = .T.

	Select Alias( This.cMainCursorName )
	Locate

	Thisform.Width = lnGridWidth
	Thisform.AutoCenter = .T.

	Thisform.Refresh()
	loGrid.SetFocus()
	
Catch To oErr
	Local loError As   ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "  ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )


Finally
	*Thisform.LockScreen = llLockScreen
	loGridLayout = Null
	loGrid = Null

	Wait Clear
	Thisform.LockScreen = .F.



Endtry


ENDPROCPROCEDURE cancelar
Thisform.Release()
ENDPROC
PROCEDURE cmaincursorname_access
If Empty( This.cMainCursorName )
	This.cMainCursorName = "c" + This.oTable.Name + Sys( 2015 )
Endif

Return This.cMainCursorName

ENDPROC
PROCEDURE ocolgridlayout_access
Local lcCommand As String

Try

	lcCommand = ""

	If Vartype( This.oColGridLayout ) # 'O'

		This.oColGridLayout = Newobject( "colGridLayout",  ;
			"Fw\Comun\Prg\colGridLayout.prg" )

		This.SetGridLayout()

	Endif && Vartype( This.oColGridLayout ) # 'O'



Catch To oErr
	Local loError As   ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "  ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally


Endtry

Return This.oColGridLayout

ENDPROC
PROCEDURE otable_access
If Isnull( This.oTable )
	This.oTable = This.DefineTable()
Endif

Return This.oTable

ENDPROC
PROCEDURE performgridlayout
#INCLUDE "FW\Comunes\Include\Praxis.h"

Lparameters toColumn As Column, toParam As oGridLayout Of "Fw\Comunes\Prg\colGridLayout.Prg"

Local laMember[1]
* Local lnLen As Integer
Local i As Integer
Local lcSourceProperty As String
Local lcTargetProperty As String
Local lcControlName As String
Local lcPrefix As String
Local loError As   ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
Local loControl As Object
Local loGrid As Grid
Local lcCommand As String

Try

	lcCommand = ""
	loGrid = Thisform.Grid

	For i = 1 To Amembers( laMember, toParam, 0, "U" )
		Try
			lcSourceProperty = laMember[ i ]
			lcTargetProperty = Substr( lcSourceProperty, 7 )
			lcPrefix = Lower( Substr( lcSourceProperty, 1, 6 ) )

			Do Case
				Case lcPrefix == "header"
					toColumn.Controls[1].&lcTargetProperty = toParam.&lcSourceProperty

				Case lcPrefix  == "column"
					toColumn.&lcTargetProperty = toParam.&lcSourceProperty

				Case Lower( lcSourceProperty ) == 'ocurrentcontrol'

					If ! IsEmpty( toParam.oCurrentControl )

						If ! ( Lower( toColumn.CurrentControl ) == Lower( toParam.oCurrentControl.Name ) )
							toColumn.RemoveObject( toColumn.CurrentControl )
							toColumn.Newobject( toParam.oCurrentControl.Name,;
								toParam.oCurrentControl.Name,;
								toParam.oCurrentControl.Class )

							lcControlName = toParam.oCurrentControl.Name
							toColumn.&lcControlName..Visible = .T.

							toColumn.CurrentControl = toParam.oCurrentControl.Name

						Endif && ! ( Lower( toColumn.CurrentControl ) == Lower( toParam.oCurrentControl.Name ) )

					Endif && ! IsEmpty( toParam.oCurrentControl )

				Otherwise
			Endcase

		Catch To oErr
			loError = Newobject( "  ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
			loError.Ctracelogin = 'Source Property: ' + lcSourceProperty + CR ;
				+ 'Target Property: ' + lcTargetProperty + CR ;
				+ 'Prefix: ' + lcPrefix
			loError.Process( oErr )

		Finally
		Endtry
	Endfor

	AddProperty( toColumn, "oField", toParam.oField )
	AddProperty( toColumn, "Check", toParam.oField.Check )
	If !Empty( toColumn.Check )
		toColumn.Check = Strtran( toColumn.Check,;
			toParam.oField.Name,;
			"loCurrentControl.Value",;
			-1,;
			-1,;
			1 )
	Endif


Catch To oErr
	Local loError As   ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "  ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	loControl = Null


Endtry


ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
8[END RESERVED2]
[START RESERVED3]
_memberdata XML Metadata for customizable properties
oparam
ocolgridlayout
otable
cmaincursorname
*cancelar 
*aceptar 
*definetable 
*ocolgridlayout_access 
*setgridlayout 
*otable_access 
*cmaincursorname_access 
*performgridlayout 
*armargrilla 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HL17M3PY
[CLASS] grid
[BASECLASS] grid
[OBJNAME] Grid
[PARENT] frmshowingrid
[START PROPERTIES]
Anchor = 15
Height = 252
Left = 0
Top = 35
Width = 576
Name = "Grid"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HL17M3QS
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdAceptar
[PARENT] frmshowingrid
[START PROPERTIES]
Top = 336
Left = 480
Height = 27
Width = 84
Anchor = 12
Picture = ..\..\fw\comunes\image\bmp\ok.bmp
Caption = "Aceptar"
PicturePosition = 1
Name = "cmdAceptar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Aceptar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HL17M3R2
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdCerrar
[PARENT] frmshowingrid
[START PROPERTIES]
Top = 336
Left = 12
Height = 27
Width = 84
Anchor = 6
Picture = ..\..\fw\comunes\image\bmp\close.bmp
Caption = "Cerrar"
PicturePosition = 1
Name = "cmdCerrar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Cancelar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HL17M3RM
[CLASS] container
[BASECLASS] container
[OBJNAME] cntTitulo
[PARENT] frmshowingrid
[START PROPERTIES]
Anchor = 11
Top = 0
Left = 0
Width = 576
Height = 36
BorderWidth = 3
SpecialEffect = 0
Name = "cntTitulo"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HL17M3RW
[CLASS] label
[BASECLASS] label
[OBJNAME] lblFecha
[PARENT] frmshowingrid.cntTitulo
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Alignment = 1
BackStyle = 0
Caption = "Fecha"
Height = 22
Left = 612
Top = 3
Visible = .F.
Width = 146
ForeColor = 0,0,255
Name = "lblFecha"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HL17M3S6
[CLASS] label
[BASECLASS] label
[OBJNAME] lblTitulo
[PARENT] frmshowingrid.cntTitulo
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Alignment = 0
BackStyle = 0
Caption = "Título del programa"
Height = 22
Left = 6
Top = 7
Width = 198
ForeColor = 0,0,255
Name = "lblTitulo"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HL17M3SG
[CLASS] label
[BASECLASS] label
[OBJNAME] Label1
[PARENT] frmshowingrid.cntTitulo
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Alignment = 1
BackStyle = 0
Caption = ""
Height = 22
Left = 540
Top = 5
Width = 34
ForeColor = 0,0,255
Name = "Label1"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] frmshowingrid
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[START RESERVED1]
 ! ..\..\fw\comunes\include\praxis.h}s~\V! ..\..\fw\comunes\include\foxpro.h~ÊrûF" ..\..\fw\comunes\include\strings.hZŠOJ' ..\..\tools\namespaces\include\system.h&€±ÙF[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HM0IUGAL
[CLASS] form
[BASECLASS] form
[OBJNAME] frmmostrarengrilla
[START PROPERTIES]
Height = 372
Width = 432
DoCreate = .T.
AutoCenter = .T.
Caption = "Mostrar En Grilla"
ControlBox = .F.
Closable = .F.
MaxButton = .F.
MinButton = .F.
MinHeight = 192
MinWidth = 432
WindowType = 1
_memberdata =      481<VFPData><memberdata name="cancelar" display="Cancelar"/><memberdata name="performgridlayout" display="PerformGridLayout"/><memberdata name="armargrilla" display="ArmarGrilla"/><memberdata name="cmaincursorname" display="cMainCursorName"/><memberdata name="cmaincursorname_access" display="cMainCursorName_Access"/><memberdata name="setgridlayout" display="SetGridLayout"/><memberdata name="oparam" display="oParam"/><memberdata name="configurar" display="Configurar"/></VFPData>

cmaincursorname = 
oparam = .NULL.
Name = "frmmostrarengrilla"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Lparameters oParam as Object

Thisform.oParam = oParam
Thisform.cntTitulo.lblTitulo.Caption = oParam.cTitulo
Thisform.ArmarGrilla()
Thisform.Visible = .T.

Set Point To ","
Set Separator To "."

ENDPROCPROCEDURE Load
#INCLUDE "FW\Comunes\Include\Praxis.h"

Thisform.BindControls = .F.
Thisform.Visible = .F.
Thisform.MaxWidth = Sysmetric( SYSMETRIC_SCREENWIDTH ) - ( 2 * Sysmetric( SYSMETRIC_VSCROLLBARWIDTH ) )


ENDPROC
PROCEDURE armargrilla
#INCLUDE "FW\Comunes\Include\Praxis.h"

Local lcCommand As String

Local loGrid As prxactiongrid Of fw\comunes\vcx\prxmainform.vcx

Try

	lcCommand = ""

	loGrid = Thisform.Grid
	loGrid.cMainCursorName = Thisform.cMainCursorName

	loGrid.Fill()

	lnGridWidth = 0
	
	For q = 1 To loGrid.ColumnCount
		With loGrid.Columns[ q ] As Column
			If .Visible
				lnGridWidth = lnGridWidth + .Width
			Endif
		Endwith
	Next

	Thisform.BindControls = .T.

	Thisform.lblRegistros.Caption = Transform( Reccount( This.cMainCursorName )) + " Registros Encontrados"
	Thisform.lblRegistros.Visible = .T.

	Select Alias( This.cMainCursorName )
	Locate

	Thisform.Width = Min( lnGridWidth, _Screen.Width - ( 2 * Sysmetric( SYSMETRIC_VSCROLLBARWIDTH )))
	Thisform.AutoCenter = .T.

	Thisform.Refresh()
	loGrid.SetFocus()

Catch To oErr
	Local loError As   ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "  ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )


Finally
	loGrid = Null

	Wait Clear
	Thisform.LockScreen = .F.

Endtry


*!*		llLockScreen = Thisform.LockScreen
*!*		*Thisform.LockScreen = .T.
*!*		*!*		Thisform.BindControls = .F.

*!*		loGrid = Thisform.Grid

*!*		lcAsociatedCursor = Thisform.cMainCursorName
*!*		llRestoreColW = .F.

*!*		If Used( lcAsociatedCursor )

*!*			* Builds the grid
*!*			llDone = .F.


*!*			* A veces quedaba una columna, pese a que ColumnCount = 0
*!*			* Con esto me aseguro de eliminar todas las columnas (RA: 01/10/2008)
*!*			Do While ! llDone
*!*				Try
*!*					loColumn = loGrid.Columns( 1 )
*!*					loGrid.RemoveObject( loColumn.Name )

*!*				Catch To oErr
*!*					llDone = .T.

*!*				Finally
*!*				Endtry
*!*			Enddo


*!*			loGrid.ColumnCount = -1
*!*			loGrid.RecordSource = ""

*!*			lnColumns = This.oColGridLayout.Count

*!*			loGrid.ColumnCount = lnColumns

*!*			loGrid.RecordSource = lcAsociatedCursor

*!*			lnGridWidth = 0

*!*			For q = 1 To lnColumns
*!*				With loGrid.Columns[ q ] As Column
*!*					loGrid.ReadOnly = .T.
*!*					Thisform.PerformGridLayout( loGrid.Columns[ q ], This.oColGridLayout.Item( q ) )
*!*					.ControlSource = lcAsociatedCursor + "." + .ControlSource
*!*					.Sparse = .F.

*!*					If .Visible
*!*						lnGridWidth = lnGridWidth + .Width
*!*					Endif

*!*				Endwith
*!*			Next

*!*			If lnColumns = 1
*!*				* Si muestro una sola columna, saco las líneas divisorias y pongo
*!*				* el ancho de la columna al máximo
*!*				loGrid.GridLines = 0
*!*				loGrid.Columns[ 1 ].Width = This.Width

*!*			Else && lnColumns = 1
*!*				loGrid.GridLines = 3
*!*				*loGrid.LockColumns = 2

*!*			Endif && lnColumns = 1


*!*			* loGrid.Refresh()

*!*		Endif

ENDPROC
PROCEDURE cancelar
Thisform.Release()
ENDPROC
PROCEDURE cmaincursorname_access
If Empty( This.cMainCursorName )
	This.cMainCursorName = Thisform.oParam.cAlias
Endif

Return This.cMainCursorName

ENDPROC
PROCEDURE configurar
Local lcCommand As String
Local llModifica As Boolean

Local loColGridLayout As colGridLayout Of "FW\Comunes\Prg\colGridLayout.prg"

Try

	lcCommand = ""
	loColGridLayout = Thisform.Grid.oColGridLayout

	Do Form "Rutinas\Scx\frmConfiguracion.scx" With This.Grid.oColGridLayout To llModifica

	If llModifica
		Thisform.ArmarGrilla()
	Endif

Catch To oErr
	Local loError As   ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "  ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )

Finally


Endtry


ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
12[END RESERVED2]
[START RESERVED3]
_memberdata XML Metadata for customizable properties
cmaincursorname
oparam
*cancelar 
*performgridlayout 
*armargrilla 
*cmaincursorname_access 
*setgridlayout 
*configurar 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HM0J0VMR
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdAceptar
[PARENT] frmmostrarengrilla
[START PROPERTIES]
Top = 337
Left = 336
Height = 27
Width = 84
Anchor = 12
Picture = ..\..\fw\comunes\image\bmp\ok.bmp
Caption = "Aceptar"
PicturePosition = 1
Name = "cmdAceptar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Aceptar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HM0J0VN8
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdCerrar
[PARENT] frmmostrarengrilla
[START PROPERTIES]
Top = 337
Left = 12
Height = 27
Width = 84
Anchor = 6
Picture = ..\..\fw\comunes\image\bmp\close.bmp
Cancel = .T.
Caption = "Cerrar"
PicturePosition = 1
Name = "cmdCerrar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Cancelar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HM0J0VNW
[CLASS] container
[BASECLASS] container
[OBJNAME] cntTitulo
[PARENT] frmmostrarengrilla
[START PROPERTIES]
Anchor = 11
Width = 432
Height = 36
BorderWidth = 3
SpecialEffect = 0
Name = "cntTitulo"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HM0J0VO7
[CLASS] label
[BASECLASS] label
[OBJNAME] lblFecha
[PARENT] frmmostrarengrilla.cntTitulo
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Alignment = 1
BackStyle = 0
Caption = "Fecha"
Height = 22
Left = 612
Top = 3
Visible = .F.
Width = 146
ForeColor = 0,0,255
Name = "lblFecha"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HM0J0VOI
[CLASS] label
[BASECLASS] label
[OBJNAME] lblTitulo
[PARENT] frmmostrarengrilla.cntTitulo
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Alignment = 0
BackStyle = 0
Caption = "Título del programa"
Height = 22
Left = 6
Top = 7
Width = 198
ForeColor = 0,0,255
Name = "lblTitulo"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HM0J0VOS
[CLASS] label
[BASECLASS] label
[OBJNAME] Label1
[PARENT] frmmostrarengrilla.cntTitulo
[START PROPERTIES]
FontBold = .T.
FontSize = 12
Alignment = 1
BackStyle = 0
Caption = ""
Height = 22
Left = 540
Top = 5
Width = 34
ForeColor = 0,0,255
Name = "Label1"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HM0NCUCD
[CLASS] spinner
[BASECLASS] spinner
[OBJNAME] spnColumnsLock
[PARENT] frmmostrarengrilla
[START PROPERTIES]
Anchor = 9
Height = 24
InputMask = "99"
KeyboardHighValue = 99
KeyboardLowValue = 0
Left = 360
SpinnerHighValue =  99.00
SpinnerLowValue =   0.00
Top = 48
Width = 58
Value = 0
Name = "spnColumnsLock"
[END PROPERTIES]
[START METHODS]
PROCEDURE InteractiveChange
Local lcCommand as String

Try

	lcCommand = ""
	ThisForm.Grid.LockColumns = This.Value
	ThisForm.Grid.Refresh()

Catch To oErr
	Local loError As   ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "  ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	

Finally
	
	
EndTry

ENDPROC
PROCEDURE ProgrammaticChange
This.InteractiveChange()
ENDPROC[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HM0NCUCN
[CLASS] label
[BASECLASS] label
[OBJNAME] lblColumsLock
[PARENT] frmmostrarengrilla
[START PROPERTIES]
AutoSize = .T.
Anchor = 9
BackStyle = 0
Caption = "Columnas fijas"
Height = 17
Left = 269
Top = 55
Width = 86
TabIndex = 13
Name = "lblColumsLock"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HM0NCUCT
[CLASS] label
[BASECLASS] label
[OBJNAME] lblRegistros
[PARENT] frmmostrarengrilla
[START PROPERTIES]
AutoSize = .T.
Anchor = 6
BackStyle = 0
Caption = "1234 Registros Encontrados"
Height = 17
Left = 108
Top = 342
Visible = .F.
Width = 160
TabIndex = 10
Name = "lblRegistros"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HM0OOG40
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdConfigurar
[PARENT] frmmostrarengrilla
[START PROPERTIES]
AutoSize = .T.
Top = 47
Left = 14
Height = 27
Width = 122
Anchor = 3
Picture = ..\..\fw\comunes\image\bmp\header.bmp
Caption = "Configurar Vista"
TabIndex = 8
PicturePosition = 1
Name = "cmdConfigurar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Configurar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3HN0GYGOY
[CLASS] prxactiongrid
[CLASSLOC] ..\..\fw\comunes\vcx\prxmainform.vcx
[BASECLASS] grid
[OBJNAME] Grid
[PARENT] frmmostrarengrilla
[START PROPERTIES]
Anchor = 15
Height = 240
ScrollBars = 3
Top = 84
Width = 432
Name = "Grid"
[END PROPERTIES]
[START METHODS]
PROCEDURE fill

Local lnColumns As Integer
Local i As Integer
Local q As Integer
Local llLockScreen As Boolean
Local llDone As Boolean
Local lcAsociatedCursor As String
Local laColumnWidth[ 1 ] As Integer
Local llRestoreColW As Boolean

Local lcCommand As String

Try

	lcCommand = ""

	llLockScreen = Thisform.LockScreen
	Thisform.LockScreen = .T.
	llRestoreColW = .F.

	With This As prxactiongrid Of fw\comunes\vcx\prxmainform.vcx

		lcAsociatedCursor = This.cMainCursorName

		If Used( lcAsociatedCursor )
			If .ColumnCount > 0
				* Guardo la configuración de las columnas, para restaurarlas despues
				Dimension laColumnWidth[ .ColumnCount ]
				Store 0 To laColumnWidth
				For q = 1 To .ColumnCount
					With .Columns[ q ] As Column
						laColumnWidth[ q ] = .Width
						* Apago todo antes, para despues volver a conectarlo
						*.ReadOnly = .T.
						.ControlSource = ''

					Endwith

				Endfor
				llRestoreColW = .T.

			Endif && .ColumnCount > 0

			* Builds the grid
			llDone = .F.

			* A veces quedaba una columna, pese a que ColumnCount = 0
			* Con esto me aseguro de eliminar todas las columnas (RA: 01/10/2008)
			Do While ! llDone
				Try
					loColumn = .Columns( 1 )
					.RemoveObject( loColumn.Name )
				Catch To oErr
					llDone = .T.
				Finally
				Endtry
			Enddo



			.ColumnCount = -1
			.RecordSource = ""

			lnColumns = .oColGridLayout.Count

			.ColumnCount = lnColumns

			.RecordSource = lcAsociatedCursor

			lnGridWidth = 0


			For q = 1 To lnColumns
				With .Columns[ q ] As Column
					*.ReadOnly = .T.
					This.PerformLayout( This.Columns[ q ], This.oColGridLayout.Item( q ) )
					.ControlSource = lcAsociatedCursor + "." + .ControlSource
					
					.Resizable = .T.
					.ReadOnly = .F.
					
					If This.lCastDateTime
						If Vartype( Evaluate( .ControlSource ) ) == "T"
							.ControlSource = "=Ttod( " + .ControlSource + " )"

						Endif && Vartype( Evaluate( .ControlSource ) ) == "T"

					Endif && This.CastDateTime

					If Vartype( Evaluate( .ControlSource ) ) == "C"
						loGridLayout = This.oColGridLayout.Item( q )
						If loGridLayout.IsNumeric
							.ControlSource = "Val( " + .ControlSource + " )"

						Endif && loGridLayout.IsNumeric

					Endif && Vartype( Evaluate( .ControlSource ) ) == "C"

				Endwith
			Next

			.Refresh()

			If lnColumns = 1
				* Si muestro una sola columna, saco las líneas divisorias y pongo
				* el ancho de la columna al máximo
				.GridLines = 0
				.Columns[ 1 ].Width = This.Width
			Else && lnColumns = 1
				.GridLines = 2
			Endif && lnColumns = 1

			If llRestoreColW
				* Restauro la configuración de las columnas que pudiera
				* haber hecho el usuario
				Try
					For q = 1 To .ColumnCount
						.Columns[ q ].Width = laColumnWidth[ q ]

					Endfor
				Catch To oErr
					* Si algo falla ....
					.AutoFit()

				Finally
				Endtry
			Endif && llRestoreColW


			.AdjustFitColumn()
			.Refresh()

		Endif

	Endwith

Catch To oErr
	Local loError As   ErrorHandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	loError = Newobject( "  ErrorHandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Cremark = lcCommand
	loError.Process( oErr )
	Throw loError

Finally
	Thisform.LockScreen = llLockScreen
	loGridLayout = Null

Endtry


ENDPROC[END METHODS]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] frmmostrarengrilla
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[START RESERVED1]
 ! ..\..\fw\comunes\include\praxis.h}s~\V! ..\..\fw\comunes\include\foxpro.h~ÊrûF" ..\..\fw\comunes\include\strings.hZŠOJ' ..\..\tools\namespaces\include\system.h&€±ÙF[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3IJ0VLYB3
[CLASS] form
[BASECLASS] form
[OBJNAME] frmitemslist
[START PROPERTIES]
BorderStyle = 2
Top = 0
Left = 0
Height = 224
Width = 216
DoCreate = .T.
Caption = "Seleccione Una Opcion"
Closable = .F.
FontBold = .F.
FontItalic = .F.
FontName = "Arial"
FontSize = 9
MaxButton = .F.
MinButton = .F.
MinWidth = 204
KeyPreview = .T.
WindowType = 1
AlwaysOnTop = .T.
nitem = 0
_memberdata =      747<VFPData><memberdata name="nitem" display="nItem"/><memberdata name="ocolitems" display="oColItems"/><memberdata name="aitems" display="aItems"/><memberdata name="fontname" display="FontName"/><memberdata name="fontname_assign" display="FontName_Assign"/><memberdata name="fontsize" display="FontSize"/><memberdata name="fontsize_assign" display="FontSize_Assign"/><memberdata name="fontbold" display="FontBold"/><memberdata name="fontbold_assign" display="FontBold_Assign"/><memberdata name="fontitalic" display="FontItalic"/><memberdata name="fontitalic_assign" display="FontItalic_Assign"/><memberdata name="nselected" display="nSelected"/><memberdata name="cancelar" display="Cancelar"/><memberdata name="aceptar" display="Aceptar"/></VFPData>
ocolitems = .NULL.
nselected = 0
Name = "frmitemslist"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
Lparameters toLstItems As ListBox, toParam As Object

Local lnLen As Integer
Local lnLengh As Integer
Local lnWidth As Integer

Try

	Thisform.oColItems = toLstItems

	If Vartype( toParam ) == "O"
		Amembers( laMembers, toParam )

		For Each lcProperty In laMembers
			Try
				This.&lcProperty = toParam.&lcProperty

			Catch To oErr
				* No hago nada
			Finally

			Endtry
		Endfor

	Endif


	If Vartype( toLstItems ) == "O"
		Amembers( laMembers, toLstItems )

		For Each lcProperty In laMembers
			Try
				This.lstItems.&lcProperty = toLstItems.&lcProperty

			Catch To oErr
				* No hago nada
			Finally

			Endtry
		Endfor

	Endif

	lnLen = toLstItems.ListCount
	
	For i = 1 to lnLen
	
		For j = 1 to toLstItems.ColumnCount
			If j = 1
				ThisForm.lstItems.AddItem( toLstItems.List[ i, j ] )
				
			Else
				Thisform.lstItems.List[ Thisform.lstItems.NewIndex, j ] = toLstItems.List[ i, j ]
				
			Endif
		EndFor
	EndFor


	lnLengh = 0
	lnWidth = 0

*	Thisform.lstItems.Width = lnWidth

	If Thisform.TitleBar = 1
		Thisform.Width = Max( Thisform.TextWidth( Replicate( "W", Len( Thisform.Caption ))), Thisform.lstItems.Width )

		Thisform.Width = Max( Thisform.TextWidth( Thisform.Caption ), Thisform.lstItems.Width )

		Thisform.lstItems.Width = Thisform.Width
		lnLengh = Max( lnLengh, Len( Thisform.Caption ))
	Endif

	*	Thisform.lstItems.Width =  Thisform.TextWidth( Replicate( "W", lnLengh  ))
	Thisform.lstItems.Width =  Max( Thisform.lstItems.Width + 10, Thisform.Width )
	Thisform.lstItems.Height = ( Min( lnLen, 20 ) * Fontmetric( 1, Thisform.lstItems.FontName, Thisform.lstItems.FontSize ) ) + Iif( Thisform.TitleBar = 1, 50, 30 )

	Thisform.Width = Thisform.lstItems.Width
	Thisform.Height = Thisform.lstItems.Height + 48

Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	*!*		Throw loError

Finally

Endtry


ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

#INCLUDE "FW\Comunes\Include\Praxis.h"

Do Case
	Case nKeyCode = KEY_ESCAPE
		Thisform.nItem = 0
		_Screen.oApp.nKeyCode = nKeyCode
		Thisform.Release()

	Case nKeyCode = KEY_ENTER
		If !Empty( Thisform.lstItems.ListItemId )
			Thisform.nItem = Thisform.lstItems.ListItemId
			
		Else
			Thisform.nItem = Thisform.nSelected
			
		EndIf

		If !Empty( Thisform.nSelected ) Or !Empty( Thisform.nItem )
			_Screen.oApp.nKeyCode = nKeyCode
			Thisform.Release()
		EndIf		

	Case nKeyCode = KEY_FLECHA_IZQUIERDA
		If !Empty( Thisform.lstItems.ListItemId )
			Thisform.nItem = Thisform.lstItems.ListItemId
			
		Else
			Thisform.nItem = Thisform.nSelected
			
		EndIf
		
		_Screen.oApp.nKeyCode = KEY_FLECHA_ARRIBA
		Thisform.Release()

	Otherwise

Endcase

ENDPROC
PROCEDURE Unload
Return ThisForm.oColItems

ENDPROCPROCEDURE aceptar
Thisform.oColItems = ThisForm.lstItems
Thisform.Release()
ENDPROC
PROCEDURE cancelar
Thisform.oColItems = Null
Thisform.Release()
ENDPROC
PROCEDURE fontbold_assign
lparameters tFontBold
This.FontBold = tFontBold
ThisForm.lstItems.FontBold = tFontBold
ENDPROC
PROCEDURE fontitalic_assign
lparameters tFontItalic
This.FontItalic = tFontItalic
ThisForm.lstItems.FontItalic = tFontItalic
ENDPROC
PROCEDURE fontname_assign
lparameters tFontName
This.FontName = tFontName
ThisForm.lstItems.FontName = tFontName
ENDPROC
PROCEDURE fontsize_assign
lparameters tFontSize
This.FontSize = tFontSize
ThisForm.lstItems.FontSize = tFontSize
ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
4[END RESERVED2]
[START RESERVED3]
nitem
_memberdata XML Metadata for customizable properties
ocolitems
nselected Valor inicial del ListBox
^aitems[1,1] 
*fontname_assign 
*fontsize_assign 
*fontbold_assign 
*fontitalic_assign 
*cancelar 
*aceptar 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]
[START RESERVED7]
Elije algunos items de una lista[END RESERVED7]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3IJ0VLYDL
[CLASS] listbox
[BASECLASS] listbox
[OBJNAME] lstItems
[PARENT] frmitemslist
[START PROPERTIES]
Anchor = 15
BoundColumn = 2
Height = 180
Left = 0
Top = 0
Width = 216
IntegralHeight = .T.
BoundTo = .T.
AutoHideScrollbar = 1
Name = "lstItems"
[END PROPERTIES]
[START METHODS]
PROCEDURE DblClick
Thisform.nItem = Thisform.lstItems.ListItemId
Thisform.Release()

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3IJ0W4VOM
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdCerrar
[PARENT] frmitemslist
[START PROPERTIES]
Top = 192
Left = 12
Height = 24
Width = 84
Anchor = 6
Picture = ..\..\fw\comunes\image\bmp\close.bmp
Cancel = .T.
Caption = "\<Cerrar"
PicturePosition = 1
Name = "cmdCerrar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Cancelar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3IJ0W4VP2
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdAceptar
[PARENT] frmitemslist
[START PROPERTIES]
Top = 192
Left = 120
Height = 24
Width = 84
Anchor = 12
Picture = ..\..\fw\comunes\image\bmp\ok.bmp
Caption = "\<Aceptar"
Default = .T.
PicturePosition = 1
Name = "cmdAceptar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.Aceptar()
ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] frmitemslist
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[START RESERVED1]
 ! ..\..\fw\comunes\include\praxis.h}s~\V! ..\..\fw\comunes\include\foxpro.h~ÊrûF" ..\..\fw\comunes\include\strings.hZŠOJ' ..\..\tools\namespaces\include\system.h&€±ÙF[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3JR12WR03
[CLASS] form
[BASECLASS] form
[OBJNAME] selector
[START PROPERTIES]
Top = 0
Left = 0
Height = 386
Width = 649
DoCreate = .T.
Caption = "Selector"
Closable = .F.
FontName = "Lucida Console"
FontSize = 11
HalfHeightCaption = .T.
MaxButton = .F.
MinButton = .F.
MinHeight = 200
MinWidth = 300
KeyPreview = .T.
WindowType = 1
nkeypress = 0
_memberdata = <VFPData><memberdata name="nkeypress" display="nKeyPress"/><memberdata name="procesarparametros" display="ProcesarParametros"/></VFPData>
Name = "selector"
[END PROPERTIES]
[START METHODS]
PROCEDURE Init
*!*	Lparameters taFields, taPictures, taHeaders
Lparameters toParam As Collection

Local lnLen As Integer,;
	lnTop As Integer,;
	lnLeft As Integer,;
	lnMaxWidth As Integer,;
	lnWidth As Integer,;
	lnMaxChars as Integer

Local i As Integer

Local loColFields As Collection
Local loColPictures As Collection
Local loColHeaders As Collection
Local loColumn As Column
Local loHeader As Header
Local loControl As TextBox

Local lcInputMask As String
Local lcFormat As String
Local lnSpace As Integer

Local llOk As Boolean
Local lnAnchor As Integer
Local loFont As Object

Try

	llOk = .T.
	lnAnchor = This.grdGrilla.Anchor
	This.grdGrilla.Anchor = 0

	On Key Label F1

	loColFields = toParam.Item( "Fields" )
	loColPictures = toParam.Item( "Pictures" )
	loColHeaders = toParam.Item( "Headers" )
	lnTop = toParam.Item( "nTop" )
	lnLeft = toParam.Item( "nLeft" )
	lnMaxChars = 80



	If Pemstatus( _Screen, "oApp", 5 )
		If Pemstatus( _Screen.oApp, "oColFonts", 5 )
			loFont = _Screen.oApp.oColFonts.Item( "selector" )

			This.FontName = loFont.FontName
			This.FontSize = loFont.FontSize

		Else
			This.FontName = oApp.FontName
			This.FontSize = oApp.FontSize

		Endif

		If Pemstatus( _Screen.oApp, "nSelectorMaxWidth", 5 )
			lnMaxChars =  _Screen.oApp.nSelectorMaxWidth
			
		Else
			lnMaxChars = 80
			
		Endif

	Endif


	lnLen = loColFields.Count

	This.grdGrilla.ColumnCount = lnLen
	This.grdGrilla.FontName = This.FontName
	This.grdGrilla.FontSize = This.FontSize


	For i = 1 To lnLen
		loColumn = This.grdGrilla.Columns[ i ]
		loHeader = loColumn.Objects[ 1 ]
		loControl = loColumn.Objects[ 2 ]

		loHeader.Caption = loColHeaders.Item( i )
		loColumn.ControlSource = loColFields.Item( i )

		lcFormat = ""
		lcInputMask = loColPictures.Item( i )

		If Substr( lcInputMask, 1, 1 ) = "@"
			lnSpace = At( " ", lcInputMask )
			lcFormat = Substr( lcInputMask, 2, lnSpace - 1 )
			lcInputMask = Substr( lcInputMask, lnSpace + 1 )
		Endif

*!*			loControl.InputMask = lcInputMask
*!*			loControl.Format = lcFormat
		
		loColumn.InputMask = lcInputMask
		loColumn.Format = lcFormat

		If Vartype( Evaluate( loColumn.ControlSource )) = "N"
			loColumn.Alignment = 1

		Else
			loColumn.Alignment = 0

		Endif

	Endfor


	lnMaxWidth = Thisform.TextWidth( Replicate( "W", lnMaxChars ))
	lnWidth = 0
	For i = 1 To lnLen
		loColumn = This.grdGrilla.Columns[ i ]
		loControl = loColumn.Objects[ 2 ]
		loHeader = loColumn.Objects[ 1 ]

		*!*			nFsize = Max( Len( loControl.InputMask ), Len( loColHeaders.Item( i ) )) + 1
		*nFsize = Len( loControl.InputMask ) + 1
		nFsize = Len( loColumn.InputMask ) + 1


		*!*			loColumn.Width = Thisform.TextWidth( Replicate( "W", nFsize ))
		loColumn.Width = Max( Thisform.TextWidth( Replicate( "W", nFsize )), Thisform.TextWidth( loHeader.Caption ))

		lnWidth = lnWidth + loColumn.Width
	Endfor

	If lnWidth + 30 + 24 > lnMaxWidth
		This.grdGrilla.ScrollBars = 3
		lnWidth = lnMaxWidth - 30 - 24
	Endif

	This.grdGrilla.Width 	= lnWidth + 30 && ScrollBar
	This.grdGrilla.Top 		= 12
	This.grdGrilla.Left 	= 12

	Thisform.Width 		= This.grdGrilla.Width + 24
	*	Thisform.Height 	= This.grdGrilla.Height
	Thisform.Top 		= lnTop
	Thisform.Left 		= lnLeft

	This.grdGrilla.Anchor = lnAnchor
	
	If Thisform.Left + Thisform.Width > _Screen.Width
		Thisform.Width = Min( Thisform.Width, _Screen.Width )
		Thisform.AutoCenter = .T.
		This.grdGrilla.ScrollBars = 3
	Endif

	

	Try

		loParametros = toParam.Item( "oParametros" )
		This.ProcesarParametros( loParametros )

	Catch To oErr

	Finally

	Endtry


Catch To oErr
	Local loError As   Errorhandler Of "Tools\ErrorHandler\Prg\ErrorHandler.prg"
	llOk = .F.
	loError = Newobject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	Throw loError

Finally
	loFont = Null

Endtry

Return llOk

ENDPROC
PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl
#INCLUDE "FW\Comunes\Include\Praxis.h"


Do Case
Case nKeyCode = KEY_ENTER
	ThisForm.cmdAceptar.Click()

Case nKeyCode = KEY_ESCAPE
	ThisForm.cmdCancelar.Click()

Otherwise

EndCase
ENDPROC
PROCEDURE Unload
Return This.nKeyPress
ENDPROCPROCEDURE procesarparametros
Lparameters oParametros as Object

Try

	If PemStatus( oParametros, "Registros", 5 )
		If Empty( oParametros.Registros )
			ThisForm.lblRegistros.Caption = "No se han encontrado registros"
			ThisForm.lblRegistros.ForeColor = RGB(255,0,0)
			ThisForm.lblRegistros.FontBold = .T.
			
		Else
			ThisForm.lblRegistros.Caption = Transform( oParametros.Registros ) + " registros encontrados"
			
		Endif

		ThisForm.lblRegistros.Visible = .T.

	EndIf	
	
	If PemStatus( oParametros, "Caption", 5 )
		This.Caption = oParametros.Caption
	EndIf
	
	If PemStatus( oParametros, "Icon", 5 )
		this.Icon = oParametros.Icon
	EndIf

Catch To oErr
	Local loError as   Errorhandler OF "Tools\ErrorHandler\Prg\ErrorHandler.prg"

	loError = NewObject( "  Errorhandler", "Tools\ErrorHandler\Prg\ErrorHandler.prg" )
	loError.Process( oErr )
	
Finally

EndTry

ENDPROC
[END METHODS]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
5[END RESERVED2]
[START RESERVED3]
nkeypress
_memberdata XML Metadata for customizable properties
*procesarparametros 
[END RESERVED3]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3JR12WR29
[CLASS] grid
[BASECLASS] grid
[OBJNAME] grdGrilla
[PARENT] selector
[START PROPERTIES]
Anchor = 15
DeleteMark = .F.
Height = 288
Left = 23
ReadOnly = .T.
RecordMark = .F.
Top = 24
Width = 601
HighlightStyle = 2
Name = "grdGrilla"
[END PROPERTIES]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3JR12WR2O
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdCancelar
[PARENT] selector
[START PROPERTIES]
Top = 336
Left = 24
Height = 27
Width = 84
Anchor = 6
Cancel = .T.
Caption = "Cancelar"
Name = "cmdCancelar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.nKeyPress = 27
If Pemstatus( _Screen, "oApp", 5 )
	_Screen.oApp.nKeyCode = 27
Endif
Thisform.Release()

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3JR12WR34
[CLASS] commandbutton
[BASECLASS] commandbutton
[OBJNAME] cmdAceptar
[PARENT] selector
[START PROPERTIES]
Top = 336
Left = 540
Height = 27
Width = 84
Anchor = 12
Caption = "Aceptar"
Default = .T.
Name = "cmdAceptar"
[END PROPERTIES]
[START METHODS]
PROCEDURE Click
Thisform.nKeyPress = 13
If Pemstatus( _Screen, "oApp", 5 )
	_Screen.oApp.nKeyCode = 13
Endif

Thisform.Release()

ENDPROC
[END METHODS]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3JR12WR3J
[CLASS] label
[BASECLASS] label
[OBJNAME] lblRegistros
[PARENT] selector
[START PROPERTIES]
AutoSize = .T.
BackStyle = 0
Caption = "1234 Registros Encontrados"
Height = 17
Left = 169
Top = 341
Visible = .F.
Width = 160
Name = "lblRegistros"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] selector
[START PROPERTIES]
Lucida Console, 0, 11, 9, 15, 12, 9, 3, 0
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[START RESERVED1]
 ! ..\..\fw\comunes\include\praxis.h}s~\V! ..\..\fw\comunes\include\foxpro.h~ÊrûF" ..\..\fw\comunes\include\strings.hZŠOJ' ..\..\tools\namespaces\include\system.h&€±ÙF[END RESERVED1]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _3YB10965F
[CLASS] frmdisplaywindow
[CLASSLOC] clipper2fox.vcx
[BASECLASS] form
[OBJNAME] frmsolapas
[START PROPERTIES]
DoCreate = .T.
Name = "frmsolapas"
Label21.Name = "Label21"
Label22.Name = "Label22"
cntTitulo.lblFecha.Name = "lblFecha"
cntTitulo.lblTitulo.Name = "lblTitulo"
cntTitulo.Label1.Name = "Label1"
cntTitulo.lblObservaciones.Name = "lblObservaciones"
cntTitulo.Name = "cntTitulo"
cntMessages.Label23.Name = "Label23"
cntMessages.Label24.Name = "Label24"
cntMessages.Name = "cntMessages"
[END PROPERTIES]
[START RESERVED1]
Class[END RESERVED1]
[START RESERVED2]
2[END RESERVED2]
[START RESERVED6]
Pixels[END RESERVED6]

[ RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _37Z0XL3ZH
[CLASS] pageframe
[BASECLASS] pageframe
[OBJNAME] PageFrame
[PARENT] frmsolapas
[START PROPERTIES]
ErasePage = .T.
PageCount = 5
Top = 108
Left = 12
Width = 790
Height = 28
Name = "PageFrame"
Page1.Caption = "Page1"
Page1.Name = "Page1"
Page2.Caption = "Page2"
Page2.Name = "Page2"
Page3.Caption = "Page3"
Page3.Name = "Page3"
Page4.Caption = "Page4"
Page4.Name = "Page4"
Page5.Caption = "Page5"
Page5.Name = "Page5"
[END PROPERTIES]

[ RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[OBJNAME] frmsolapas
[START PROPERTIES]
Lucida Console, 0, 11, 9, 15, 12, 9, 3, 0
[END PROPERTIES]
[EOF]
